var Pm=Object.defineProperty;var km=(t,e,n)=>e in t?Pm(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Tl=(t,e,n)=>km(t,typeof e!="symbol"?e+"":e,n);import{r as y,a as Rm,g as Im,R as Zo,b as Am,c as Ie,X as Nm,C as Dm,A as Om,T as jm,d as Mm,e as Lm,U as wh,f as Fm,S as bh,h as xh,M as Vi,i as $m,H as Bm,j as Sh,L as Vm,k as Um,G as Wm,l as ea,m as Hm,n as Gm}from"./vendor-Dc_Zh-2k.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();var Eh={exports:{}},Ui={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qm=y,zm=Symbol.for("react.element"),Km=Symbol.for("react.fragment"),Ym=Object.prototype.hasOwnProperty,Jm=qm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Qm={key:!0,ref:!0,__self:!0,__source:!0};function Ch(t,e,n){var s,i={},r=null,o=null;n!==void 0&&(r=""+n),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)Ym.call(e,s)&&!Qm.hasOwnProperty(s)&&(i[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:zm,type:t,key:r,ref:o,props:i,_owner:Jm.current}}Ui.Fragment=Km;Ui.jsx=Ch;Ui.jsxs=Ch;Eh.exports=Ui;var g=Eh.exports,to={},Pl=Rm;to.createRoot=Pl.createRoot,to.hydrateRoot=Pl.hydrateRoot;var kl={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Th={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C=function(t,e){if(!t)throw In(e)},In=function(t){return new Error("Firebase Database ("+Th.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ph=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Xm=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const i=t[n++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=t[n++];e[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(l>>10)),e[s++]=String.fromCharCode(56320+(l&1023))}else{const r=t[n++],o=t[n++];e[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|o&63)}}return e.join("")},ta={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<t.length;i+=3){const r=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,u=r>>2,h=(r&3)<<4|a>>4;let d=(a&15)<<2|c>>6,f=c&63;l||(f=64,o||(d=64)),s.push(n[u],n[h],n[d],n[f])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Ph(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Xm(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<t.length;){const r=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,r==null||a==null||c==null||h==null)throw new Zm;const d=r<<2|a>>4;if(s.push(d),c!==64){const f=a<<4&240|c>>2;if(s.push(f),h!==64){const p=c<<6&192|h;s.push(p)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Zm extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const kh=function(t){const e=Ph(t);return ta.encodeByteArray(e,!0)},fi=function(t){return kh(t).replace(/\./g,"")},no=function(t){try{return ta.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eg(t){return Rh(void 0,t)}function Rh(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!tg(n)||(t[n]=Rh(t[n],e[n]));return t}function tg(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ng(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sg=()=>ng().__FIREBASE_DEFAULTS__,ig=()=>{if(typeof process>"u"||typeof kl>"u")return;const t=kl.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},rg=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&no(t[1]);return e&&JSON.parse(e)},Ih=()=>{try{return sg()||ig()||rg()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},og=t=>{var e,n;return(n=(e=Ih())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},ag=t=>{const e=og(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},Ah=()=>{var t;return(t=Ih())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fe=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lg(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[fi(JSON.stringify(n)),fi(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cg(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Nh(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(cg())}function ug(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function hg(){return Th.NODE_ADMIN===!0}function dg(){try{return typeof indexedDB=="object"}catch{return!1}}function fg(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var r;e(((r=i.error)===null||r===void 0?void 0:r.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pg="FirebaseError";class Ns extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=pg,Object.setPrototypeOf(this,Ns.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Dh.prototype.create)}}class Dh{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},i=`${this.service}/${e}`,r=this.errors[e],o=r?mg(r,s):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Ns(i,a,s)}}function mg(t,e){return t.replace(gg,(n,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const gg=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fs(t){return JSON.parse(t)}function ae(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oh=function(t){let e={},n={},s={},i="";try{const r=t.split(".");e=fs(no(r[0])||""),n=fs(no(r[1])||""),i=r[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:i}},yg=function(t){const e=Oh(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},_g=function(t){const e=Oh(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ue(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function _n(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function so(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function pi(t,e,n){const s={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=e.call(n,t[i],i,t));return s}function io(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const i of n){if(!s.includes(i))return!1;const r=t[i],o=e[i];if(Rl(r)&&Rl(o)){if(!io(r,o))return!1}else if(r!==o)return!1}for(const i of s)if(!n.includes(i))return!1;return!0}function Rl(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vg(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)s[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)s[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const d=s[h-3]^s[h-8]^s[h-14]^s[h-16];s[h]=(d<<1|d>>>31)&4294967295}let i=this.chain_[0],r=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,u;for(let h=0;h<80;h++){h<40?h<20?(c=a^r&(o^a),u=1518500249):(c=r^o^a,u=1859775393):h<60?(c=r&o|a&(r|o),u=2400959708):(c=r^o^a,u=3395469782);const d=(i<<5|i>>>27)+c+l+u+s[h]&4294967295;l=a,a=o,o=(r<<30|r>>>2)&4294967295,r=i,i=d}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+r&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let i=0;const r=this.buf_;let o=this.inbuf_;for(;i<n;){if(o===0)for(;i<=s;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(r[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(r),o=0;break}}else for(;i<n;)if(r[o]=e[i],++o,++i,o===this.blockSize){this.compress_(r),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let i=0;i<5;i++)for(let r=24;r>=0;r-=8)e[s]=this.chain_[i]>>r&255,++s;return e}}function vn(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bg=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);if(i>=55296&&i<=56319){const r=i-55296;s++,C(s<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(s)-56320;i=65536+(r<<10)+o}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Wi=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(t){return t&&t._delegate?t._delegate:t}class ps{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kt="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xg{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new Fe;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Eg(e))try{this.getOrInitializeService({instanceIdentifier:kt})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(e=kt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=kt){return this.instances.has(e)}getOptions(e=kt){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);s===a&&o.resolve(i)}return i}onInit(e,n){var s;const i=this.normalizeInstanceIdentifier(n),r=(s=this.onInitCallbacks.get(i))!==null&&s!==void 0?s:new Set;r.add(e),this.onInitCallbacks.set(i,r);const o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const i of s)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:Sg(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=kt){return this.component?this.component.multipleInstances?e:kt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Sg(t){return t===kt?void 0:t}function Eg(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cg{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new xg(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var J;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(J||(J={}));const Tg={debug:J.DEBUG,verbose:J.VERBOSE,info:J.INFO,warn:J.WARN,error:J.ERROR,silent:J.SILENT},Pg=J.INFO,kg={[J.DEBUG]:"log",[J.VERBOSE]:"log",[J.INFO]:"info",[J.WARN]:"warn",[J.ERROR]:"error"},Rg=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),i=kg[e];if(i)console[i](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class jh{constructor(e){this.name=e,this._logLevel=Pg,this._logHandler=Rg,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in J))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Tg[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,J.DEBUG,...e),this._logHandler(this,J.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,J.VERBOSE,...e),this._logHandler(this,J.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,J.INFO,...e),this._logHandler(this,J.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,J.WARN,...e),this._logHandler(this,J.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,J.ERROR,...e),this._logHandler(this,J.ERROR,...e)}}const Ig=(t,e)=>e.some(n=>t instanceof n);let Il,Al;function Ag(){return Il||(Il=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ng(){return Al||(Al=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Mh=new WeakMap,ro=new WeakMap,Lh=new WeakMap,wr=new WeakMap,na=new WeakMap;function Dg(t){const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",o)},r=()=>{n(dt(t.result)),i()},o=()=>{s(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Mh.set(n,t)}).catch(()=>{}),na.set(e,t),e}function Og(t){if(ro.has(t))return;const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",o),t.removeEventListener("abort",o)},r=()=>{n(),i()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",o),t.addEventListener("abort",o)});ro.set(t,e)}let oo={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ro.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Lh.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return dt(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function jg(t){oo=t(oo)}function Mg(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(br(this),e,...n);return Lh.set(s,e.sort?e.sort():[e]),dt(s)}:Ng().includes(t)?function(...e){return t.apply(br(this),e),dt(Mh.get(this))}:function(...e){return dt(t.apply(br(this),e))}}function Lg(t){return typeof t=="function"?Mg(t):(t instanceof IDBTransaction&&Og(t),Ig(t,Ag())?new Proxy(t,oo):t)}function dt(t){if(t instanceof IDBRequest)return Dg(t);if(wr.has(t))return wr.get(t);const e=Lg(t);return e!==t&&(wr.set(t,e),na.set(e,t)),e}const br=t=>na.get(t);function Fg(t,e,{blocked:n,upgrade:s,blocking:i,terminated:r}={}){const o=indexedDB.open(t,e),a=dt(o);return s&&o.addEventListener("upgradeneeded",l=>{s(dt(o.result),l.oldVersion,l.newVersion,dt(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const $g=["get","getKey","getAll","getAllKeys","count"],Bg=["put","add","delete","clear"],xr=new Map;function Nl(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(xr.get(e))return xr.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,i=Bg.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(i||$g.includes(n)))return;const r=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return s&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return xr.set(e,r),r}jg(t=>({...t,get:(e,n,s)=>Nl(e,n)||t.get(e,n,s),has:(e,n)=>!!Nl(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Ug(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function Ug(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ao="@firebase/app",Dl="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ze=new jh("@firebase/app"),Wg="@firebase/app-compat",Hg="@firebase/analytics-compat",Gg="@firebase/analytics",qg="@firebase/app-check-compat",zg="@firebase/app-check",Kg="@firebase/auth",Yg="@firebase/auth-compat",Jg="@firebase/database",Qg="@firebase/data-connect",Xg="@firebase/database-compat",Zg="@firebase/functions",ey="@firebase/functions-compat",ty="@firebase/installations",ny="@firebase/installations-compat",sy="@firebase/messaging",iy="@firebase/messaging-compat",ry="@firebase/performance",oy="@firebase/performance-compat",ay="@firebase/remote-config",ly="@firebase/remote-config-compat",cy="@firebase/storage",uy="@firebase/storage-compat",hy="@firebase/firestore",dy="@firebase/vertexai-preview",fy="@firebase/firestore-compat",py="firebase",my="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lo="[DEFAULT]",gy={[ao]:"fire-core",[Wg]:"fire-core-compat",[Gg]:"fire-analytics",[Hg]:"fire-analytics-compat",[zg]:"fire-app-check",[qg]:"fire-app-check-compat",[Kg]:"fire-auth",[Yg]:"fire-auth-compat",[Jg]:"fire-rtdb",[Qg]:"fire-data-connect",[Xg]:"fire-rtdb-compat",[Zg]:"fire-fn",[ey]:"fire-fn-compat",[ty]:"fire-iid",[ny]:"fire-iid-compat",[sy]:"fire-fcm",[iy]:"fire-fcm-compat",[ry]:"fire-perf",[oy]:"fire-perf-compat",[ay]:"fire-rc",[ly]:"fire-rc-compat",[cy]:"fire-gcs",[uy]:"fire-gcs-compat",[hy]:"fire-fst",[fy]:"fire-fst-compat",[dy]:"fire-vertex","fire-js":"fire-js",[py]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mi=new Map,yy=new Map,co=new Map;function Ol(t,e){try{t.container.addComponent(e)}catch(n){Ze.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function gi(t){const e=t.name;if(co.has(e))return Ze.debug(`There were multiple attempts to register component ${e}.`),!1;co.set(e,t);for(const n of mi.values())Ol(n,t);for(const n of yy.values())Ol(n,t);return!0}function _y(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vy={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ft=new Dh("app","Firebase",vy);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new ps("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ft.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const by=my;function Fh(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s=Object.assign({name:lo,automaticDataCollectionEnabled:!1},e),i=s.name;if(typeof i!="string"||!i)throw ft.create("bad-app-name",{appName:String(i)});if(n||(n=Ah()),!n)throw ft.create("no-options");const r=mi.get(i);if(r){if(io(n,r.options)&&io(s,r.config))return r;throw ft.create("duplicate-app",{appName:i})}const o=new Cg(i);for(const l of co.values())o.addComponent(l);const a=new wy(n,s,o);return mi.set(i,a),a}function xy(t=lo){const e=mi.get(t);if(!e&&t===lo&&Ah())return Fh();if(!e)throw ft.create("no-app",{appName:t});return e}function pn(t,e,n){var s;let i=(s=gy[t])!==null&&s!==void 0?s:t;n&&(i+=`-${n}`);const r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const a=[`Unable to register library "${i}" with version "${e}":`];r&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ze.warn(a.join(" "));return}gi(new ps(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sy="firebase-heartbeat-database",Ey=1,ms="firebase-heartbeat-store";let Sr=null;function $h(){return Sr||(Sr=Fg(Sy,Ey,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ms)}catch(n){console.warn(n)}}}}).catch(t=>{throw ft.create("idb-open",{originalErrorMessage:t.message})})),Sr}async function Cy(t){try{const n=(await $h()).transaction(ms),s=await n.objectStore(ms).get(Bh(t));return await n.done,s}catch(e){if(e instanceof Ns)Ze.warn(e.message);else{const n=ft.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ze.warn(n.message)}}}async function jl(t,e){try{const s=(await $h()).transaction(ms,"readwrite");await s.objectStore(ms).put(e,Bh(t)),await s.done}catch(n){if(n instanceof Ns)Ze.warn(n.message);else{const s=ft.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ze.warn(s.message)}}}function Bh(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ty=1024,Py=30*24*60*60*1e3;class ky{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Iy(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Ml();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r)?void 0:(this._heartbeatsCache.heartbeats.push({date:r,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=Py}),this._storage.overwrite(this._heartbeatsCache))}catch(s){Ze.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Ml(),{heartbeatsToSend:s,unsentEntries:i}=Ry(this._heartbeatsCache.heartbeats),r=fi(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(n){return Ze.warn(n),""}}}function Ml(){return new Date().toISOString().substring(0,10)}function Ry(t,e=Ty){const n=[];let s=t.slice();for(const i of t){const r=n.find(o=>o.agent===i.agent);if(r){if(r.dates.push(i.date),Ll(n)>e){r.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Ll(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class Iy{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return dg()?fg().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await Cy(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return jl(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return jl(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Ll(t){return fi(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ay(t){gi(new ps("platform-logger",e=>new Vg(e),"PRIVATE")),gi(new ps("heartbeat",e=>new ky(e),"PRIVATE")),pn(ao,Dl,t),pn(ao,Dl,"esm2017"),pn("fire-js","")}Ay("");var Ny="firebase",Dy="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pn(Ny,Dy,"app");var Fl={};const $l="@firebase/database",Bl="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vh="";function Oy(t){Vh=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ae(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:fs(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class My{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Ue(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uh=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new jy(e)}}catch{}return new My},jt=Uh("localStorage"),Ly=Uh("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mn=new jh("@firebase/database"),Fy=function(){let t=1;return function(){return t++}}(),Wh=function(t){const e=bg(t),n=new wg;n.update(e);const s=n.digest();return ta.encodeByteArray(s)},Ds=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=Ds.apply(null,s):typeof s=="object"?e+=ae(s):e+=s,e+=" "}return e};let ns=null,Vl=!0;const $y=function(t,e){C(!0,"Can't turn on custom loggers persistently."),mn.logLevel=J.VERBOSE,ns=mn.log.bind(mn)},he=function(...t){if(Vl===!0&&(Vl=!1,ns===null&&Ly.get("logging_enabled")===!0&&$y()),ns){const e=Ds.apply(null,t);ns(e)}},Os=function(t){return function(...e){he(t,...e)}},uo=function(...t){const e="FIREBASE INTERNAL ERROR: "+Ds(...t);mn.error(e)},et=function(...t){const e=`FIREBASE FATAL ERROR: ${Ds(...t)}`;throw mn.error(e),new Error(e)},ve=function(...t){const e="FIREBASE WARNING: "+Ds(...t);mn.warn(e)},By=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&ve("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Hi=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},Vy=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},wn="[MIN_NAME]",$t="[MAX_NAME]",Ut=function(t,e){if(t===e)return 0;if(t===wn||e===$t)return-1;if(e===wn||t===$t)return 1;{const n=Ul(t),s=Ul(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},Uy=function(t,e){return t===e?0:t<e?-1:1},Vn=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+ae(e))},sa=function(t){if(typeof t!="object"||t===null)return ae(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=ae(e[s]),n+=":",n+=sa(t[e[s]]);return n+="}",n},Hh=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let i=0;i<n;i+=e)i+e>n?s.push(t.substring(i,n)):s.push(t.substring(i,i+e));return s};function de(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const Gh=function(t){C(!Hi(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let i,r,o,a,l;t===0?(r=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),s),r=a+s,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(r=0,o=Math.round(t/Math.pow(2,1-s-n))));const c=[];for(l=n;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(r%2?1:0),r=Math.floor(r/2);c.push(i?1:0),c.reverse();const u=c.join("");let h="";for(l=0;l<64;l+=8){let d=parseInt(u.substr(l,8),2).toString(16);d.length===1&&(d="0"+d),h=h+d}return h.toLowerCase()},Wy=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Hy=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function Gy(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const qy=new RegExp("^-?(0*)\\d{1,10}$"),zy=-2147483648,Ky=2147483647,Ul=function(t){if(qy.test(t)){const e=Number(t);if(e>=zy&&e<=Ky)return e}return null},An=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw ve("Exception was thrown by user callback.",n),e},Math.floor(0))}},Yy=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},ss=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(s=>this.appCheck=s)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){ve(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(he("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ve(e)}}class oi{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}oi.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ia="5",qh="v",zh="s",Kh="r",Yh="f",Jh=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Qh="ls",Xh="p",ho="ac",Zh="websocket",ed="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class td{constructor(e,n,s,i,r=!1,o="",a=!1,l=!1){this.secure=n,this.namespace=s,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=jt.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&jt.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function Xy(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function nd(t,e,n){C(typeof e=="string","typeof type must == string"),C(typeof n=="object","typeof params must == object");let s;if(e===Zh)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===ed)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Xy(t)&&(n.ns=t.namespace);const i=[];return de(n,(r,o)=>{i.push(r+"="+o)}),s+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy{constructor(){this.counters_={}}incrementCounter(e,n=1){Ue(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return eg(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Er={},Cr={};function ra(t){const e=t.toString();return Er[e]||(Er[e]=new Zy),Er[e]}function e_(t,e){const n=t.toString();return Cr[n]||(Cr[n]=e()),Cr[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<s.length;++i)s[i]&&An(()=>{this.onMessage_(s[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wl="start",n_="close",s_="pLPCommand",i_="pRTLPCB",sd="id",id="pw",rd="ser",r_="cb",o_="seg",a_="ts",l_="d",c_="dframe",od=1870,ad=30,u_=od-ad,h_=25e3,d_=3e4;class an{constructor(e,n,s,i,r,o,a){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Os(e),this.stats_=ra(n),this.urlFn=l=>(this.appCheckToken&&(l[ho]=this.appCheckToken),nd(n,ed,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new t_(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(d_)),Vy(()=>{if(this.isClosed_)return;this.scriptTagHolder=new oa((...r)=>{const[o,a,l,c,u]=r;if(this.incrementIncomingBytes_(r),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===Wl)this.id=a,this.password=l;else if(o===n_)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...r)=>{const[o,a]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const s={};s[Wl]="t",s[rd]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[r_]=this.scriptTagHolder.uniqueCallbackIdentifier),s[qh]=ia,this.transportSessionId&&(s[zh]=this.transportSessionId),this.lastSessionId&&(s[Qh]=this.lastSessionId),this.applicationId&&(s[Xh]=this.applicationId),this.appCheckToken&&(s[ho]=this.appCheckToken),typeof location<"u"&&location.hostname&&Jh.test(location.hostname)&&(s[Kh]=Yh);const i=this.urlFn(s);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){an.forceAllow_=!0}static forceDisallow(){an.forceDisallow_=!0}static isAvailable(){return an.forceAllow_?!0:!an.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Wy()&&!Hy()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=ae(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=kh(n),i=Hh(s,u_);for(let r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[c_]="t",s[sd]=e,s[id]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=ae(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class oa{constructor(e,n,s,i){this.onDisconnect=s,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Fy(),window[s_+this.uniqueCallbackIdentifier]=e,window[i_+this.uniqueCallbackIdentifier]=n,this.myIFrame=oa.createIFrame_();let r="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(r='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){he("frame writing exception"),a.stack&&he(a.stack),he(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||he("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[sd]=this.myID,e[id]=this.myPW,e[rd]=this.currentSerial;let n=this.urlFn(e),s="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+ad+s.length<=od;){const o=this.pendingSegs.shift();s=s+"&"+o_+i+"="+o.seg+"&"+a_+i+"="+o.ts+"&"+l_+i+"="+o.d,i++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(s,Math.floor(h_)),r=()=>{clearTimeout(i),s()};this.addTag(e,r)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const i=s.readyState;(!i||i==="loaded"||i==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{he("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f_=16384,p_=45e3;let yi=null;typeof MozWebSocket<"u"?yi=MozWebSocket:typeof WebSocket<"u"&&(yi=WebSocket);class je{constructor(e,n,s,i,r,o,a){this.connId=e,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Os(this.connId),this.stats_=ra(n),this.connURL=je.connectionURL_(n,o,a,i,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,i,r){const o={};return o[qh]=ia,typeof location<"u"&&location.hostname&&Jh.test(location.hostname)&&(o[Kh]=Yh),n&&(o[zh]=n),s&&(o[Qh]=s),i&&(o[ho]=i),r&&(o[Xh]=r),nd(e,Zh,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,jt.set("previous_websocket_failure",!0);try{let s;hg(),this.mySock=new yi(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){je.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&yi!==null&&!je.forceDisallow_}static previouslyFailed(){return jt.isInMemoryStorage||jt.get("previous_websocket_failure")===!0}markConnectionHealthy(){jt.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=fs(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(C(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=ae(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=Hh(n,f_);s.length>1&&this.sendString_(String(s.length));for(let i=0;i<s.length;i++)this.sendString_(s[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(p_))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}je.responsesRequiredToBeHealthy=2;je.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[an,je]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=je&&je.isAvailable();let s=n&&!je.previouslyFailed();if(e.webSocketOnly&&(n||ve("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[je];else{const i=this.transports_=[];for(const r of gs.ALL_TRANSPORTS)r&&r.isAvailable()&&i.push(r);gs.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}gs.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m_=6e4,g_=5e3,y_=10*1024,__=100*1024,Tr="t",Hl="d",v_="s",Gl="r",w_="e",ql="o",zl="a",Kl="n",Yl="p",b_="h";class x_{constructor(e,n,s,i,r,o,a,l,c,u){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Os("c:"+this.id+":"),this.transportManager_=new gs(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=ss(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>__?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>y_?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Tr in e){const n=e[Tr];n===zl?this.upgradeIfSecondaryHealthy_():n===Gl?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===ql&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Vn("t",e),s=Vn("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Yl,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:zl,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Kl,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Vn("t",e),s=Vn("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Vn(Tr,e);if(Hl in e){const s=e[Hl];if(n===b_){const i=Object.assign({},s);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===Kl){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===v_?this.onConnectionShutdown_(s):n===Gl?this.onReset_(s):n===w_?uo("Server Error: "+s):n===ql?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):uo("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),ia!==s&&ve("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),ss(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(m_))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ss(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(g_))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Yl,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(jt.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{put(e,n,s,i){}merge(e,n,s,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e){this.allowedEvents_=e,this.listeners_={},C(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let i=0;i<s.length;i++)s[i].callback.apply(s[i].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const i=this.getInitialEvent(e);i&&n.apply(s,i)}off(e,n,s){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let r=0;r<i.length;r++)if(i[r].callback===n&&(!s||s===i[r].context)){i.splice(r,1);return}}validateEventType_(e){C(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i extends cd{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Nh()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new _i}getInitialEvent(e){return C(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jl=32,Ql=768;class q{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[s]=this.pieces_[i],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function G(){return new q("")}function $(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function gt(t){return t.pieces_.length-t.pieceNum_}function z(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new q(t.pieces_,e)}function aa(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function S_(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function ys(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function ud(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new q(e,0)}function X(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof q)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let i=0;i<s.length;i++)s[i].length>0&&n.push(s[i])}return new q(n,0)}function B(t){return t.pieceNum_>=t.pieces_.length}function _e(t,e){const n=$(t),s=$(e);if(n===null)return e;if(n===s)return _e(z(t),z(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function E_(t,e){const n=ys(t,0),s=ys(e,0);for(let i=0;i<n.length&&i<s.length;i++){const r=Ut(n[i],s[i]);if(r!==0)return r}return n.length===s.length?0:n.length<s.length?-1:1}function la(t,e){if(gt(t)!==gt(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function Re(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(gt(t)>gt(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class C_{constructor(e,n){this.errorPrefix_=n,this.parts_=ys(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=Wi(this.parts_[s]);hd(this)}}function T_(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Wi(e),hd(t)}function P_(t){const e=t.parts_.pop();t.byteLength_-=Wi(e),t.parts_.length>0&&(t.byteLength_-=1)}function hd(t){if(t.byteLength_>Ql)throw new Error(t.errorPrefix_+"has a key path longer than "+Ql+" bytes ("+t.byteLength_+").");if(t.parts_.length>Jl)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Jl+") or object contains a cycle "+Rt(t))}function Rt(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca extends cd{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}static getInstance(){return new ca}getInitialEvent(e){return C(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Un=1e3,k_=60*5*1e3,Xl=30*1e3,R_=1.3,I_=3e4,A_="server_kill",Zl=3;class Ye extends ld{constructor(e,n,s,i,r,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=Ye.nextPersistentConnectionId_++,this.log_=Os("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Un,this.maxReconnectDelay_=k_,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");ca.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&_i.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const i=++this.requestNumber_,r={r:i,a:e,b:n};this.log_(ae(r)),C(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),s&&(this.requestCBHash_[i]=s)}get(e){this.initConnection_();const n=new Fe,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),n.promise}listen(e,n,s,i){this.initConnection_();const r=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+r),this.listens.has(o)||this.listens.set(o,new Map),C(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),C(!this.listens.get(o).has(r),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:n,query:e,tag:s};this.listens.get(o).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+s+" for "+i);const r={p:s},o="q";e.tag&&(r.q=n._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest(o,r,a=>{const l=a.d,c=a.s;Ye.warnOnListenWarnings_(l,n),(this.listens.get(s)&&this.listens.get(s).get(i))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(s,i),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Ue(e,"w")){const s=_n(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',r=n._path.toString();ve(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||_g(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Xl)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=yg(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,i=>{const r=i.s,o=i.d||"error";this.authToken_===e&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+i),C(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,i)&&this.connected_&&this.sendUnlisten_(s,i,e._queryObject,n)}sendUnlisten_(e,n,s,i){this.log_("Unlisten on "+e+" for "+n);const r={p:e},o="n";i&&(r.q=s,r.t=i),this.sendRequest(o,r)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,i){const r={p:n,d:s};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,n,s,i){this.putInternal("p",e,n,s,i)}merge(e,n,s,i){this.putInternal("m",e,n,s,i)}putInternal(e,n,s,i,r){this.initConnection_();const o={p:n,d:s};r!==void 0&&(o.h=r),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,r=>{this.log_(n+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(r.s,r.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const r=s.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ae(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):uo("Unrecognized action received from server: "+ae(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){C(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Un,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Un,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>I_&&(this.reconnectDelay_=Un),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*R_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Ye.nextConnectionId_++,r=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,s())},c=function(h){C(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,d]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?he("getToken() completed but was canceled"):(he("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=d&&d.token,a=new x_(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,f=>{ve(f+" ("+this.repoInfo_.toString()+")"),this.interrupt(A_)},r))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&ve(h),l())}}}interrupt(e){he("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){he("Resuming connection for reason: "+e),delete this.interruptReasons_[e],so(this.interruptReasons_)&&(this.reconnectDelay_=Un,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(r=>sa(r)).join("$"):s="default";const i=this.removeListen_(e,s);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const s=new q(e).toString();let i;if(this.listens.has(s)){const r=this.listens.get(s);i=r.get(n),r.delete(n),r.size===0&&this.listens.delete(s)}else i=void 0;return i}onAuthRevoked_(e,n){he("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Zl&&(this.reconnectDelay_=Xl,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){he("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Zl&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+Vh.replace(/\./g,"-")]=1,Nh()?e["framework.cordova"]=1:ug()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=_i.getInstance().currentlyOnline();return so(this.interruptReasons_)&&e}}Ye.nextPersistentConnectionId_=0;Ye.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new V(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new V(wn,e),i=new V(wn,n);return this.compare(s,i)!==0}minPost(){return V.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ys;class dd extends Gi{static get __EMPTY_NODE(){return Ys}static set __EMPTY_NODE(e){Ys=e}compare(e,n){return Ut(e.name,n.name)}isDefinedOn(e){throw In("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return V.MIN}maxPost(){return new V($t,Ys)}makePost(e,n){return C(typeof e=="string","KeyIndex indexValue must always be a string."),new V(e,Ys)}toString(){return".key"}}const gn=new dd;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e,n,s,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?s(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class ue{constructor(e,n,s,i,r){this.key=e,this.value=n,this.color=s??ue.RED,this.left=i??Se.EMPTY_NODE,this.right=r??Se.EMPTY_NODE}copy(e,n,s,i,r){return new ue(e??this.key,n??this.value,s??this.color,i??this.left,r??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let i=this;const r=s(e,i.key);return r<0?i=i.copy(null,null,null,i.left.insert(e,n,s),null):r===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,s)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Se.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,i;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return Se.EMPTY_NODE;i=s.right.min_(),s=s.copy(i.key,i.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,ue.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,ue.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}ue.RED=!0;ue.BLACK=!1;class N_{copy(e,n,s,i,r){return this}insert(e,n,s){return new ue(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Se{constructor(e,n=Se.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Se(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,ue.BLACK,null,null))}remove(e){return new Se(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ue.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,i=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return i?i.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(i=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Js(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Js(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Js(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Js(this.root_,null,this.comparator_,!0,e)}}Se.EMPTY_NODE=new N_;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D_(t,e){return Ut(t.name,e.name)}function ua(t,e){return Ut(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fo;function O_(t){fo=t}const fd=function(t){return typeof t=="number"?"number:"+Gh(t):"string:"+t},pd=function(t){if(t.isLeafNode()){const e=t.val();C(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Ue(e,".sv"),"Priority must be a string or number.")}else C(t===fo||t.isEmpty(),"priority of unexpected type.");C(t===fo||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ec;class ce{constructor(e,n=ce.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,C(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),pd(this.priorityNode_)}static set __childrenNodeConstructor(e){ec=e}static get __childrenNodeConstructor(){return ec}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new ce(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:ce.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return B(e)?this:$(e)===".priority"?this.priorityNode_:ce.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:ce.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=$(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(C(s!==".priority"||gt(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,ce.__childrenNodeConstructor.EMPTY_NODE.updateChild(z(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+fd(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=Gh(this.value_):e+=this.value_,this.lazyHash_=Wh(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===ce.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof ce.__childrenNodeConstructor?-1:(C(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,i=ce.VALUE_TYPE_ORDER.indexOf(n),r=ce.VALUE_TYPE_ORDER.indexOf(s);return C(i>=0,"Unknown leaf type: "+n),C(r>=0,"Unknown leaf type: "+s),i===r?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}ce.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let md,gd;function j_(t){md=t}function M_(t){gd=t}class L_ extends Gi{compare(e,n){const s=e.node.getPriority(),i=n.node.getPriority(),r=s.compareTo(i);return r===0?Ut(e.name,n.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return V.MIN}maxPost(){return new V($t,new ce("[PRIORITY-POST]",gd))}makePost(e,n){const s=md(e);return new V(n,new ce("[PRIORITY-POST]",s))}toString(){return".priority"}}const ee=new L_;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F_=Math.log(2);class $_{constructor(e){const n=r=>parseInt(Math.log(r)/F_,10),s=r=>parseInt(Array(r+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=s(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const vi=function(t,e,n,s){t.sort(e);const i=function(l,c){const u=c-l;let h,d;if(u===0)return null;if(u===1)return h=t[l],d=n?n(h):h,new ue(d,h.node,ue.BLACK,null,null);{const f=parseInt(u/2,10)+l,p=i(l,f),m=i(f+1,c);return h=t[f],d=n?n(h):h,new ue(d,h.node,ue.BLACK,p,m)}},r=function(l){let c=null,u=null,h=t.length;const d=function(p,m){const _=h-p,v=h;h-=p;const b=i(_+1,v),w=t[_],x=n?n(w):w;f(new ue(x,w.node,m,null,b))},f=function(p){c?(c.left=p,c=p):(u=p,c=p)};for(let p=0;p<l.count;++p){const m=l.nextBitIsOne(),_=Math.pow(2,l.count-(p+1));m?d(_,ue.BLACK):(d(_,ue.BLACK),d(_,ue.RED))}return u},o=new $_(t.length),a=r(o);return new Se(s||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pr;const zt={};class Ke{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return C(zt&&ee,"ChildrenNode.ts has not been loaded"),Pr=Pr||new Ke({".priority":zt},{".priority":ee}),Pr}get(e){const n=_n(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Se?n:null}hasIndex(e){return Ue(this.indexSet_,e.toString())}addIndex(e,n){C(e!==gn,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let i=!1;const r=n.getIterator(V.Wrap);let o=r.getNext();for(;o;)i=i||e.isDefinedOn(o.node),s.push(o),o=r.getNext();let a;i?a=vi(s,e.getCompare()):a=zt;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const u=Object.assign({},this.indexes_);return u[l]=a,new Ke(u,c)}addToIndexes(e,n){const s=pi(this.indexes_,(i,r)=>{const o=_n(this.indexSet_,r);if(C(o,"Missing index implementation for "+r),i===zt)if(o.isDefinedOn(e.node)){const a=[],l=n.getIterator(V.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),vi(a,o.getCompare())}else return zt;else{const a=n.get(e.name);let l=i;return a&&(l=l.remove(new V(e.name,a))),l.insert(e,e.node)}});return new Ke(s,this.indexSet_)}removeFromIndexes(e,n){const s=pi(this.indexes_,i=>{if(i===zt)return i;{const r=n.get(e.name);return r?i.remove(new V(e.name,r)):i}});return new Ke(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wn;class j{constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&pd(this.priorityNode_),this.children_.isEmpty()&&C(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Wn||(Wn=new j(new Se(ua),null,Ke.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Wn}updatePriority(e){return this.children_.isEmpty()?this:new j(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Wn:n}}getChild(e){const n=$(e);return n===null?this:this.getImmediateChild(n).getChild(z(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(C(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new V(e,n);let i,r;n.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(s,this.children_)):(i=this.children_.insert(e,n),r=this.indexMap_.addToIndexes(s,this.children_));const o=i.isEmpty()?Wn:this.priorityNode_;return new j(i,o,r)}}updateChild(e,n){const s=$(e);if(s===null)return n;{C($(e)!==".priority"||gt(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(s).updateChild(z(e),n);return this.updateImmediateChild(s,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,i=0,r=!0;if(this.forEachChild(ee,(o,a)=>{n[o]=a.val(e),s++,r&&j.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):r=!1}),!e&&r&&i<2*s){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+fd(this.getPriority().val())+":"),this.forEachChild(ee,(n,s)=>{const i=s.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":Wh(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const i=this.resolveIndex_(s);if(i){const r=i.getPredecessorKey(new V(e,n));return r?r.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new V(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new V(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,V.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)<0;)i.getNext(),r=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,V.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)>0;)i.getNext(),r=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===js?-1:0}withIndex(e){if(e===gn||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new j(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===gn||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(ee),i=n.getIterator(ee);let r=s.getNext(),o=i.getNext();for(;r&&o;){if(r.name!==o.name||!r.node.equals(o.node))return!1;r=s.getNext(),o=i.getNext()}return r===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===gn?null:this.indexMap_.get(e.toString())}}j.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class B_ extends j{constructor(){super(new Se(ua),j.EMPTY_NODE,Ke.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return j.EMPTY_NODE}isEmpty(){return!1}}const js=new B_;Object.defineProperties(V,{MIN:{value:new V(wn,j.EMPTY_NODE)},MAX:{value:new V($t,js)}});dd.__EMPTY_NODE=j.EMPTY_NODE;ce.__childrenNodeConstructor=j;O_(js);M_(js);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V_=!0;function se(t,e=null){if(t===null)return j.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),C(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new ce(n,se(e))}if(!(t instanceof Array)&&V_){const n=[];let s=!1;if(de(t,(o,a)=>{if(o.substring(0,1)!=="."){const l=se(a);l.isEmpty()||(s=s||!l.getPriority().isEmpty(),n.push(new V(o,l)))}}),n.length===0)return j.EMPTY_NODE;const r=vi(n,D_,o=>o.name,ua);if(s){const o=vi(n,ee.getCompare());return new j(r,se(e),new Ke({".priority":o},{".priority":ee}))}else return new j(r,se(e),Ke.Default)}else{let n=j.EMPTY_NODE;return de(t,(s,i)=>{if(Ue(t,s)&&s.substring(0,1)!=="."){const r=se(i);(r.isLeafNode()||!r.isEmpty())&&(n=n.updateImmediateChild(s,r))}}),n.updatePriority(se(e))}}j_(se);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_ extends Gi{constructor(e){super(),this.indexPath_=e,C(!B(e)&&$(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),i=this.extractChild(n.node),r=s.compareTo(i);return r===0?Ut(e.name,n.name):r}makePost(e,n){const s=se(e),i=j.EMPTY_NODE.updateChild(this.indexPath_,s);return new V(n,i)}maxPost(){const e=j.EMPTY_NODE.updateChild(this.indexPath_,js);return new V($t,e)}toString(){return ys(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W_ extends Gi{compare(e,n){const s=e.node.compareTo(n.node);return s===0?Ut(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return V.MIN}maxPost(){return V.MAX}makePost(e,n){const s=se(e);return new V(n,s)}toString(){return".value"}}const H_=new W_;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yd(t){return{type:"value",snapshotNode:t}}function bn(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function _s(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function vs(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function G_(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(e){this.index_=e}updateChild(e,n,s,i,r,o){C(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(i).equals(s.getChild(i))&&a.isEmpty()===s.isEmpty()||(o!=null&&(s.isEmpty()?e.hasChild(n)?o.trackChildChange(_s(n,a)):C(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(bn(n,s)):o.trackChildChange(vs(n,s,a))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(ee,(i,r)=>{n.hasChild(i)||s.trackChildChange(_s(i,r))}),n.isLeafNode()||n.forEachChild(ee,(i,r)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(r)||s.trackChildChange(vs(i,r,o))}else s.trackChildChange(bn(i,r))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?j.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e){this.indexedFilter_=new ha(e.getIndex()),this.index_=e.getIndex(),this.startPost_=ws.getStartPost_(e),this.endPost_=ws.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&s}updateChild(e,n,s,i,r,o){return this.matches(new V(n,s))||(s=j.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,i,r,o)}updateFullNode(e,n,s){n.isLeafNode()&&(n=j.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(j.EMPTY_NODE);const r=this;return n.forEachChild(ee,(o,a)=>{r.matches(new V(o,a))||(i=i.updateImmediateChild(o,j.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const s=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?s<=0:s<0},this.withinEndPost=n=>{const s=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?s<=0:s<0},this.rangedFilter_=new ws(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,s,i,r,o){return this.rangedFilter_.matches(new V(n,s))||(s=j.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,i,r,o):this.fullLimitUpdateChild_(e,n,s,r,o)}updateFullNode(e,n,s){let i;if(n.isLeafNode()||n.isEmpty())i=j.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=j.EMPTY_NODE.withIndex(this.index_);let r;this.reverse_?r=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):r=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;r.hasNext()&&o<this.limit_;){const a=r.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(j.EMPTY_NODE);let r;this.reverse_?r=i.getReverseIterator(this.index_):r=i.getIterator(this.index_);let o=0;for(;r.hasNext();){const a=r.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,j.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,i,r){let o;if(this.reverse_){const h=this.index_.getCompare();o=(d,f)=>h(f,d)}else o=this.index_.getCompare();const a=e;C(a.numChildren()===this.limit_,"");const l=new V(n,s),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(n)){const h=a.getImmediateChild(n);let d=i.getChildAfterChild(this.index_,c,this.reverse_);for(;d!=null&&(d.name===n||a.hasChild(d.name));)d=i.getChildAfterChild(this.index_,d,this.reverse_);const f=d==null?1:o(d,l);if(u&&!s.isEmpty()&&f>=0)return r!=null&&r.trackChildChange(vs(n,s,h)),a.updateImmediateChild(n,s);{r!=null&&r.trackChildChange(_s(n,h));const m=a.updateImmediateChild(n,j.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(r!=null&&r.trackChildChange(bn(d.name,d.node)),m.updateImmediateChild(d.name,d.node)):m}}else return s.isEmpty()?e:u&&o(c,l)>=0?(r!=null&&(r.trackChildChange(_s(c.name,c.node)),r.trackChildChange(bn(n,s))),a.updateImmediateChild(n,s).updateImmediateChild(c.name,j.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ee}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return C(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return C(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:wn}hasEnd(){return this.endSet_}getIndexEndValue(){return C(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return C(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:$t}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return C(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ee}copy(){const e=new da;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function z_(t){return t.loadsAllData()?new ha(t.getIndex()):t.hasLimit()?new q_(t):new ws(t)}function tc(t){const e={};if(t.isDefault())return e;let n;if(t.index_===ee?n="$priority":t.index_===H_?n="$value":t.index_===gn?n="$key":(C(t.index_ instanceof U_,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=ae(n),t.startSet_){const s=t.startAfterSet_?"startAfter":"startAt";e[s]=ae(t.indexStartValue_),t.startNameSet_&&(e[s]+=","+ae(t.indexStartName_))}if(t.endSet_){const s=t.endBeforeSet_?"endBefore":"endAt";e[s]=ae(t.indexEndValue_),t.endNameSet_&&(e[s]+=","+ae(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function nc(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==ee&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wi extends ld{constructor(e,n,s,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=i,this.log_=Os("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(C(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,s,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const o=wi.getListenId_(e,s),a={};this.listens_[o]=a;const l=tc(e._queryParams);this.restRequest_(r+".json",l,(c,u)=>{let h=u;if(c===404&&(h=null,c=null),c===null&&this.onDataUpdate_(r,h,!1,s),_n(this.listens_,o)===a){let d;c?c===401?d="permission_denied":d="rest_error:"+c:d="ok",i(d,null)}})}unlisten(e,n){const s=wi.getListenId_(e,n);delete this.listens_[s]}get(e){const n=tc(e._queryParams),s=e._path.toString(),i=new Fe;return this.restRequest_(s+".json",n,(r,o)=>{let a=o;r===404&&(a=null,r=null),r===null?(this.onDataUpdate_(s,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,r])=>{i&&i.accessToken&&(n.auth=i.accessToken),r&&r.token&&(n.ac=r.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+vg(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=fs(a.responseText)}catch{ve("Failed to parse JSON response for "+o+": "+a.responseText)}s(null,l)}else a.status!==401&&a.status!==404&&ve("Got unsuccessful REST response for "+o+" Status: "+a.status),s(a.status);s=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(){this.rootNode_=j.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bi(){return{value:null,children:new Map}}function Nn(t,e,n){if(B(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=$(e);t.children.has(s)||t.children.set(s,bi());const i=t.children.get(s);e=z(e),Nn(i,e,n)}}function po(t,e){if(B(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(ee,(s,i)=>{Nn(t,new q(s),i)}),po(t,e)}}else if(t.children.size>0){const n=$(e);return e=z(e),t.children.has(n)&&po(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function mo(t,e,n){t.value!==null?n(e,t.value):Y_(t,(s,i)=>{const r=new q(e.toString()+"/"+s);mo(i,r,n)})}function Y_(t,e){t.children.forEach((n,s)=>{e(s,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&de(this.last_,(s,i)=>{n[s]=n[s]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sc=10*1e3,Q_=30*1e3,X_=5*60*1e3;class Z_{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new J_(e);const s=sc+(Q_-sc)*Math.random();ss(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;de(e,(i,r)=>{r>0&&Ue(this.statsToReport_,i)&&(n[i]=r,s=!0)}),s&&this.server_.reportStats(n),ss(this.reportStats_.bind(this),Math.floor(Math.random()*2*X_))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Me;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Me||(Me={}));function fa(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function pa(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function ma(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=Me.ACK_USER_WRITE,this.source=fa()}operationForChild(e){if(B(this.path)){if(this.affectedTree.value!=null)return C(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new q(e));return new xi(G(),n,this.revert)}}else return C($(this.path)===e,"operationForChild called for unrelated child."),new xi(z(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e,n){this.source=e,this.path=n,this.type=Me.LISTEN_COMPLETE}operationForChild(e){return B(this.path)?new bs(this.source,G()):new bs(this.source,z(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bt{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=Me.OVERWRITE}operationForChild(e){return B(this.path)?new Bt(this.source,G(),this.snap.getImmediateChild(e)):new Bt(this.source,z(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=Me.MERGE}operationForChild(e){if(B(this.path)){const n=this.children.subtree(new q(e));return n.isEmpty()?null:n.value?new Bt(this.source,G(),n.value):new xn(this.source,G(),n)}else return C($(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new xn(this.source,z(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(B(e))return this.isFullyInitialized()&&!this.filtered_;const n=$(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ev{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function tv(t,e,n,s){const i=[],r=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&r.push(G_(o.childName,o.snapshotNode))}),Hn(t,i,"child_removed",e,s,n),Hn(t,i,"child_added",e,s,n),Hn(t,i,"child_moved",r,s,n),Hn(t,i,"child_changed",e,s,n),Hn(t,i,"value",e,s,n),i}function Hn(t,e,n,s,i,r){const o=s.filter(a=>a.type===n);o.sort((a,l)=>sv(t,a,l)),o.forEach(a=>{const l=nv(t,a,r);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,t.query_))})})}function nv(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function sv(t,e,n){if(e.childName==null||n.childName==null)throw In("Should only compare child_ events.");const s=new V(e.childName,e.snapshotNode),i=new V(n.childName,n.snapshotNode);return t.index_.compare(s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qi(t,e){return{eventCache:t,serverCache:e}}function is(t,e,n,s){return qi(new yt(e,n,s),t.serverCache)}function _d(t,e,n,s){return qi(t.eventCache,new yt(e,n,s))}function Si(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Vt(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kr;const iv=()=>(kr||(kr=new Se(Uy)),kr);class Y{constructor(e,n=iv()){this.value=e,this.children=n}static fromObject(e){let n=new Y(null);return de(e,(s,i)=>{n=n.set(new q(s),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:G(),value:this.value};if(B(e))return null;{const s=$(e),i=this.children.get(s);if(i!==null){const r=i.findRootMostMatchingPathAndValue(z(e),n);return r!=null?{path:X(new q(s),r.path),value:r.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(B(e))return this;{const n=$(e),s=this.children.get(n);return s!==null?s.subtree(z(e)):new Y(null)}}set(e,n){if(B(e))return new Y(n,this.children);{const s=$(e),r=(this.children.get(s)||new Y(null)).set(z(e),n),o=this.children.insert(s,r);return new Y(this.value,o)}}remove(e){if(B(e))return this.children.isEmpty()?new Y(null):new Y(null,this.children);{const n=$(e),s=this.children.get(n);if(s){const i=s.remove(z(e));let r;return i.isEmpty()?r=this.children.remove(n):r=this.children.insert(n,i),this.value===null&&r.isEmpty()?new Y(null):new Y(this.value,r)}else return this}}get(e){if(B(e))return this.value;{const n=$(e),s=this.children.get(n);return s?s.get(z(e)):null}}setTree(e,n){if(B(e))return n;{const s=$(e),r=(this.children.get(s)||new Y(null)).setTree(z(e),n);let o;return r.isEmpty()?o=this.children.remove(s):o=this.children.insert(s,r),new Y(this.value,o)}}fold(e){return this.fold_(G(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((i,r)=>{s[i]=r.fold_(X(e,i),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,G(),n)}findOnPath_(e,n,s){const i=this.value?s(n,this.value):!1;if(i)return i;if(B(e))return null;{const r=$(e),o=this.children.get(r);return o?o.findOnPath_(z(e),X(n,r),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,G(),n)}foreachOnPath_(e,n,s){if(B(e))return this;{this.value&&s(n,this.value);const i=$(e),r=this.children.get(i);return r?r.foreachOnPath_(z(e),X(n,i),s):new Y(null)}}foreach(e){this.foreach_(G(),e)}foreach_(e,n){this.children.inorderTraversal((s,i)=>{i.foreach_(X(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(e){this.writeTree_=e}static empty(){return new Le(new Y(null))}}function rs(t,e,n){if(B(e))return new Le(new Y(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const i=s.path;let r=s.value;const o=_e(i,e);return r=r.updateChild(o,n),new Le(t.writeTree_.set(i,r))}else{const i=new Y(n),r=t.writeTree_.setTree(e,i);return new Le(r)}}}function go(t,e,n){let s=t;return de(n,(i,r)=>{s=rs(s,X(e,i),r)}),s}function ic(t,e){if(B(e))return Le.empty();{const n=t.writeTree_.setTree(e,new Y(null));return new Le(n)}}function yo(t,e){return Wt(t,e)!=null}function Wt(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(_e(n.path,e)):null}function rc(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(ee,(s,i)=>{e.push(new V(s,i))}):t.writeTree_.children.inorderTraversal((s,i)=>{i.value!=null&&e.push(new V(s,i.value))}),e}function pt(t,e){if(B(e))return t;{const n=Wt(t,e);return n!=null?new Le(new Y(n)):new Le(t.writeTree_.subtree(e))}}function _o(t){return t.writeTree_.isEmpty()}function Sn(t,e){return vd(G(),t.writeTree_,e)}function vd(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((i,r)=>{i===".priority"?(C(r.value!==null,"Priority writes must always be leaf nodes"),s=r.value):n=vd(X(t,i),r,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(X(t,".priority"),s)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zi(t,e){return Sd(e,t)}function rv(t,e,n,s,i){C(s>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:i}),i&&(t.visibleWrites=rs(t.visibleWrites,e,n)),t.lastWriteId=s}function ov(t,e,n,s){C(s>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:s,visible:!0}),t.visibleWrites=go(t.visibleWrites,e,n),t.lastWriteId=s}function av(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function lv(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);C(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let i=s.visible,r=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&cv(a,s.path)?i=!1:Re(s.path,a.path)&&(r=!0)),o--}if(i){if(r)return uv(t),!0;if(s.snap)t.visibleWrites=ic(t.visibleWrites,s.path);else{const a=s.children;de(a,l=>{t.visibleWrites=ic(t.visibleWrites,X(s.path,l))})}return!0}else return!1}function cv(t,e){if(t.snap)return Re(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&Re(X(t.path,n),e))return!0;return!1}function uv(t){t.visibleWrites=wd(t.allWrites,hv,G()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function hv(t){return t.visible}function wd(t,e,n){let s=Le.empty();for(let i=0;i<t.length;++i){const r=t[i];if(e(r)){const o=r.path;let a;if(r.snap)Re(n,o)?(a=_e(n,o),s=rs(s,a,r.snap)):Re(o,n)&&(a=_e(o,n),s=rs(s,G(),r.snap.getChild(a)));else if(r.children){if(Re(n,o))a=_e(n,o),s=go(s,a,r.children);else if(Re(o,n))if(a=_e(o,n),B(a))s=go(s,G(),r.children);else{const l=_n(r.children,$(a));if(l){const c=l.getChild(z(a));s=rs(s,G(),c)}}}else throw In("WriteRecord should have .snap or .children")}}return s}function bd(t,e,n,s,i){if(!s&&!i){const r=Wt(t.visibleWrites,e);if(r!=null)return r;{const o=pt(t.visibleWrites,e);if(_o(o))return n;if(n==null&&!yo(o,G()))return null;{const a=n||j.EMPTY_NODE;return Sn(o,a)}}}else{const r=pt(t.visibleWrites,e);if(!i&&_o(r))return n;if(!i&&n==null&&!yo(r,G()))return null;{const o=function(c){return(c.visible||i)&&(!s||!~s.indexOf(c.writeId))&&(Re(c.path,e)||Re(e,c.path))},a=wd(t.allWrites,o,e),l=n||j.EMPTY_NODE;return Sn(a,l)}}}function dv(t,e,n){let s=j.EMPTY_NODE;const i=Wt(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(ee,(r,o)=>{s=s.updateImmediateChild(r,o)}),s;if(n){const r=pt(t.visibleWrites,e);return n.forEachChild(ee,(o,a)=>{const l=Sn(pt(r,new q(o)),a);s=s.updateImmediateChild(o,l)}),rc(r).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const r=pt(t.visibleWrites,e);return rc(r).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function fv(t,e,n,s,i){C(s||i,"Either existingEventSnap or existingServerSnap must exist");const r=X(e,n);if(yo(t.visibleWrites,r))return null;{const o=pt(t.visibleWrites,r);return _o(o)?i.getChild(n):Sn(o,i.getChild(n))}}function pv(t,e,n,s){const i=X(e,n),r=Wt(t.visibleWrites,i);if(r!=null)return r;if(s.isCompleteForChild(n)){const o=pt(t.visibleWrites,i);return Sn(o,s.getNode().getImmediateChild(n))}else return null}function mv(t,e){return Wt(t.visibleWrites,e)}function gv(t,e,n,s,i,r,o){let a;const l=pt(t.visibleWrites,e),c=Wt(l,G());if(c!=null)a=c;else if(n!=null)a=Sn(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],h=o.getCompare(),d=r?a.getReverseIteratorFrom(s,o):a.getIteratorFrom(s,o);let f=d.getNext();for(;f&&u.length<i;)h(f,s)!==0&&u.push(f),f=d.getNext();return u}else return[]}function yv(){return{visibleWrites:Le.empty(),allWrites:[],lastWriteId:-1}}function Ei(t,e,n,s){return bd(t.writeTree,t.treePath,e,n,s)}function ga(t,e){return dv(t.writeTree,t.treePath,e)}function oc(t,e,n,s){return fv(t.writeTree,t.treePath,e,n,s)}function Ci(t,e){return mv(t.writeTree,X(t.treePath,e))}function _v(t,e,n,s,i,r){return gv(t.writeTree,t.treePath,e,n,s,i,r)}function ya(t,e,n){return pv(t.writeTree,t.treePath,e,n)}function xd(t,e){return Sd(X(t.treePath,e),t.writeTree)}function Sd(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;C(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),C(s!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(s);if(i){const r=i.type;if(n==="child_added"&&r==="child_removed")this.changeMap.set(s,vs(s,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&r==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&r==="child_changed")this.changeMap.set(s,_s(s,i.oldSnap));else if(n==="child_changed"&&r==="child_added")this.changeMap.set(s,bn(s,e.snapshotNode));else if(n==="child_changed"&&r==="child_changed")this.changeMap.set(s,vs(s,e.snapshotNode,i.oldSnap));else throw In("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wv{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const Ed=new wv;class _a{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new yt(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ya(this.writes_,e,s)}}getChildAfterChild(e,n,s){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Vt(this.viewCache_),r=_v(this.writes_,i,n,1,s,e);return r.length===0?null:r[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bv(t){return{filter:t}}function xv(t,e){C(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),C(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function Sv(t,e,n,s,i){const r=new vv;let o,a;if(n.type===Me.OVERWRITE){const c=n;c.source.fromUser?o=vo(t,e,c.path,c.snap,s,i,r):(C(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!B(c.path),o=Ti(t,e,c.path,c.snap,s,i,a,r))}else if(n.type===Me.MERGE){const c=n;c.source.fromUser?o=Cv(t,e,c.path,c.children,s,i,r):(C(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=wo(t,e,c.path,c.children,s,i,a,r))}else if(n.type===Me.ACK_USER_WRITE){const c=n;c.revert?o=kv(t,e,c.path,s,i,r):o=Tv(t,e,c.path,c.affectedTree,s,i,r)}else if(n.type===Me.LISTEN_COMPLETE)o=Pv(t,e,n.path,s,r);else throw In("Unknown operation type: "+n.type);const l=r.getChanges();return Ev(e,o,l),{viewCache:o,changes:l}}function Ev(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const i=s.getNode().isLeafNode()||s.getNode().isEmpty(),r=Si(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!s.getNode().equals(r)||!s.getNode().getPriority().equals(r.getPriority()))&&n.push(yd(Si(e)))}}function Cd(t,e,n,s,i,r){const o=e.eventCache;if(Ci(s,n)!=null)return e;{let a,l;if(B(n))if(C(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=Vt(e),u=c instanceof j?c:j.EMPTY_NODE,h=ga(s,u);a=t.filter.updateFullNode(e.eventCache.getNode(),h,r)}else{const c=Ei(s,Vt(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,r)}else{const c=$(n);if(c===".priority"){C(gt(n)===1,"Can't have a priority with additional path components");const u=o.getNode();l=e.serverCache.getNode();const h=oc(s,n,u,l);h!=null?a=t.filter.updatePriority(u,h):a=o.getNode()}else{const u=z(n);let h;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();const d=oc(s,n,o.getNode(),l);d!=null?h=o.getNode().getImmediateChild(c).updateChild(u,d):h=o.getNode().getImmediateChild(c)}else h=ya(s,c,e.serverCache);h!=null?a=t.filter.updateChild(o.getNode(),c,h,u,i,r):a=o.getNode()}}return is(e,a,o.isFullyInitialized()||B(n),t.filter.filtersNodes())}}function Ti(t,e,n,s,i,r,o,a){const l=e.serverCache;let c;const u=o?t.filter:t.filter.getIndexedFilter();if(B(n))c=u.updateFullNode(l.getNode(),s,null);else if(u.filtersNodes()&&!l.isFiltered()){const f=l.getNode().updateChild(n,s);c=u.updateFullNode(l.getNode(),f,null)}else{const f=$(n);if(!l.isCompleteForPath(n)&&gt(n)>1)return e;const p=z(n),_=l.getNode().getImmediateChild(f).updateChild(p,s);f===".priority"?c=u.updatePriority(l.getNode(),_):c=u.updateChild(l.getNode(),f,_,p,Ed,null)}const h=_d(e,c,l.isFullyInitialized()||B(n),u.filtersNodes()),d=new _a(i,h,r);return Cd(t,h,n,i,d,a)}function vo(t,e,n,s,i,r,o){const a=e.eventCache;let l,c;const u=new _a(i,e,r);if(B(n))c=t.filter.updateFullNode(e.eventCache.getNode(),s,o),l=is(e,c,!0,t.filter.filtersNodes());else{const h=$(n);if(h===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),s),l=is(e,c,a.isFullyInitialized(),a.isFiltered());else{const d=z(n),f=a.getNode().getImmediateChild(h);let p;if(B(d))p=s;else{const m=u.getCompleteChild(h);m!=null?aa(d)===".priority"&&m.getChild(ud(d)).isEmpty()?p=m:p=m.updateChild(d,s):p=j.EMPTY_NODE}if(f.equals(p))l=e;else{const m=t.filter.updateChild(a.getNode(),h,p,d,u,o);l=is(e,m,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function ac(t,e){return t.eventCache.isCompleteForChild(e)}function Cv(t,e,n,s,i,r,o){let a=e;return s.foreach((l,c)=>{const u=X(n,l);ac(e,$(u))&&(a=vo(t,a,u,c,i,r,o))}),s.foreach((l,c)=>{const u=X(n,l);ac(e,$(u))||(a=vo(t,a,u,c,i,r,o))}),a}function lc(t,e,n){return n.foreach((s,i)=>{e=e.updateChild(s,i)}),e}function wo(t,e,n,s,i,r,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;B(n)?c=s:c=new Y(null).setTree(n,s);const u=e.serverCache.getNode();return c.children.inorderTraversal((h,d)=>{if(u.hasChild(h)){const f=e.serverCache.getNode().getImmediateChild(h),p=lc(t,f,d);l=Ti(t,l,new q(h),p,i,r,o,a)}}),c.children.inorderTraversal((h,d)=>{const f=!e.serverCache.isCompleteForChild(h)&&d.value===null;if(!u.hasChild(h)&&!f){const p=e.serverCache.getNode().getImmediateChild(h),m=lc(t,p,d);l=Ti(t,l,new q(h),m,i,r,o,a)}}),l}function Tv(t,e,n,s,i,r,o){if(Ci(i,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(s.value!=null){if(B(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Ti(t,e,n,l.getNode().getChild(n),i,r,a,o);if(B(n)){let c=new Y(null);return l.getNode().forEachChild(gn,(u,h)=>{c=c.set(new q(u),h)}),wo(t,e,n,c,i,r,a,o)}else return e}else{let c=new Y(null);return s.foreach((u,h)=>{const d=X(n,u);l.isCompleteForPath(d)&&(c=c.set(u,l.getNode().getChild(d)))}),wo(t,e,n,c,i,r,a,o)}}function Pv(t,e,n,s,i){const r=e.serverCache,o=_d(e,r.getNode(),r.isFullyInitialized()||B(n),r.isFiltered());return Cd(t,o,n,s,Ed,i)}function kv(t,e,n,s,i,r){let o;if(Ci(s,n)!=null)return e;{const a=new _a(s,e,i),l=e.eventCache.getNode();let c;if(B(n)||$(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=Ei(s,Vt(e));else{const h=e.serverCache.getNode();C(h instanceof j,"serverChildren would be complete if leaf node"),u=ga(s,h)}u=u,c=t.filter.updateFullNode(l,u,r)}else{const u=$(n);let h=ya(s,u,e.serverCache);h==null&&e.serverCache.isCompleteForChild(u)&&(h=l.getImmediateChild(u)),h!=null?c=t.filter.updateChild(l,u,h,z(n),a,r):e.eventCache.getNode().hasChild(u)?c=t.filter.updateChild(l,u,j.EMPTY_NODE,z(n),a,r):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Ei(s,Vt(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,r)))}return o=e.serverCache.isFullyInitialized()||Ci(s,G())!=null,is(e,c,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,i=new ha(s.getIndex()),r=z_(s);this.processor_=bv(r);const o=n.serverCache,a=n.eventCache,l=i.updateFullNode(j.EMPTY_NODE,o.getNode(),null),c=r.updateFullNode(j.EMPTY_NODE,a.getNode(),null),u=new yt(l,o.isFullyInitialized(),i.filtersNodes()),h=new yt(c,a.isFullyInitialized(),r.filtersNodes());this.viewCache_=qi(h,u),this.eventGenerator_=new ev(this.query_)}get query(){return this.query_}}function Iv(t){return t.viewCache_.serverCache.getNode()}function Av(t){return Si(t.viewCache_)}function Nv(t,e){const n=Vt(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!B(e)&&!n.getImmediateChild($(e)).isEmpty())?n.getChild(e):null}function cc(t){return t.eventRegistrations_.length===0}function Dv(t,e){t.eventRegistrations_.push(e)}function uc(t,e,n){const s=[];if(n){C(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(r=>{const o=r.createCancelEvent(n,i);o&&s.push(o)})}if(e){let i=[];for(let r=0;r<t.eventRegistrations_.length;++r){const o=t.eventRegistrations_[r];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(r+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return s}function hc(t,e,n,s){e.type===Me.MERGE&&e.source.queryId!==null&&(C(Vt(t.viewCache_),"We should always have a full cache before handling merges"),C(Si(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,r=Sv(t.processor_,i,e,n,s);return xv(t.processor_,r.viewCache),C(r.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=r.viewCache,Td(t,r.changes,r.viewCache.eventCache.getNode(),null)}function Ov(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(ee,(r,o)=>{s.push(bn(r,o))}),n.isFullyInitialized()&&s.push(yd(n.getNode())),Td(t,s,n.getNode(),e)}function Td(t,e,n,s){const i=s?[s]:t.eventRegistrations_;return tv(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pi;class Pd{constructor(){this.views=new Map}}function jv(t){C(!Pi,"__referenceConstructor has already been defined"),Pi=t}function Mv(){return C(Pi,"Reference.ts has not been loaded"),Pi}function Lv(t){return t.views.size===0}function va(t,e,n,s){const i=e.source.queryId;if(i!==null){const r=t.views.get(i);return C(r!=null,"SyncTree gave us an op for an invalid query."),hc(r,e,n,s)}else{let r=[];for(const o of t.views.values())r=r.concat(hc(o,e,n,s));return r}}function kd(t,e,n,s,i){const r=e._queryIdentifier,o=t.views.get(r);if(!o){let a=Ei(n,i?s:null),l=!1;a?l=!0:s instanceof j?(a=ga(n,s),l=!1):(a=j.EMPTY_NODE,l=!1);const c=qi(new yt(a,l,!1),new yt(s,i,!1));return new Rv(e,c)}return o}function Fv(t,e,n,s,i,r){const o=kd(t,e,s,i,r);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),Dv(o,n),Ov(o,n)}function $v(t,e,n,s){const i=e._queryIdentifier,r=[];let o=[];const a=_t(t);if(i==="default")for(const[l,c]of t.views.entries())o=o.concat(uc(c,n,s)),cc(c)&&(t.views.delete(l),c.query._queryParams.loadsAllData()||r.push(c.query));else{const l=t.views.get(i);l&&(o=o.concat(uc(l,n,s)),cc(l)&&(t.views.delete(i),l.query._queryParams.loadsAllData()||r.push(l.query)))}return a&&!_t(t)&&r.push(new(Mv())(e._repo,e._path)),{removed:r,events:o}}function Rd(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function mt(t,e){let n=null;for(const s of t.views.values())n=n||Nv(s,e);return n}function Id(t,e){if(e._queryParams.loadsAllData())return Ki(t);{const s=e._queryIdentifier;return t.views.get(s)}}function Ad(t,e){return Id(t,e)!=null}function _t(t){return Ki(t)!=null}function Ki(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ki;function Bv(t){C(!ki,"__referenceConstructor has already been defined"),ki=t}function Vv(){return C(ki,"Reference.ts has not been loaded"),ki}let Uv=1;class dc{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Y(null),this.pendingWriteTree_=yv(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Nd(t,e,n,s,i){return rv(t.pendingWriteTree_,e,n,s,i),i?Dn(t,new Bt(fa(),e,n)):[]}function Wv(t,e,n,s){ov(t.pendingWriteTree_,e,n,s);const i=Y.fromObject(n);return Dn(t,new xn(fa(),e,i))}function ht(t,e,n=!1){const s=av(t.pendingWriteTree_,e);if(lv(t.pendingWriteTree_,e)){let r=new Y(null);return s.snap!=null?r=r.set(G(),!0):de(s.children,o=>{r=r.set(new q(o),!0)}),Dn(t,new xi(s.path,r,n))}else return[]}function Ms(t,e,n){return Dn(t,new Bt(pa(),e,n))}function Hv(t,e,n){const s=Y.fromObject(n);return Dn(t,new xn(pa(),e,s))}function Gv(t,e){return Dn(t,new bs(pa(),e))}function qv(t,e,n){const s=ba(t,n);if(s){const i=xa(s),r=i.path,o=i.queryId,a=_e(r,e),l=new bs(ma(o),a);return Sa(t,r,l)}else return[]}function Ri(t,e,n,s,i=!1){const r=e._path,o=t.syncPointTree_.get(r);let a=[];if(o&&(e._queryIdentifier==="default"||Ad(o,e))){const l=$v(o,e,n,s);Lv(o)&&(t.syncPointTree_=t.syncPointTree_.remove(r));const c=l.removed;if(a=l.events,!i){const u=c.findIndex(d=>d._queryParams.loadsAllData())!==-1,h=t.syncPointTree_.findOnPath(r,(d,f)=>_t(f));if(u&&!h){const d=t.syncPointTree_.subtree(r);if(!d.isEmpty()){const f=Yv(d);for(let p=0;p<f.length;++p){const m=f[p],_=m.query,v=Md(t,m);t.listenProvider_.startListening(os(_),xs(t,_),v.hashFn,v.onComplete)}}}!h&&c.length>0&&!s&&(u?t.listenProvider_.stopListening(os(e),null):c.forEach(d=>{const f=t.queryToTagMap.get(Yi(d));t.listenProvider_.stopListening(os(d),f)}))}Jv(t,c)}return a}function Dd(t,e,n,s){const i=ba(t,s);if(i!=null){const r=xa(i),o=r.path,a=r.queryId,l=_e(o,e),c=new Bt(ma(a),l,n);return Sa(t,o,c)}else return[]}function zv(t,e,n,s){const i=ba(t,s);if(i){const r=xa(i),o=r.path,a=r.queryId,l=_e(o,e),c=Y.fromObject(n),u=new xn(ma(a),l,c);return Sa(t,o,u)}else return[]}function bo(t,e,n,s=!1){const i=e._path;let r=null,o=!1;t.syncPointTree_.foreachOnPath(i,(d,f)=>{const p=_e(d,i);r=r||mt(f,p),o=o||_t(f)});let a=t.syncPointTree_.get(i);a?(o=o||_t(a),r=r||mt(a,G())):(a=new Pd,t.syncPointTree_=t.syncPointTree_.set(i,a));let l;r!=null?l=!0:(l=!1,r=j.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{const m=mt(p,G());m&&(r=r.updateImmediateChild(f,m))}));const c=Ad(a,e);if(!c&&!e._queryParams.loadsAllData()){const d=Yi(e);C(!t.queryToTagMap.has(d),"View does not exist, but we have a tag");const f=Qv();t.queryToTagMap.set(d,f),t.tagToQueryMap.set(f,d)}const u=zi(t.pendingWriteTree_,i);let h=Fv(a,e,n,u,r,l);if(!c&&!o&&!s){const d=Id(a,e);h=h.concat(Xv(t,e,d))}return h}function wa(t,e,n){const i=t.pendingWriteTree_,r=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=_e(o,e),c=mt(a,l);if(c)return c});return bd(i,e,r,n,!0)}function Kv(t,e){const n=e._path;let s=null;t.syncPointTree_.foreachOnPath(n,(c,u)=>{const h=_e(c,n);s=s||mt(u,h)});let i=t.syncPointTree_.get(n);i?s=s||mt(i,G()):(i=new Pd,t.syncPointTree_=t.syncPointTree_.set(n,i));const r=s!=null,o=r?new yt(s,!0,!1):null,a=zi(t.pendingWriteTree_,e._path),l=kd(i,e,a,r?o.getNode():j.EMPTY_NODE,r);return Av(l)}function Dn(t,e){return Od(e,t.syncPointTree_,null,zi(t.pendingWriteTree_,G()))}function Od(t,e,n,s){if(B(t.path))return jd(t,e,n,s);{const i=e.get(G());n==null&&i!=null&&(n=mt(i,G()));let r=[];const o=$(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const c=n?n.getImmediateChild(o):null,u=xd(s,o);r=r.concat(Od(a,l,c,u))}return i&&(r=r.concat(va(i,t,s,n))),r}}function jd(t,e,n,s){const i=e.get(G());n==null&&i!=null&&(n=mt(i,G()));let r=[];return e.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,c=xd(s,o),u=t.operationForChild(o);u&&(r=r.concat(jd(u,a,l,c)))}),i&&(r=r.concat(va(i,t,s,n))),r}function Md(t,e){const n=e.query,s=xs(t,n);return{hashFn:()=>(Iv(e)||j.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return s?qv(t,n._path,s):Gv(t,n._path);{const r=Gy(i,n);return Ri(t,n,null,r)}}}}function xs(t,e){const n=Yi(e);return t.queryToTagMap.get(n)}function Yi(t){return t._path.toString()+"$"+t._queryIdentifier}function ba(t,e){return t.tagToQueryMap.get(e)}function xa(t){const e=t.indexOf("$");return C(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new q(t.substr(0,e))}}function Sa(t,e,n){const s=t.syncPointTree_.get(e);C(s,"Missing sync point for query tag that we're tracking");const i=zi(t.pendingWriteTree_,e);return va(s,n,i,null)}function Yv(t){return t.fold((e,n,s)=>{if(n&&_t(n))return[Ki(n)];{let i=[];return n&&(i=Rd(n)),de(s,(r,o)=>{i=i.concat(o)}),i}})}function os(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(Vv())(t._repo,t._path):t}function Jv(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const i=Yi(s),r=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(r)}}}function Qv(){return Uv++}function Xv(t,e,n){const s=e._path,i=xs(t,e),r=Md(t,n),o=t.listenProvider_.startListening(os(e),i,r.hashFn,r.onComplete),a=t.syncPointTree_.subtree(s);if(i)C(!_t(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,u,h)=>{if(!B(c)&&u&&_t(u))return[Ki(u).query];{let d=[];return u&&(d=d.concat(Rd(u).map(f=>f.query))),de(h,(f,p)=>{d=d.concat(p)}),d}});for(let c=0;c<l.length;++c){const u=l[c];t.listenProvider_.stopListening(os(u),xs(t,u))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new Ea(n)}node(){return this.node_}}class Ca{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=X(this.path_,e);return new Ca(this.syncTree_,n)}node(){return wa(this.syncTree_,this.path_)}}const Zv=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},fc=function(t,e,n){if(!t||typeof t!="object")return t;if(C(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return ew(t[".sv"],e,n);if(typeof t[".sv"]=="object")return tw(t[".sv"],e);C(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},ew=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:C(!1,"Unexpected server value: "+t)}},tw=function(t,e,n){t.hasOwnProperty("increment")||C(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&C(!1,"Unexpected increment value: "+s);const i=e.node();if(C(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return s;const o=i.getValue();return typeof o!="number"?s:o+s},Ld=function(t,e,n,s){return Ta(e,new Ca(n,t),s)},Fd=function(t,e,n){return Ta(t,new Ea(e),n)};function Ta(t,e,n){const s=t.getPriority().val(),i=fc(s,e.getImmediateChild(".priority"),n);let r;if(t.isLeafNode()){const o=t,a=fc(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new ce(a,se(i)):t}else{const o=t;return r=o,i!==o.getPriority().val()&&(r=r.updatePriority(new ce(i))),o.forEachChild(ee,(a,l)=>{const c=Ta(l,e.getImmediateChild(a),n);c!==l&&(r=r.updateImmediateChild(a,c))}),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function ka(t,e){let n=e instanceof q?e:new q(e),s=t,i=$(n);for(;i!==null;){const r=_n(s.node.children,i)||{children:{},childCount:0};s=new Pa(i,s,r),n=z(n),i=$(n)}return s}function On(t){return t.node.value}function $d(t,e){t.node.value=e,xo(t)}function Bd(t){return t.node.childCount>0}function nw(t){return On(t)===void 0&&!Bd(t)}function Ji(t,e){de(t.node.children,(n,s)=>{e(new Pa(n,t,s))})}function Vd(t,e,n,s){n&&e(t),Ji(t,i=>{Vd(i,e,!0)})}function sw(t,e,n){let s=t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function Ls(t){return new q(t.parent===null?t.name:Ls(t.parent)+"/"+t.name)}function xo(t){t.parent!==null&&iw(t.parent,t.name,t)}function iw(t,e,n){const s=nw(n),i=Ue(t.node.children,e);s&&i?(delete t.node.children[e],t.node.childCount--,xo(t)):!s&&!i&&(t.node.children[e]=n.node,t.node.childCount++,xo(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rw=/[\[\].#$\/\u0000-\u001F\u007F]/,ow=/[\[\].#$\u0000-\u001F\u007F]/,Rr=10*1024*1024,Ra=function(t){return typeof t=="string"&&t.length!==0&&!rw.test(t)},Ud=function(t){return typeof t=="string"&&t.length!==0&&!ow.test(t)},aw=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Ud(t)},Wd=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Hi(t)||t&&typeof t=="object"&&Ue(t,".sv")},Ii=function(t,e,n,s){s&&e===void 0||Qi(vn(t,"value"),e,n)},Qi=function(t,e,n){const s=n instanceof q?new C_(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Rt(s));if(typeof e=="function")throw new Error(t+"contains a function "+Rt(s)+" with contents = "+e.toString());if(Hi(e))throw new Error(t+"contains "+e.toString()+" "+Rt(s));if(typeof e=="string"&&e.length>Rr/3&&Wi(e)>Rr)throw new Error(t+"contains a string greater than "+Rr+" utf8 bytes "+Rt(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,r=!1;if(de(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(r=!0,!Ra(o)))throw new Error(t+" contains an invalid key ("+o+") "+Rt(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);T_(s,o),Qi(t,a,s),P_(s)}),i&&r)throw new Error(t+' contains ".value" child '+Rt(s)+" in addition to actual children.")}},lw=function(t,e){let n,s;for(n=0;n<e.length;n++){s=e[n];const r=ys(s);for(let o=0;o<r.length;o++)if(!(r[o]===".priority"&&o===r.length-1)){if(!Ra(r[o]))throw new Error(t+"contains an invalid key ("+r[o]+") in path "+s.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(E_);let i=null;for(n=0;n<e.length;n++){if(s=e[n],i!==null&&Re(i,s))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+s.toString());i=s}},Hd=function(t,e,n,s){const i=vn(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const r=[];de(e,(o,a)=>{const l=new q(o);if(Qi(i,a,X(n,l)),aa(l)===".priority"&&!Wd(a))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");r.push(l)}),lw(i,r)},cw=function(t,e,n){if(Hi(e))throw new Error(vn(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Wd(e))throw new Error(vn(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},Gd=function(t,e,n,s){if(!Ud(n))throw new Error(vn(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},uw=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Gd(t,e,n)},Mt=function(t,e){if($(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},hw=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Ra(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!aw(n))throw new Error(vn(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Xi(t,e){let n=null;for(let s=0;s<e.length;s++){const i=e[s],r=i.getPath();n!==null&&!la(r,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:r}),n.events.push(i)}n&&t.eventLists_.push(n)}function qd(t,e,n){Xi(t,n),zd(t,s=>la(s,e))}function Ae(t,e,n){Xi(t,n),zd(t,s=>Re(s,e)||Re(e,s))}function zd(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const i=t.eventLists_[s];if(i){const r=i.path;e(r)?(fw(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function fw(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();ns&&he("event: "+n.toString()),An(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pw="repo_interrupt",mw=25;class gw{constructor(e,n,s,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new dw,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=bi(),this.transactionQueueTree_=new Pa,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function yw(t,e,n){if(t.stats_=ra(t.repoInfo_),t.forceRestClient_||Yy())t.server_=new wi(t.repoInfo_,(s,i,r,o)=>{pc(t,s,i,r,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>mc(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ae(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new Ye(t.repoInfo_,e,(s,i,r,o)=>{pc(t,s,i,r,o)},s=>{mc(t,s)},s=>{_w(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=e_(t.repoInfo_,()=>new Z_(t.stats_,t.server_)),t.infoData_=new K_,t.infoSyncTree_=new dc({startListening:(s,i,r,o)=>{let a=[];const l=t.infoData_.getNode(s._path);return l.isEmpty()||(a=Ms(t.infoSyncTree_,s._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),Ia(t,"connected",!1),t.serverSyncTree_=new dc({startListening:(s,i,r,o)=>(t.server_.listen(s,r,i,(a,l)=>{const c=o(a,l);Ae(t.eventQueue_,s._path,c)}),[]),stopListening:(s,i)=>{t.server_.unlisten(s,i)}})}function Kd(t){const n=t.infoData_.getNode(new q(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Zi(t){return Zv({timestamp:Kd(t)})}function pc(t,e,n,s,i){t.dataUpdateCount++;const r=new q(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(s){const l=pi(n,c=>se(c));o=zv(t.serverSyncTree_,r,l,i)}else{const l=se(n);o=Dd(t.serverSyncTree_,r,l,i)}else if(s){const l=pi(n,c=>se(c));o=Hv(t.serverSyncTree_,r,l)}else{const l=se(n);o=Ms(t.serverSyncTree_,r,l)}let a=r;o.length>0&&(a=En(t,r)),Ae(t.eventQueue_,a,o)}function mc(t,e){Ia(t,"connected",e),e===!1&&xw(t)}function _w(t,e){de(e,(n,s)=>{Ia(t,n,s)})}function Ia(t,e,n){const s=new q("/.info/"+e),i=se(n);t.infoData_.updateSnapshot(s,i);const r=Ms(t.infoSyncTree_,s,i);Ae(t.eventQueue_,s,r)}function Aa(t){return t.nextWriteId_++}function vw(t,e,n){const s=Kv(t.serverSyncTree_,e);return s!=null?Promise.resolve(s):t.server_.get(e).then(i=>{const r=se(i).withIndex(e._queryParams.getIndex());bo(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Ms(t.serverSyncTree_,e._path,r);else{const a=xs(t.serverSyncTree_,e);o=Dd(t.serverSyncTree_,e._path,r,a)}return Ae(t.eventQueue_,e._path,o),Ri(t.serverSyncTree_,e,n,null,!0),r},i=>(Fs(t,"get for query "+ae(e)+" failed: "+i),Promise.reject(new Error(i))))}function ww(t,e,n,s,i){Fs(t,"set",{path:e.toString(),value:n,priority:s});const r=Zi(t),o=se(n,s),a=wa(t.serverSyncTree_,e),l=Fd(o,a,r),c=Aa(t),u=Nd(t.serverSyncTree_,e,l,c,!0);Xi(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(d,f)=>{const p=d==="ok";p||ve("set at "+e+" failed: "+d);const m=ht(t.serverSyncTree_,c,!p);Ae(t.eventQueue_,e,m),vt(t,i,d,f)});const h=Da(t,e);En(t,h),Ae(t.eventQueue_,h,[])}function bw(t,e,n,s){Fs(t,"update",{path:e.toString(),value:n});let i=!0;const r=Zi(t),o={};if(de(n,(a,l)=>{i=!1,o[a]=Ld(X(e,a),se(l),t.serverSyncTree_,r)}),i)he("update() called with empty data.  Don't do anything."),vt(t,s,"ok",void 0);else{const a=Aa(t),l=Wv(t.serverSyncTree_,e,o,a);Xi(t.eventQueue_,l),t.server_.merge(e.toString(),n,(c,u)=>{const h=c==="ok";h||ve("update at "+e+" failed: "+c);const d=ht(t.serverSyncTree_,a,!h),f=d.length>0?En(t,e):e;Ae(t.eventQueue_,f,d),vt(t,s,c,u)}),de(n,c=>{const u=Da(t,X(e,c));En(t,u)}),Ae(t.eventQueue_,e,[])}}function xw(t){Fs(t,"onDisconnectEvents");const e=Zi(t),n=bi();mo(t.onDisconnect_,G(),(i,r)=>{const o=Ld(i,r,t.serverSyncTree_,e);Nn(n,i,o)});let s=[];mo(n,G(),(i,r)=>{s=s.concat(Ms(t.serverSyncTree_,i,r));const o=Da(t,i);En(t,o)}),t.onDisconnect_=bi(),Ae(t.eventQueue_,G(),s)}function Sw(t,e,n){t.server_.onDisconnectCancel(e.toString(),(s,i)=>{s==="ok"&&po(t.onDisconnect_,e),vt(t,n,s,i)})}function gc(t,e,n,s){const i=se(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(r,o)=>{r==="ok"&&Nn(t.onDisconnect_,e,i),vt(t,s,r,o)})}function Ew(t,e,n,s,i){const r=se(n,s);t.server_.onDisconnectPut(e.toString(),r.val(!0),(o,a)=>{o==="ok"&&Nn(t.onDisconnect_,e,r),vt(t,i,o,a)})}function Cw(t,e,n,s){if(so(n)){he("onDisconnect().update() called with empty data.  Don't do anything."),vt(t,s,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,r)=>{i==="ok"&&de(n,(o,a)=>{const l=se(a);Nn(t.onDisconnect_,X(e,o),l)}),vt(t,s,i,r)})}function Tw(t,e,n){let s;$(e._path)===".info"?s=bo(t.infoSyncTree_,e,n):s=bo(t.serverSyncTree_,e,n),qd(t.eventQueue_,e._path,s)}function Yd(t,e,n){let s;$(e._path)===".info"?s=Ri(t.infoSyncTree_,e,n):s=Ri(t.serverSyncTree_,e,n),qd(t.eventQueue_,e._path,s)}function Pw(t){t.persistentConnection_&&t.persistentConnection_.interrupt(pw)}function Fs(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),he(n,...e)}function vt(t,e,n,s){e&&An(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let r=i;s&&(r+=": "+s);const o=new Error(r);o.code=i,e(o)}})}function Jd(t,e,n){return wa(t.serverSyncTree_,e,n)||j.EMPTY_NODE}function Na(t,e=t.transactionQueueTree_){if(e||er(t,e),On(e)){const n=Xd(t,e);C(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&kw(t,Ls(e),n)}else Bd(e)&&Ji(e,n=>{Na(t,n)})}function kw(t,e,n){const s=n.map(c=>c.currentWriteId),i=Jd(t,e,s);let r=i;const o=i.hash();for(let c=0;c<n.length;c++){const u=n[c];C(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const h=_e(e,u.path);r=r.updateChild(h,u.currentOutputSnapshotRaw)}const a=r.val(!0),l=e;t.server_.put(l.toString(),a,c=>{Fs(t,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){const h=[];for(let d=0;d<n.length;d++)n[d].status=2,u=u.concat(ht(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&h.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();er(t,ka(t.transactionQueueTree_,e)),Na(t,t.transactionQueueTree_),Ae(t.eventQueue_,e,u);for(let d=0;d<h.length;d++)An(h[d])}else{if(c==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{ve("transaction at "+l.toString()+" failed: "+c);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=c}En(t,e)}},o)}function En(t,e){const n=Qd(t,e),s=Ls(n),i=Xd(t,n);return Rw(t,i,s),s}function Rw(t,e,n){if(e.length===0)return;const s=[];let i=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=_e(n,l.path);let u=!1,h;if(C(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,h=l.abortReason,i=i.concat(ht(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=mw)u=!0,h="maxretry",i=i.concat(ht(t.serverSyncTree_,l.currentWriteId,!0));else{const d=Jd(t,l.path,o);l.currentInputSnapshot=d;const f=e[a].update(d.val());if(f!==void 0){Qi("transaction failed: Data returned ",f,l.path);let p=se(f);typeof f=="object"&&f!=null&&Ue(f,".priority")||(p=p.updatePriority(d.getPriority()));const _=l.currentWriteId,v=Zi(t),b=Fd(p,d,v);l.currentOutputSnapshotRaw=p,l.currentOutputSnapshotResolved=b,l.currentWriteId=Aa(t),o.splice(o.indexOf(_),1),i=i.concat(Nd(t.serverSyncTree_,l.path,b,l.currentWriteId,l.applyLocally)),i=i.concat(ht(t.serverSyncTree_,_,!0))}else u=!0,h="nodata",i=i.concat(ht(t.serverSyncTree_,l.currentWriteId,!0))}Ae(t.eventQueue_,n,i),i=[],u&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?s.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):s.push(()=>e[a].onComplete(new Error(h),!1,null))))}er(t,t.transactionQueueTree_);for(let a=0;a<s.length;a++)An(s[a]);Na(t,t.transactionQueueTree_)}function Qd(t,e){let n,s=t.transactionQueueTree_;for(n=$(e);n!==null&&On(s)===void 0;)s=ka(s,n),e=z(e),n=$(e);return s}function Xd(t,e){const n=[];return Zd(t,e,n),n.sort((s,i)=>s.order-i.order),n}function Zd(t,e,n){const s=On(e);if(s)for(let i=0;i<s.length;i++)n.push(s[i]);Ji(e,i=>{Zd(t,i,n)})}function er(t,e){const n=On(e);if(n){let s=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[s]=n[i],s++);n.length=s,$d(e,n.length>0?n:void 0)}Ji(e,s=>{er(t,s)})}function Da(t,e){const n=Ls(Qd(t,e)),s=ka(t.transactionQueueTree_,e);return sw(s,i=>{Ir(t,i)}),Ir(t,s),Vd(s,i=>{Ir(t,i)}),n}function Ir(t,e){const n=On(e);if(n){const s=[];let i=[],r=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(C(r===o-1,"All SENT items should be at beginning of queue."),r=o,n[o].status=3,n[o].abortReason="set"):(C(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(ht(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&s.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));r===-1?$d(e,void 0):n.length=r+1,Ae(t.eventQueue_,Ls(e),i);for(let o=0;o<s.length;o++)An(s[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iw(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let i=n[s];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function Aw(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):ve(`Invalid query segment '${n}' in query '${t}'`)}return e}const yc=function(t,e){const n=Nw(t),s=n.namespace;n.domain==="firebase.com"&&et(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&et("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||By();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new td(n.host,n.secure,s,i,e,"",s!==n.subdomain),path:new q(n.pathString)}},Nw=function(t){let e="",n="",s="",i="",r="",o=!0,a="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let u=t.indexOf("/");u===-1&&(u=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(u,h)),u<h&&(i=Iw(t.substring(u,h)));const d=Aw(t.substring(Math.min(t.length,h)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const f=e.slice(0,c);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{const p=e.indexOf(".");s=e.substring(0,p).toLowerCase(),n=e.substring(p+1),r=s}"ns"in d&&(r=d.ns)}return{host:e,port:l,domain:n,subdomain:s,secure:o,scheme:a,pathString:i,namespace:r}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _c="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Dw=function(){let t=0;const e=[];return function(n){const s=n===t;t=n;let i;const r=new Array(8);for(i=7;i>=0;i--)r[i]=_c.charAt(n%64),n=Math.floor(n/64);C(n===0,"Cannot push at time == 0");let o=r.join("");if(s){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=_c.charAt(e[i]);return C(o.length===20,"nextPushId: Length should be 20."),o}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ow{constructor(e,n,s,i){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ae(this.snapshot.exportVal())}}class jw{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return C(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new Fe;return Sw(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Mt("OnDisconnect.remove",this._path);const e=new Fe;return gc(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Mt("OnDisconnect.set",this._path),Ii("OnDisconnect.set",e,this._path,!1);const n=new Fe;return gc(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){Mt("OnDisconnect.setWithPriority",this._path),Ii("OnDisconnect.setWithPriority",e,this._path,!1),cw("OnDisconnect.setWithPriority",n);const s=new Fe;return Ew(this._repo,this._path,e,n,s.wrapCallback(()=>{})),s.promise}update(e){Mt("OnDisconnect.update",this._path),Hd("OnDisconnect.update",e,this._path);const n=new Fe;return Cw(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(e,n,s,i){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=i}get key(){return B(this._path)?null:aa(this._path)}get ref(){return new st(this._repo,this._path)}get _queryIdentifier(){const e=nc(this._queryParams),n=sa(e);return n==="{}"?"default":n}get _queryObject(){return nc(this._queryParams)}isEqual(e){if(e=xt(e),!(e instanceof Oa))return!1;const n=this._repo===e._repo,s=la(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&s&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+S_(this._path)}}class st extends Oa{constructor(e,n){super(e,n,new da,!1)}get parent(){const e=ud(this._path);return e===null?null:new st(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Ss{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new q(e),s=Es(this.ref,e);return new Ss(this._node.getChild(n),s,ee)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,i)=>e(new Ss(i,Es(this.ref,s),ee)))}hasChild(e){const n=new q(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function re(t,e){return t=xt(t),t._checkNotDeleted("ref"),e!==void 0?Es(t._root,e):t._root}function Es(t,e){return t=xt(t),$(t._path)===null?uw("child","path",e):Gd("child","path",e),new st(t._repo,X(t._path,e))}function Qn(t){return t=xt(t),new Mw(t._repo,t._path)}function Ar(t,e){t=xt(t),Mt("push",t._path),Ii("push",e,t._path,!0);const n=Kd(t._repo),s=Dw(n),i=Es(t,s),r=Es(t,s);let o;return o=Promise.resolve(r),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function ot(t){return Mt("remove",t._path),Dt(t,null)}function Dt(t,e){t=xt(t),Mt("set",t._path),Ii("set",e,t._path,!1);const n=new Fe;return ww(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function Lw(t,e){Hd("update",e,t._path);const n=new Fe;return bw(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function Fw(t){t=xt(t);const e=new ef(()=>{}),n=new tr(e);return vw(t._repo,t,n).then(s=>new Ss(s,new st(t._repo,t._path),t._queryParams.getIndex()))}class tr{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new Ow("value",this,new Ss(e.snapshotNode,new st(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new jw(this,e,n):null}matches(e){return e instanceof tr?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function $w(t,e,n,s,i){const r=new ef(n,void 0),o=new tr(r);return Tw(t._repo,t,o),()=>Yd(t._repo,t,o)}function ln(t,e,n,s){return $w(t,"value",e)}function ct(t,e,n){Yd(t._repo,t,null)}jv(st);Bv(st);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bw="FIREBASE_DATABASE_EMULATOR_HOST",So={};let Vw=!1;function Uw(t,e,n,s){t.repoInfo_=new td(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),s&&(t.authTokenProvider_=s)}function Ww(t,e,n,s,i){let r=s||t.options.databaseURL;r===void 0&&(t.options.projectId||et("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),he("Using default host for project ",t.options.projectId),r=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=yc(r,i),a=o.repoInfo,l;typeof process<"u"&&Fl&&(l=Fl[Bw]),l?(r=`http://${l}?ns=${a.namespace}`,o=yc(r,i),a=o.repoInfo):o.repoInfo.secure;const c=new Qy(t.name,t.options,e);hw("Invalid Firebase Database URL",o),B(o.path)||et("Database URL must point to the root of a Firebase Database (not including a child path).");const u=Gw(a,t,c,new Jy(t.name,n));return new qw(u,t)}function Hw(t,e){const n=So[e];(!n||n[t.key]!==t)&&et(`Database ${e}(${t.repoInfo_}) has already been deleted.`),Pw(t),delete n[t.key]}function Gw(t,e,n,s){let i=So[e.name];i||(i={},So[e.name]=i);let r=i[t.toURLString()];return r&&et("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new gw(t,Vw,n,s),i[t.toURLString()]=r,r}class qw{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(yw(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new st(this._repo,G())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Hw(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&et("Cannot call "+e+" on a deleted database.")}}function zw(t=xy(),e){const n=_y(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const s=ag("database");s&&Kw(n,...s)}return n}function Kw(t,e,n,s={}){t=xt(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&et("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let r;if(i.repoInfo_.nodeAdmin)s.mockUserToken&&et('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),r=new oi(oi.OWNER);else if(s.mockUserToken){const o=typeof s.mockUserToken=="string"?s.mockUserToken:lg(s.mockUserToken,t.app.options.projectId);r=new oi(o)}Uw(i,e,n,r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yw(t){Oy(by),gi(new ps("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return Ww(s,i,r,n)},"PUBLIC").setMultipleInstances(!0)),pn($l,Bl,t),pn($l,Bl,"esm2017")}Ye.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Ye.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};Yw();const Jw={apiKey:"AIzaSyD_0KiG32r0nbl1IKitAboEVS4a9rvAqU0",authDomain:"players-ac5cf.firebaseapp.com",databaseURL:"https://players-ac5cf-default-rtdb.europe-west1.firebasedatabase.app",projectId:"players-ac5cf",storageBucket:"players-ac5cf.firebasestorage.app",messagingSenderId:"287145504979",appId:"1:287145504979:web:6d89629a89458d515fa426"},Qw=Fh(Jw),oe=zw(Qw);function Xw(){const[t,e]=y.useState(0),[n,s]=y.useState(!1),i=y.useRef(Math.random().toString(36).substring(7));return y.useEffect(()=>{const r=re(oe,".info/connected");ln(r,a=>{const l=a.val()===!0;if(s(l),l){const c=re(oe,`presence/${i.current}`);Dt(c,{online:!0,timestamp:Date.now()}),Qn(c).remove()}});const o=re(oe,"presence");return ln(o,a=>{const l=a.exists()?Object.keys(a.val()).length:0;e(l)}),()=>{ct(r),ct(o);const a=re(oe,`presence/${i.current}`);ot(a)}},[]),{onlinePlayers:t,isConnected:n}}const Zw={},vc=t=>{let e;const n=new Set,s=(u,h)=>{const d=typeof u=="function"?u(e):u;if(!Object.is(d,e)){const f=e;e=h??(typeof d!="object"||d===null)?d:Object.assign({},e,d),n.forEach(p=>p(e,f))}},i=()=>e,l={setState:s,getState:i,getInitialState:()=>c,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(Zw?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=e=t(s,i,l);return l},e0=t=>t?vc(t):vc;var tf={exports:{}},nf={},sf={exports:{}},rf={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cn=y;function t0(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var n0=typeof Object.is=="function"?Object.is:t0,s0=Cn.useState,i0=Cn.useEffect,r0=Cn.useLayoutEffect,o0=Cn.useDebugValue;function a0(t,e){var n=e(),s=s0({inst:{value:n,getSnapshot:e}}),i=s[0].inst,r=s[1];return r0(function(){i.value=n,i.getSnapshot=e,Nr(i)&&r({inst:i})},[t,n,e]),i0(function(){return Nr(i)&&r({inst:i}),t(function(){Nr(i)&&r({inst:i})})},[t]),o0(n),n}function Nr(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!n0(t,n)}catch{return!0}}function l0(t,e){return e()}var c0=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?l0:a0;rf.useSyncExternalStore=Cn.useSyncExternalStore!==void 0?Cn.useSyncExternalStore:c0;sf.exports=rf;var u0=sf.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nr=y,h0=u0;function d0(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var f0=typeof Object.is=="function"?Object.is:d0,p0=h0.useSyncExternalStore,m0=nr.useRef,g0=nr.useEffect,y0=nr.useMemo,_0=nr.useDebugValue;nf.useSyncExternalStoreWithSelector=function(t,e,n,s,i){var r=m0(null);if(r.current===null){var o={hasValue:!1,value:null};r.current=o}else o=r.current;r=y0(function(){function l(f){if(!c){if(c=!0,u=f,f=s(f),i!==void 0&&o.hasValue){var p=o.value;if(i(p,f))return h=p}return h=f}if(p=h,f0(u,f))return p;var m=s(f);return i!==void 0&&i(p,m)?(u=f,p):(u=f,h=m)}var c=!1,u,h,d=n===void 0?null:n;return[function(){return l(e())},d===null?void 0:function(){return l(d())}]},[e,n,s,i]);var a=p0(t,r[0],r[1]);return g0(function(){o.hasValue=!0,o.value=a},[a]),_0(a),a};tf.exports=nf;var v0=tf.exports;const w0=Im(v0),of={},{useDebugValue:b0}=Zo,{useSyncExternalStoreWithSelector:x0}=w0;let wc=!1;const S0=t=>t;function E0(t,e=S0,n){(of?"production":void 0)!=="production"&&n&&!wc&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),wc=!0);const s=x0(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return b0(s),s}const bc=t=>{(of?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?e0(t):t,n=(s,i)=>E0(e,s,i);return Object.assign(n,e),n},C0=t=>t?bc(t):bc,T0="modulepreload",P0=function(t){return"/"+t},xc={},$s=function(e,n,s){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=P0(l),l in xc)return;xc[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":T0,c||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),c)return new Promise((d,f)=>{h.addEventListener("load",d),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function r(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&r(a.reason);return e().catch(r)})},k0=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>$s(async()=>{const{default:s}=await Promise.resolve().then(()=>jn);return{default:s}},[]).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)};class ja extends Error{constructor(e,n="FunctionsError",s){super(e),this.name=n,this.context=s}}class R0 extends ja{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Sc extends ja{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ec extends ja{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Eo;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Eo||(Eo={}));var I0=function(t,e,n,s){function i(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):i(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};class A0{constructor(e,{headers:n={},customFetch:s,region:i=Eo.Any}={}){this.url=e,this.headers=n,this.region=i,this.fetch=k0(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var s;return I0(this,void 0,void 0,function*(){try{const{headers:i,method:r,body:o}=n;let a={},{region:l}=n;l||(l=this.region);const c=new URL(`${this.url}/${e}`);l&&l!=="any"&&(a["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;o&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(a["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(a["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(c.toString(),{method:r||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),i),body:u}).catch(m=>{throw new R0(m)}),d=h.headers.get("x-relay-error");if(d&&d==="true")throw new Sc(h);if(!h.ok)throw new Ec(h);let f=((s=h.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),p;return f==="application/json"?p=yield h.json():f==="application/octet-stream"?p=yield h.blob():f==="text/event-stream"?p=h:f==="multipart/form-data"?p=yield h.formData():p=yield h.text(),{data:p,error:null,response:h}}catch(i){return{data:null,error:i,response:i instanceof Ec||i instanceof Sc?i.context:void 0}}})}}var xe={},Ma={},sr={},Bs={},ir={},rr={},N0=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Tn=N0();const D0=Tn.fetch,af=Tn.fetch.bind(Tn),lf=Tn.Headers,O0=Tn.Request,j0=Tn.Response,jn=Object.freeze(Object.defineProperty({__proto__:null,Headers:lf,Request:O0,Response:j0,default:af,fetch:D0},Symbol.toStringTag,{value:"Module"})),M0=Am(jn);var or={};Object.defineProperty(or,"__esModule",{value:!0});let L0=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};or.default=L0;var cf=Ie&&Ie.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(rr,"__esModule",{value:!0});const F0=cf(M0),$0=cf(or);let B0=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=F0.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=Object.assign({},this.headers),this.headers[e]=n,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let i=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async r=>{var o,a,l;let c=null,u=null,h=null,d=r.status,f=r.statusText;if(r.ok){if(this.method!=="HEAD"){const v=await r.text();v===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=v:u=JSON.parse(v))}const m=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),_=(a=r.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");m&&_&&_.length>1&&(h=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,d=406,f="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const m=await r.text();try{c=JSON.parse(m),Array.isArray(c)&&r.status===404&&(u=[],c=null,d=200,f="OK")}catch{r.status===404&&m===""?(d=204,f="No Content"):c={message:m}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,d=200,f="OK"),c&&this.shouldThrowOnError)throw new $0.default(c)}return{error:c,data:u,count:h,status:d,statusText:f}});return this.shouldThrowOnError||(i=i.catch(r=>{var o,a,l;return{error:{message:`${(o=r==null?void 0:r.name)!==null&&o!==void 0?o:"FetchError"}: ${r==null?void 0:r.message}`,details:`${(a=r==null?void 0:r.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=r==null?void 0:r.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(e,n)}returns(){return this}overrideTypes(){return this}};rr.default=B0;var V0=Ie&&Ie.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ir,"__esModule",{value:!0});const U0=V0(rr);let W0=class extends U0.default{select(e){let n=!1;const s=(e??"*").split("").map(i=>/\s/.test(i)&&!n?"":(i==='"'&&(n=!n),i)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:s,foreignTable:i,referencedTable:r=i}={}){const o=r?`${r}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${n?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:s=n}={}){const i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,n,{foreignTable:s,referencedTable:i=s}={}){const r=typeof i>"u"?"offset":`${i}.offset`,o=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(r,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:s=!1,buffers:i=!1,wal:r=!1,format:o="text"}={}){var a;const l=[e?"analyze":null,n?"verbose":null,s?"settings":null,i?"buffers":null,r?"wal":null].filter(Boolean).join("|"),c=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${l};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};ir.default=W0;var H0=Ie&&Ie.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Bs,"__esModule",{value:!0});const G0=H0(ir);let q0=class extends G0.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const s=Array.from(new Set(n)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:s,type:i}={}){let r="";i==="plain"?r="pl":i==="phrase"?r="ph":i==="websearch"&&(r="w");const o=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${r}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,s])=>{this.url.searchParams.append(n,`eq.${s}`)}),this}not(e,n,s){return this.url.searchParams.append(e,`not.${n}.${s}`),this}or(e,{foreignTable:n,referencedTable:s=n}={}){const i=s?`${s}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,n,s){return this.url.searchParams.append(e,`${n}.${s}`),this}};Bs.default=q0;var z0=Ie&&Ie.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(sr,"__esModule",{value:!0});const Gn=z0(Bs);let K0=class{constructor(e,{headers:n={},schema:s,fetch:i}){this.url=e,this.headers=n,this.schema=s,this.fetch=i}select(e,{head:n=!1,count:s}={}){const i=n?"HEAD":"GET";let r=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",o),s&&(this.headers.Prefer=`count=${s}`),new Gn.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:s=!0}={}){const i="POST",r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),n&&r.push(`count=${n}`),s||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const o=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){const a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new Gn.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:s=!1,count:i,defaultToNull:r=!0}={}){const o="POST",a=[`resolution=${s?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&a.push(this.headers.Prefer),i&&a.push(`count=${i}`),r||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Gn.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const s="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),this.headers.Prefer=i.join(","),new Gn.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new Gn.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};sr.default=K0;var ar={},lr={};Object.defineProperty(lr,"__esModule",{value:!0});lr.version=void 0;lr.version="0.0.0-automated";Object.defineProperty(ar,"__esModule",{value:!0});ar.DEFAULT_HEADERS=void 0;const Y0=lr;ar.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Y0.version}`};var uf=Ie&&Ie.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ma,"__esModule",{value:!0});const J0=uf(sr),Q0=uf(Bs),X0=ar;let Z0=class hf{constructor(e,{headers:n={},schema:s,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},X0.DEFAULT_HEADERS),n),this.schemaName=s,this.fetch=i}from(e){const n=new URL(`${this.url}/${e}`);return new J0.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new hf(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:s=!1,get:i=!1,count:r}={}){let o;const a=new URL(`${this.url}/rpc/${e}`);let l;s||i?(o=s?"HEAD":"GET",Object.entries(n).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{a.searchParams.append(u,h)})):(o="POST",l=n);const c=Object.assign({},this.headers);return r&&(c.Prefer=`count=${r}`),new Q0.default({method:o,url:a,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Ma.default=Z0;var Mn=Ie&&Ie.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(xe,"__esModule",{value:!0});xe.PostgrestError=xe.PostgrestBuilder=xe.PostgrestTransformBuilder=xe.PostgrestFilterBuilder=xe.PostgrestQueryBuilder=xe.PostgrestClient=void 0;const df=Mn(Ma);xe.PostgrestClient=df.default;const ff=Mn(sr);xe.PostgrestQueryBuilder=ff.default;const pf=Mn(Bs);xe.PostgrestFilterBuilder=pf.default;const mf=Mn(ir);xe.PostgrestTransformBuilder=mf.default;const gf=Mn(rr);xe.PostgrestBuilder=gf.default;const yf=Mn(or);xe.PostgrestError=yf.default;var eb=xe.default={PostgrestClient:df.default,PostgrestQueryBuilder:ff.default,PostgrestFilterBuilder:pf.default,PostgrestTransformBuilder:mf.default,PostgrestBuilder:gf.default,PostgrestError:yf.default};const{PostgrestClient:tb,PostgrestQueryBuilder:uR,PostgrestFilterBuilder:hR,PostgrestTransformBuilder:dR,PostgrestBuilder:fR,PostgrestError:pR}=eb;function nb(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const sb=nb(),ib="2.11.15",rb=`realtime-js/${ib}`,ob="1.0.0",_f=1e4,ab=1e3;var as;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(as||(as={}));var pe;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(pe||(pe={}));var Oe;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Oe||(Oe={}));var Co;(function(t){t.websocket="websocket"})(Co||(Co={}));var Ot;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Ot||(Ot={}));class lb{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,n,s)}_decodeBroadcast(e,n,s){const i=n.getUint8(1),r=n.getUint8(2);let o=this.HEADER_LENGTH+2;const a=s.decode(e.slice(o,o+i));o=o+i;const l=s.decode(e.slice(o,o+r));o=o+r;const c=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class vf{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var K;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(K||(K={}));const Cc=(t,e,n={})=>{var s;const i=(s=n.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((r,o)=>(r[o]=cb(o,t,e,i),r),{})},cb=(t,e,n,s)=>{const i=e.find(a=>a.name===t),r=i==null?void 0:i.type,o=n[t];return r&&!s.includes(r)?wf(r,o):To(o)},wf=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return fb(e,n)}switch(t){case K.bool:return ub(e);case K.float4:case K.float8:case K.int2:case K.int4:case K.int8:case K.numeric:case K.oid:return hb(e);case K.json:case K.jsonb:return db(e);case K.timestamp:return pb(e);case K.abstime:case K.date:case K.daterange:case K.int4range:case K.int8range:case K.money:case K.reltime:case K.text:case K.time:case K.timestamptz:case K.timetz:case K.tsrange:case K.tstzrange:return To(e);default:return To(e)}},To=t=>t,ub=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},hb=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},db=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},fb=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,s=t[n];if(t[0]==="{"&&s==="}"){let r;const o=t.slice(1,n);try{r=JSON.parse("["+o+"]")}catch{r=o?o.split(","):[]}return r.map(a=>wf(e,a))}return t},pb=t=>typeof t=="string"?t.replace(" ","T"):t,bf=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Dr{constructor(e,n,s={},i=_f){this.channel=e,this.event=n,this.payload=s,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var s;return this._hasReceived(e)&&n((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Tc;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Tc||(Tc={}));class ls{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},i=>{const{onJoin:r,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ls.syncState(this.state,i,r,o),this.pendingDiffs.forEach(l=>{this.state=ls.syncDiff(this.state,l,r,o)}),this.pendingDiffs=[],a()}),this.channel._on(s.diff,{},i=>{const{onJoin:r,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=ls.syncDiff(this.state,i,r,o),a())}),this.onJoin((i,r,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:r,newPresences:o})}),this.onLeave((i,r,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:r,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,s,i){const r=this.cloneDeep(e),o=this.transformState(n),a={},l={};return this.map(r,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=r[c];if(h){const d=u.map(_=>_.presence_ref),f=h.map(_=>_.presence_ref),p=u.filter(_=>f.indexOf(_.presence_ref)<0),m=h.filter(_=>d.indexOf(_.presence_ref)<0);p.length>0&&(a[c]=p),m.length>0&&(l[c]=m)}else a[c]=u}),this.syncDiff(r,{joins:a,leaves:l},s,i)}static syncDiff(e,n,s,i){const{joins:r,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return s||(s=()=>{}),i||(i=()=>{}),this.map(r,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const h=e[a].map(f=>f.presence_ref),d=u.filter(f=>h.indexOf(f.presence_ref)<0);e[a].unshift(...d)}s(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[a]=c,i(a,c,l),c.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(s=>n(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,s)=>{const i=e[s];return"metas"in i?n[s]=i.metas.map(r=>(r.presence_ref=r.phx_ref,delete r.phx_ref,delete r.phx_ref_prev,r)):n[s]=i,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Pc;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Pc||(Pc={}));var kc;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(kc||(kc={}));var qe;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(qe||(qe={}));class La{constructor(e,n={config:{}},s){this.topic=e,this.params=n,this.socket=s,this.bindings={},this.state=pe.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Dr(this,Oe.join,this.params,this.timeout),this.rejoinTimer=new vf(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=pe.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=pe.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=pe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=pe.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Oe.reply,{},(i,r)=>{this._trigger(this._replyEventName(r),i)}),this.presence=new ls(this),this.broadcastEndpointURL=bf(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==pe.closed){const{config:{broadcast:r,presence:o,private:a}}=this.params;this._onError(u=>e==null?void 0:e(qe.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(qe.CLOSED));const l={},c={broadcast:r,presence:o,postgres_changes:(i=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(u=>u.filter))!==null&&i!==void 0?i:[],private:a};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){e==null||e(qe.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,f=(h=d==null?void 0:d.length)!==null&&h!==void 0?h:0,p=[];for(let m=0;m<f;m++){const _=d[m],{filter:{event:v,schema:b,table:w,filter:x}}=_,E=u&&u[m];if(E&&E.event===v&&E.schema===b&&E.table===w&&E.filter===x)p.push(Object.assign(Object.assign({},_),{id:E.id}));else{this.unsubscribe(),this.state=pe.errored,e==null||e(qe.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e(qe.SUBSCRIBED);return}}).receive("error",u=>{this.state=pe.errored,e==null||e(qe.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(qe.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,s){return this._on(e,n,s)}async send(e,n={}){var s,i;if(!this._canPush()&&e.type==="broadcast"){const{event:r,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(r=>{var o,a,l;const c=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&r("ok"),c.receive("ok",()=>r("ok")),c.receive("error",()=>r("error")),c.receive("timeout",()=>r("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=pe.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Oe.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(i=>{s=new Dr(this,Oe.leave,{},e),s.receive("ok",()=>{n(),i("ok")}).receive("timeout",()=>{n(),i("timed out")}).receive("error",()=>{i("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,n,s){const i=new AbortController,r=setTimeout(()=>i.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:i.signal}));return clearTimeout(r),o}_push(e,n,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Dr(this,e,n,s);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,n,s){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,s){var i,r;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=Oe;if(s&&[a,l,c,u].indexOf(o)>=0&&s!==this._joinRef())return;let d=this._onMessage(o,n,s);if(n&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(f=>{var p,m,_;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((_=(m=f.filter)===null||m===void 0?void 0:m.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===o}).map(f=>f.callback(d,s)):(r=this.bindings[o])===null||r===void 0||r.filter(f=>{var p,m,_,v,b,w;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const x=f.id,E=(p=f.filter)===null||p===void 0?void 0:p.event;return x&&((m=n.ids)===null||m===void 0?void 0:m.includes(x))&&(E==="*"||(E==null?void 0:E.toLocaleLowerCase())===((_=n.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const x=(b=(v=f==null?void 0:f.filter)===null||v===void 0?void 0:v.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return x==="*"||x===((w=n==null?void 0:n.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const p=d.data,{schema:m,table:_,commit_timestamp:v,type:b,errors:w}=p;d=Object.assign(Object.assign({},{schema:m,table:_,commit_timestamp:v,eventType:b,new:{},old:{},errors:w}),this._getPayloadRecords(p))}f.callback(d,s)})}_isClosed(){return this.state===pe.closed}_isJoined(){return this.state===pe.joined}_isJoining(){return this.state===pe.joining}_isLeaving(){return this.state===pe.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,s){const i=e.toLocaleLowerCase(),r={type:i,filter:n,callback:s};return this.bindings[i]?this.bindings[i].push(r):this.bindings[i]=[r],this}_off(e,n){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(i=>{var r;return!(((r=i.type)===null||r===void 0?void 0:r.toLocaleLowerCase())===s&&La.isEqual(i.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const s in e)if(e[s]!==n[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Oe.close,{},e)}_onError(e){this._on(Oe.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=pe.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Cc(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Cc(e.columns,e.old_record)),n}}const Rc=()=>{},mb=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class gb{constructor(e,n){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=_f,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Rc,this.ref=0,this.logger=Rc,this.conn=null,this.sendBuffer=[],this.serializer=new lb,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=r=>{let o;return r?o=r:typeof fetch>"u"?o=(...a)=>$s(async()=>{const{default:l}=await Promise.resolve().then(()=>jn);return{default:l}},void 0).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${Co.websocket}`,this.httpEndpoint=bf(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const i=(s=n==null?void 0:n.params)===null||s===void 0?void 0:s.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:r=>[1e3,2e3,5e3,1e4][r-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(r,o)=>o(JSON.stringify(r)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new vf(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=sb),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ob}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(s=>s.teardown()))}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,s){this.logger(e,n,s)}connectionState(){switch(this.conn&&this.conn.readyState){case as.connecting:return Ot.Connecting;case as.open:return Ot.Open;case as.closing:return Ot.Closing;default:return Ot.Closed}}isConnected(){return this.connectionState()===Ot.Open}channel(e,n={config:{}}){const s=`realtime:${e}`,i=this.getChannels().find(r=>r.topic===s);if(i)return i;{const r=new La(`realtime:${e}`,n,this);return this.channels.push(r),r}}push(e){const{topic:n,event:s,payload:i,ref:r}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${n} ${s} (${r})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(s=>{const i={access_token:n,version:rb};n&&s.updateJoinPayload(i),s.joinedOnce&&s._isJoined()&&s._push(Oe.access_token,{access_token:n})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(ab,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:s,event:i,payload:r,ref:o}=n;s==="phoenix"&&i==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${s} ${i} ${o&&"("+o+")"||""}`,r),Array.from(this.channels).filter(a=>a._isMember(s)).forEach(a=>a._trigger(i,r,o)),this.stateChangeCallbacks.message.forEach(a=>a(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Oe.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const s=e.match(/\?/)?"&":"?",i=new URLSearchParams(n);return`${e}${s}${i}`}_workerObjectUrl(e){let n;if(e)n=e;else{const s=new Blob([mb],{type:"application/javascript"});n=URL.createObjectURL(s)}return n}}class Fa extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function le(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class yb extends Fa{constructor(e,n,s){super(e),this.name="StorageApiError",this.status=n,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Po extends Fa{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var _b=function(t,e,n,s){function i(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):i(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const xf=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>$s(async()=>{const{default:s}=await Promise.resolve().then(()=>jn);return{default:s}},void 0).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)},vb=()=>_b(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield $s(()=>Promise.resolve().then(()=>jn),void 0)).Response:Response}),ko=t=>{if(Array.isArray(t))return t.map(n=>ko(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,s])=>{const i=n.replace(/([-_][a-z])/gi,r=>r.toUpperCase().replace(/[-_]/g,""));e[i]=ko(s)}),e},wb=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var Ht=function(t,e,n,s){function i(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):i(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const Or=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),bb=(t,e,n)=>Ht(void 0,void 0,void 0,function*(){const s=yield vb();t instanceof s&&!(n!=null&&n.noResolveJson)?t.json().then(i=>{const r=t.status||500,o=(i==null?void 0:i.statusCode)||r+"";e(new yb(Or(i),r,o))}).catch(i=>{e(new Po(Or(i),i))}):e(new Po(Or(t),t))}),xb=(t,e,n,s)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!s?i:(wb(s)?(i.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),i.body=JSON.stringify(s)):i.body=s,Object.assign(Object.assign({},i),n))};function Vs(t,e,n,s,i,r){return Ht(this,void 0,void 0,function*(){return new Promise((o,a)=>{t(n,xb(e,s,i,r)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>bb(l,a,s))})})}function Ai(t,e,n,s){return Ht(this,void 0,void 0,function*(){return Vs(t,"GET",e,n,s)})}function ze(t,e,n,s,i){return Ht(this,void 0,void 0,function*(){return Vs(t,"POST",e,s,i,n)})}function Ro(t,e,n,s,i){return Ht(this,void 0,void 0,function*(){return Vs(t,"PUT",e,s,i,n)})}function Sb(t,e,n,s){return Ht(this,void 0,void 0,function*(){return Vs(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),s)})}function Sf(t,e,n,s,i){return Ht(this,void 0,void 0,function*(){return Vs(t,"DELETE",e,s,i,n)})}var we=function(t,e,n,s){function i(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):i(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const Eb={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ic={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Cb{constructor(e,n={},s,i){this.url=e,this.headers=n,this.bucketId=s,this.fetch=xf(i)}uploadOrUpdate(e,n,s,i){return we(this,void 0,void 0,function*(){try{let r;const o=Object.assign(Object.assign({},Ic),i);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&s instanceof Blob?(r=new FormData,r.append("cacheControl",o.cacheControl),l&&r.append("metadata",this.encodeMetadata(l)),r.append("",s)):typeof FormData<"u"&&s instanceof FormData?(r=s,r.append("cacheControl",o.cacheControl),l&&r.append("metadata",this.encodeMetadata(l))):(r=s,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(a=Object.assign(Object.assign({},a),i.headers));const c=this._removeEmptyFolders(n),u=this._getFinalPath(c),h=yield(e=="PUT"?Ro:ze)(this.fetch,`${this.url}/object/${u}`,r,Object.assign({headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(r){if(le(r))return{data:null,error:r};throw r}})}upload(e,n,s){return we(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,s)})}uploadToSignedUrl(e,n,s,i){return we(this,void 0,void 0,function*(){const r=this._removeEmptyFolders(e),o=this._getFinalPath(r),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",n);try{let l;const c=Object.assign({upsert:Ic.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",c.cacheControl)):(l=s,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield Ro(this.fetch,a.toString(),l,{headers:u});return{data:{path:r,fullPath:h.Key},error:null}}catch(l){if(le(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,n){return we(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const i=Object.assign({},this.headers);n!=null&&n.upsert&&(i["x-upsert"]="true");const r=yield ze(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:i}),o=new URL(this.url+r.url),a=o.searchParams.get("token");if(!a)throw new Fa("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(s){if(le(s))return{data:null,error:s};throw s}})}update(e,n,s){return we(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,s)})}move(e,n,s){return we(this,void 0,void 0,function*(){try{return{data:yield ze(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(le(i))return{data:null,error:i};throw i}})}copy(e,n,s){return we(this,void 0,void 0,function*(){try{return{data:{path:(yield ze(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(le(i))return{data:null,error:i};throw i}})}createSignedUrl(e,n,s){return we(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),r=yield ze(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:n},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return r={signedUrl:encodeURI(`${this.url}${r.signedURL}${o}`)},{data:r,error:null}}catch(i){if(le(i))return{data:null,error:i};throw i}})}createSignedUrls(e,n,s){return we(this,void 0,void 0,function*(){try{const i=yield ze(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),r=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${r}`):null})),error:null}}catch(i){if(le(i))return{data:null,error:i};throw i}})}download(e,n){return we(this,void 0,void 0,function*(){const i=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=r?`?${r}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield Ai(this.fetch,`${this.url}/${i}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(le(a))return{data:null,error:a};throw a}})}info(e){return we(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const s=yield Ai(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:ko(s),error:null}}catch(s){if(le(s))return{data:null,error:s};throw s}})}exists(e){return we(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield Sb(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(le(s)&&s instanceof Po){const i=s.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,n){const s=this._getFinalPath(e),i=[],r=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";r!==""&&i.push(r);const a=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${s}${c}`)}}}remove(e){return we(this,void 0,void 0,function*(){try{return{data:yield Sf(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(le(n))return{data:null,error:n};throw n}})}list(e,n,s){return we(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},Eb),n),{prefix:e||""});return{data:yield ze(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},s),error:null}}catch(i){if(le(i))return{data:null,error:i};throw i}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const Tb="2.10.4",Pb={"X-Client-Info":`storage-js/${Tb}`};var Kt=function(t,e,n,s){function i(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):i(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};class kb{constructor(e,n={},s,i){const r=new URL(e);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(r.hostname)&&!r.hostname.includes("storage.supabase.")&&(r.hostname=r.hostname.replace("supabase.","storage.supabase.")),this.url=r.href,this.headers=Object.assign(Object.assign({},Pb),n),this.fetch=xf(s)}listBuckets(){return Kt(this,void 0,void 0,function*(){try{return{data:yield Ai(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(le(e))return{data:null,error:e};throw e}})}getBucket(e){return Kt(this,void 0,void 0,function*(){try{return{data:yield Ai(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(le(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return Kt(this,void 0,void 0,function*(){try{return{data:yield ze(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(le(s))return{data:null,error:s};throw s}})}updateBucket(e,n){return Kt(this,void 0,void 0,function*(){try{return{data:yield Ro(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(le(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Kt(this,void 0,void 0,function*(){try{return{data:yield ze(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(le(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Kt(this,void 0,void 0,function*(){try{return{data:yield Sf(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(le(n))return{data:null,error:n};throw n}})}}class Rb extends kb{constructor(e,n={},s,i){super(e,n,s,i)}from(e){return new Cb(this.url,this.headers,e,this.fetch)}}const Ib="2.53.0";let Xn="";typeof Deno<"u"?Xn="deno":typeof document<"u"?Xn="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Xn="react-native":Xn="node";const Ab={"X-Client-Info":`supabase-js-${Xn}/${Ib}`},Nb={headers:Ab},Db={schema:"public"},Ob={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},jb={};var Mb=function(t,e,n,s){function i(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):i(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};const Lb=t=>{let e;return t?e=t:typeof fetch>"u"?e=af:e=fetch,(...n)=>e(...n)},Fb=()=>typeof Headers>"u"?lf:Headers,$b=(t,e,n)=>{const s=Lb(n),i=Fb();return(r,o)=>Mb(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:t;let c=new i(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(r,Object.assign(Object.assign({},o),{headers:c}))})};var Bb=function(t,e,n,s){function i(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):i(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};function Vb(t){return t.endsWith("/")?t:t+"/"}function Ub(t,e){var n,s;const{db:i,auth:r,realtime:o,global:a}=t,{db:l,auth:c,realtime:u,global:h}=e,d={db:Object.assign(Object.assign({},l),i),auth:Object.assign(Object.assign({},c),r),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{}),(s=a==null?void 0:a.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>Bb(this,void 0,void 0,function*(){return""})};return t.accessToken?d.accessToken=t.accessToken:delete d.accessToken,d}const Ef="2.71.1",rn=30*1e3,Io=3,jr=Io*rn,Wb="http://localhost:9999",Hb="supabase.auth.token",Gb={"X-Client-Info":`gotrue-js/${Ef}`},Ao="X-Supabase-Api-Version",Cf={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},qb=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,zb=10*60*1e3;class $a extends Error{constructor(e,n,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=s}}function F(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Kb extends $a{constructor(e,n,s){super(e,n,s),this.name="AuthApiError",this.status=n,this.code=s}}function Yb(t){return F(t)&&t.name==="AuthApiError"}class Tf extends $a{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class St extends $a{constructor(e,n,s,i){super(e,s,i),this.name=n,this.status=s}}class at extends St{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Jb(t){return F(t)&&t.name==="AuthSessionMissingError"}class Qs extends St{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Xs extends St{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Zs extends St{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Qb(t){return F(t)&&t.name==="AuthImplicitGrantRedirectError"}class Ac extends St{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class No extends St{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Mr(t){return F(t)&&t.name==="AuthRetryableFetchError"}class Nc extends St{constructor(e,n,s){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=s}}class Do extends St{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ni="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Dc=` 	
\r=`.split(""),Xb=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Dc.length;e+=1)t[Dc[e].charCodeAt(0)]=-2;for(let e=0;e<Ni.length;e+=1)t[Ni[e].charCodeAt(0)]=e;return t})();function Oc(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Ni[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Ni[s]),e.queuedBits-=6}}function Pf(t,e,n){const s=Xb[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function jc(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},r=o=>{tx(o,s,n)};for(let o=0;o<t.length;o+=1)Pf(t.charCodeAt(o),i,r);return e.join("")}function Zb(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function ex(t,e){for(let n=0;n<t.length;n+=1){let s=t.charCodeAt(n);if(s>55295&&s<=56319){const i=(s-55296)*1024&65535;s=(t.charCodeAt(n+1)-56320&65535|i)+65536,n+=1}Zb(s,e)}}function tx(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function nx(t){const e=[],n={queue:0,queuedBits:0},s=i=>{e.push(i)};for(let i=0;i<t.length;i+=1)Pf(t.charCodeAt(i),n,s);return new Uint8Array(e)}function sx(t){const e=[];return ex(t,n=>e.push(n)),new Uint8Array(e)}function ix(t){const e=[],n={queue:0,queuedBits:0},s=i=>{e.push(i)};return t.forEach(i=>Oc(i,n,s)),Oc(null,n,s),e.join("")}function rx(t){return Math.round(Date.now()/1e3)+t}function ox(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Ne=()=>typeof window<"u"&&typeof document<"u",Ct={tested:!1,writable:!1},kf=()=>{if(!Ne())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ct.tested)return Ct.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ct.tested=!0,Ct.writable=!0}catch{Ct.tested=!0,Ct.writable=!1}return Ct.writable};function ax(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((i,r)=>{e[r]=i})}catch{}return n.searchParams.forEach((s,i)=>{e[i]=s}),e}const Rf=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>$s(async()=>{const{default:s}=await Promise.resolve().then(()=>jn);return{default:s}},void 0).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)},lx=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",on=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Tt=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},rt=async(t,e)=>{await t.removeItem(e)};class cr{constructor(){this.promise=new cr.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}cr.promiseConstructor=Promise;function Lr(t){const e=t.split(".");if(e.length!==3)throw new Do("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!qb.test(e[s]))throw new Do("JWT not in base64url format");return{header:JSON.parse(jc(e[0])),payload:JSON.parse(jc(e[1])),signature:nx(e[2]),raw:{header:e[0],payload:e[1]}}}async function cx(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function ux(t,e){return new Promise((s,i)=>{(async()=>{for(let r=0;r<1/0;r++)try{const o=await t(r);if(!e(r,null,o)){s(o);return}}catch(o){if(!e(r,o)){i(o);return}}})()})}function hx(t){return("0"+t.toString(16)).substr(-2)}function dx(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=n.length;let i="";for(let r=0;r<56;r++)i+=n.charAt(Math.floor(Math.random()*s));return i}return crypto.getRandomValues(e),Array.from(e,hx).join("")}async function fx(t){const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n),i=new Uint8Array(s);return Array.from(i).map(r=>String.fromCharCode(r)).join("")}async function px(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await fx(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Yt(t,e,n=!1){const s=dx();let i=s;n&&(i+="/PASSWORD_RECOVERY"),await on(t,`${e}-code-verifier`,i);const r=await px(s);return[r,s===r?"plain":"s256"]}const mx=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function gx(t){const e=t.headers.get(Ao);if(!e||!e.match(mx))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function yx(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function _x(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const vx=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Jt(t){if(!vx.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Fr(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Mc(t){return JSON.parse(JSON.stringify(t))}var wx=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(t);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(t,s[i])&&(n[s[i]]=t[s[i]]);return n};const It=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),bx=[502,503,504];async function Lc(t){var e;if(!lx(t))throw new No(It(t),0);if(bx.includes(t.status))throw new No(It(t),t.status);let n;try{n=await t.json()}catch(r){throw new Tf(It(r),r)}let s;const i=gx(t);if(i&&i.getTime()>=Cf["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?s=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(s=n.error_code),s){if(s==="weak_password")throw new Nc(It(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new at}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((r,o)=>r&&typeof o=="string",!0))throw new Nc(It(n),t.status,n.weak_password.reasons);throw new Kb(It(n),t.status||500,s)}const xx=(t,e,n,s)=>{const i={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),i.body=JSON.stringify(s),Object.assign(Object.assign({},i),n))};async function U(t,e,n,s){var i;const r=Object.assign({},s==null?void 0:s.headers);r[Ao]||(r[Ao]=Cf["2024-01-01"].name),s!=null&&s.jwt&&(r.Authorization=`Bearer ${s.jwt}`);const o=(i=s==null?void 0:s.query)!==null&&i!==void 0?i:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await Sx(t,e,n+a,{headers:r,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function Sx(t,e,n,s,i,r){const o=xx(e,s,i,r);let a;try{a=await t(n,Object.assign({},o))}catch(l){throw console.error(l),new No(It(l),0)}if(a.ok||await Lc(a),s!=null&&s.noResolveJson)return a;try{return await a.json()}catch(l){await Lc(l)}}function Ge(t){var e;let n=null;Px(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=rx(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:s},error:null}}function Fc(t){const e=Ge(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,s)=>n&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function ut(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Ex(t){return{data:t,error:null}}function Cx(t){const{action_link:e,email_otp:n,hashed_token:s,redirect_to:i,verification_type:r}=t,o=wx(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:s,redirect_to:i,verification_type:r},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function Tx(t){return t}function Px(t){return t.access_token&&t.refresh_token&&t.expires_in}const $r=["global","local","others"];var kx=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(t);i<s.length;i++)e.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(t,s[i])&&(n[s[i]]=t[s[i]]);return n};class Rx{constructor({url:e="",headers:n={},fetch:s}){this.url=e,this.headers=n,this.fetch=Rf(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=$r[0]){if($r.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${$r.join(", ")}`);try{return await U(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(F(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,n={}){try{return await U(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:ut})}catch(s){if(F(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:n}=e,s=kx(e,["options"]),i=Object.assign(Object.assign({},s),n);return"newEmail"in s&&(i.new_email=s==null?void 0:s.newEmail,delete i.newEmail),await U(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:Cx,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(F(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await U(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ut})}catch(n){if(F(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,s,i,r,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await U(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(r=(i=e==null?void 0:e.perPage)===null||i===void 0?void 0:i.toString())!==null&&r!==void 0?r:""},xform:Tx});if(u.error)throw u.error;const h=await u.json(),d=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(p=>{const m=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(p.split(";")[1].split("=")[1]);c[`${_}Page`]=m}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(F(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Jt(e);try{return await U(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ut})}catch(n){if(F(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Jt(e);try{return await U(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:ut})}catch(s){if(F(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,n=!1){Jt(e);try{return await U(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:ut})}catch(s){if(F(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Jt(e.userId);try{const{data:n,error:s}=await U(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:n,error:s}}catch(n){if(F(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Jt(e.userId),Jt(e.id);try{return{data:await U(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(F(n))return{data:null,error:n};throw n}}}function $c(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function Ix(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Qt={debug:!!(globalThis&&kf()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class If extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Ax extends If{}async function Nx(t,e,n){Qt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Qt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async i=>{if(i){Qt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,i.name);try{return await n()}finally{Qt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,i.name)}}else{if(e===0)throw Qt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Ax(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Qt.debug)try{const r=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(r,null,"  "))}catch(r){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",r)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}Ix();const Dx={url:Wb,storageKey:Hb,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Gb,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Bc(t,e,n){return await n()}const Xt={};class Cs{constructor(e){var n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Cs.nextInstanceID,Cs.nextInstanceID+=1,this.instanceID>0&&Ne()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},Dx),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Rx({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Rf(i.fetch),this.lock=i.lock||Bc,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:Ne()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Nx:this.lock=Bc,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:kf()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=$c(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=$c(this.memoryStorage)),Ne()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(r){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",r)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async r=>{this._debug("received broadcast notification from other tab or client",r),await this._notifyAllSubscribers(r.data.event,r.data.session,!1)})}this.initialize()}get jwks(){var e,n;return(n=(e=Xt[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){Xt[this.storageKey]=Object.assign(Object.assign({},Xt[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=Xt[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Xt[this.storageKey]=Object.assign(Object.assign({},Xt[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Ef}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=ax(window.location.href);let s="none";if(this._isImplicitGrantCallback(n)?s="implicit":await this._isPKCECallback(n)&&(s="pkce"),Ne()&&this.detectSessionInUrl&&s!=="none"){const{data:i,error:r}=await this._getSessionFromURL(n,s);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),Qb(r)){const l=(e=r.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:r}}return await this._removeSession(),{error:r}}const{session:o,redirectType:a}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return F(n)?{error:n}:{error:new Tf("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,s,i;try{const r=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(i=e==null?void 0:e.options)===null||i===void 0?void 0:i.captchaToken}},xform:Ge}),{data:o,error:a}=r;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(r){if(F(r))return{data:{user:null,session:null},error:r};throw r}}async signUp(e){var n,s,i;try{let r;if("email"in e){const{email:u,password:h,options:d}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await Yt(this.storage,this.storageKey)),r=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:h,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:p},xform:Ge})}else if("phone"in e){const{phone:u,password:h,options:d}=e;r=await U(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=d==null?void 0:d.data)!==null&&s!==void 0?s:{},channel:(i=d==null?void 0:d.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Ge})}else throw new Xs("You must provide either an email or phone number and a password");const{data:o,error:a}=r;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(r){if(F(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithPassword(e){try{let n;if("email"in e){const{email:r,password:o,options:a}=e;n=await U(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Fc})}else if("phone"in e){const{phone:r,password:o,options:a}=e;n=await U(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:Fc})}else throw new Xs("You must provide either an email or phone number and a password");const{data:s,error:i}=n;return i?{data:{user:null,session:null},error:i}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Qs}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:i})}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,s,i,r;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(r=e.options)===null||r===void 0?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,s,i,r,o,a,l,c,u,h,d,f;let p,m;if("message"in e)p=e.message,m=e.signature;else{const{chain:_,wallet:v,statement:b,options:w}=e;let x;if(Ne())if(typeof v=="object")x=v;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))x=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=v}const E=new URL((n=w==null?void 0:w.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in x&&x.signIn){const k=await x.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),b?{statement:b}:null));let M;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")M=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)M=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in M&&"signature"in M&&(typeof M.signedMessage=="string"||M.signedMessage instanceof Uint8Array)&&M.signature instanceof Uint8Array)p=typeof M.signedMessage=="string"?M.signedMessage:new TextDecoder().decode(M.signedMessage),m=M.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in x)||typeof x.signMessage!="function"||!("publicKey"in x)||typeof x!="object"||!x.publicKey||!("toBase58"in x.publicKey)||typeof x.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${E.host} wants you to sign in with your Solana account:`,x.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(i=(s=w==null?void 0:w.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((r=w==null?void 0:w.signInWithSolana)===null||r===void 0)&&r.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((a=w==null?void 0:w.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((h=(u=w==null?void 0:w.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...w.signInWithSolana.resources.map(M=>`- ${M}`)]:[]].join(`
`);const k=await x.signMessage(new TextEncoder().encode(p),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=k}}try{const{data:_,error:v}=await U(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:ix(m)},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Ge});if(v)throw v;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new Qs}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:v})}catch(_){if(F(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(e){const n=await Tt(this.storage,`${this.storageKey}-code-verifier`),[s,i]=(n??"").split("/");try{const{data:r,error:o}=await U(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Ge});if(await rt(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!r||!r.session||!r.user?{data:{user:null,session:null,redirectType:null},error:new Qs}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign(Object.assign({},r),{redirectType:i??null}),error:o})}catch(r){if(F(r))return{data:{user:null,session:null,redirectType:null},error:r};throw r}}async signInWithIdToken(e){try{const{options:n,provider:s,token:i,access_token:r,nonce:o}=e,a=await U(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:i,access_token:r,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Ge}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Qs}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,s,i,r,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Yt(this.storage,this.storageKey));const{error:h}=await U(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await U(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Xs("You must provide either an email or phone number.")}catch(a){if(F(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var n,s;try{let i,r;"options"in e&&(i=(n=e.options)===null||n===void 0?void 0:n.redirectTo,r=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:a}=await U(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:r}}),redirectTo:i,xform:Ge});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(F(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var n,s,i;try{let r=null,o=null;return this.flowType==="pkce"&&([r,o]=await Yt(this.storage,this.storageKey)),await U(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&s!==void 0?s:void 0}),!((i=e==null?void 0:e.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:r,code_challenge_method:o}),headers:this.headers,xform:Ex})}catch(r){if(F(r))return{data:null,error:r};throw r}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;if(s)throw s;if(!n)throw new at;const{error:i}=await U(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(F(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:s,type:i,options:r}=e,{error:o}=await U(this.fetch,"POST",n,{headers:this.headers,body:{email:s,type:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},redirectTo:r==null?void 0:r.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:i,options:r}=e,{data:o,error:a}=await U(this.fetch,"POST",n,{headers:this.headers,body:{phone:s,type:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new Xs("You must provide either an email or phone number and a type")}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await s,await n()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=n();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Tt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<jr:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await Tt(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Fr()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:i,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{session:null},error:r}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await U(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ut}):await this._useSession(async n=>{var s,i,r;const{data:o,error:a}=n;if(a)throw a;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new at}:await U(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(r=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&r!==void 0?r:void 0,xform:ut})})}catch(n){if(F(n))return Jb(n)&&(await this._removeSession(),await rt(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async s=>{const{data:i,error:r}=s;if(r)throw r;if(!i.session)throw new at;const o=i.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Yt(this.storage,this.storageKey));const{data:c,error:u}=await U(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:ut});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(F(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new at;const n=Date.now()/1e3;let s=n,i=!0,r=null;const{payload:o}=Lr(e.access_token);if(o.exp&&(s=o.exp,i=s<=n),i){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};r=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;r={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:s-n,expires_at:s},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return{data:{user:r.user,session:r},error:null}}catch(n){if(F(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var s;if(!e){const{data:o,error:a}=n;if(a)throw a;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new at;const{session:i,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{user:null,session:null},error:r}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!Ne())throw new Zs("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Zs(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Ac("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Zs("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ac("No code detected.");const{data:b,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const x=new URL(window.location.href);return x.searchParams.delete("code"),window.history.replaceState(window.history.state,"",x.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:i,access_token:r,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!r||!a||!o||!c)throw new Zs("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(a);let d=u+h;l&&(d=parseInt(l));const f=d-u;f*1e3<=rn&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const p=d-h;u-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,u):u-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,d,u);const{data:m,error:_}=await this._getUser(r);if(_)throw _;const v={provider_token:s,provider_refresh_token:i,access_token:r,expires_in:h,expires_at:d,refresh_token:o,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:e.type},error:null}}catch(s){if(F(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Tt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var s;const{data:i,error:r}=n;if(r)return{error:r};const o=(s=i.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(Yb(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await rt(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=ox(),s={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async n=>{var s,i;try{const{data:{session:r},error:o}=n;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(r){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",r),console.error(r)}})}async resetPasswordForEmail(e,n={}){let s=null,i=null;this.flowType==="pkce"&&([s,i]=await Yt(this.storage,this.storageKey,!0));try{return await U(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:i,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(r){if(F(r))return{data:null,error:r};throw r}}async getUserIdentities(){var e;try{const{data:n,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(F(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:s,error:i}=await this._useSession(async r=>{var o,a,l,c,u;const{data:h,error:d}=r;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await U(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return Ne()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(F(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var s,i;const{data:r,error:o}=n;if(o)throw o;return await U(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(s=r.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0})})}catch(n){if(F(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const s=Date.now();return await ux(async i=>(i>0&&await cx(200*Math.pow(2,i-1)),this._debug(n,"refreshing attempt",i),await U(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ge})),(i,r)=>{const o=200*Math.pow(2,i);return r&&Mr(r)&&Date.now()+o-s<rn})}catch(s){if(this._debug(n,"error",s),F(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",s),Ne()&&!n.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,n;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const i=await Tt(this.storage,this.storageKey);if(i&&this.userStorage){let o=await Tt(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await on(this.userStorage,this.storageKey+"-user",o)),i.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Fr()}else if(i&&!i.user&&!i.user){const o=await Tt(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,await rt(this.storage,this.storageKey+"-user"),await on(this.storage,this.storageKey,i)):i.user=Fr()}if(this._debug(s,"session from storage",i),!this._isValidSession(i)){this._debug(s,"session is not valid"),i!==null&&await this._removeSession();return}const r=((n=i.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<jr;if(this._debug(s,`session has${r?"":" not"} expired with margin of ${jr}s`),r){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),Mr(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(i.access_token);!a&&(o!=null&&o.user)?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(s,"error",i),console.error(i);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var n,s;if(!e)throw new at;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new cr;const{data:r,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!r.session)throw new at;await this._saveSession(r.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",r.session);const a={session:r.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(r){if(this._debug(i,"error",r),F(r)){const o={session:null,error:r};return Mr(r)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(r),r}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,n,s=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",n,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:n});const r=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(l){r.push(l)}});if(await Promise.all(o),r.length>0){for(let a=0;a<r.length;a+=1)console.error(r[a]);throw r[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),s=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&n.user&&await on(this.userStorage,this.storageKey+"-user",{user:n.user});const i=Object.assign({},n);delete i.user;const r=Mc(i);await on(this.storage,this.storageKey,r)}else{const i=Mc(n);await on(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await rt(this.storage,this.storageKey),await rt(this.storage,this.storageKey+"-code-verifier"),await rt(this.storage,this.storageKey+"-user"),this.userStorage&&await rt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ne()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),rn);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:s}}=n;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((s.expires_at*1e3-e)/rn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${rn}ms, refresh threshold is ${Io} ticks`),i<=Io&&await this._callRefreshToken(s.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof If)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ne()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,s){const i=[`provider=${encodeURIComponent(n)}`];if(s!=null&&s.redirectTo&&i.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&i.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[r,o]=await Yt(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(r)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(a.toString())}if(s!=null&&s.queryParams){const r=new URLSearchParams(s.queryParams);i.push(r.toString())}return s!=null&&s.skipBrowserRedirect&&i.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var s;const{data:i,error:r}=n;return r?{data:null,error:r}:await U(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(F(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var s,i;const{data:r,error:o}=n;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await U(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(n){if(F(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:i,error:r}=n;if(r)return{data:null,error:r};const{data:o,error:a}=await U(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(n){if(F(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:i,error:r}=n;return r?{data:null,error:r}:await U(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(F(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const s=(e==null?void 0:e.factors)||[],i=s.filter(o=>o.factor_type==="totp"&&o.status==="verified"),r=s.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:s,totp:i,phone:r},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,s;const{data:{session:i},error:r}=e;if(r)return{data:null,error:r};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Lr(i.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((s=(n=i.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,n={keys:[]}){let s=n.keys.find(a=>a.kid===e);if(s)return s;const i=Date.now();if(s=this.jwks.keys.find(a=>a.kid===e),s&&this.jwks_cached_at+zb>i)return s;const{data:r,error:o}=await U(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!r.keys||r.keys.length===0||(this.jwks=r,this.jwks_cached_at=i,s=r.keys.find(a=>a.kid===e),!s)?null:s}async getClaims(e,n={}){try{let s=e;if(!s){const{data:f,error:p}=await this.getSession();if(p||!f.session)return{data:null,error:p};s=f.session.access_token}const{header:i,payload:r,signature:o,raw:{header:a,payload:l}}=Lr(s);n!=null&&n.allowExpired||yx(r.exp);const c=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!c){const{error:f}=await this.getUser(s);if(f)throw f;return{data:{claims:r,header:i,signature:o},error:null}}const u=_x(i.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,sx(`${a}.${l}`)))throw new Do("Invalid JWT signature");return{data:{claims:r,header:i,signature:o},error:null}}catch(s){if(F(s))return{data:null,error:s};throw s}}}Cs.nextInstanceID=0;const Ox=Cs;class jx extends Ox{constructor(e){super(e)}}var Mx=function(t,e,n,s){function i(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function a(u){try{c(s.next(u))}catch(h){o(h)}}function l(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?r(u.value):i(u.value).then(a,l)}c((s=s.apply(t,e||[])).next())})};class Lx{constructor(e,n,s){var i,r,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const a=Vb(e),l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:Db,realtime:jb,auth:Object.assign(Object.assign({},Ob),{storageKey:c}),global:Nb},h=Ub(s??{},u);this.storageKey=(i=h.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(r=h.global.headers)!==null&&r!==void 0?r:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=$b(n,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new tb(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new Rb(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new A0(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},s={}){return this.rest.rpc(e,n,s)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return Mx(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(n=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:i,storageKey:r,flowType:o,lock:a,debug:l},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new jx({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),c),storageKey:r,autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:i,flowType:o,lock:a,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new gb(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,s)=>{this._handleTokenChanged(n,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,n,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Fx=(t,e,n)=>new Lx(t,e,n);function $x(){if(typeof window<"u"||typeof process>"u"||process.version===void 0||process.version===null)return!1;const t=process.version.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}$x()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Bx="https://dbiuikysjrnzxiguhnsc.supabase.co",Vx="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRiaXVpa3lzanJuenhpZ3VobnNjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM5NjQ3MDAsImV4cCI6MjA2OTU0MDcwMH0.O0Wc8Pzf1qJW5P3gw-itj5kYW6pQOaN8pEfBcpsDeWE",be=Fx(Bx,Vx),yn=C0((t,e)=>({user:null,loading:!1,error:null,profile:null,initializeAuth:async()=>{var n;t({loading:!0});try{const{data:{session:s}}=await be.auth.getSession();if(s!=null&&s.user){const i=await e().getUserProfile(s.user.id);t({user:{uid:s.user.id,email:s.user.email??null,displayName:(i==null?void 0:i.username)||((n=s.user.email)==null?void 0:n.split("@")[0])||null,photoURL:(i==null?void 0:i.avatar_url)||null,username:i==null?void 0:i.username,allowMessages:i==null?void 0:i.allow_messages},profile:i})}}catch(s){console.error("Error initializing auth:",s)}finally{t({loading:!1})}},signInWithTwitter:async()=>{t({loading:!0,error:null});try{const{error:n}=await be.auth.signInWithOAuth({provider:"twitter"});if(n)throw n}catch(n){throw t({error:n.message||"Failed to sign in with Twitter"}),n}finally{t({loading:!1})}},signInWithFacebook:async()=>{t({loading:!0,error:null});try{const{error:n}=await be.auth.signInWithOAuth({provider:"facebook"});if(n)throw n}catch(n){throw t({error:n.message||"Failed to sign in with Facebook"}),n}finally{t({loading:!1})}},signInWithEmail:async(n,s)=>{var i;t({loading:!0,error:null});try{const{data:r,error:o}=await be.auth.signInWithPassword({email:n,password:s});if(o)throw o;if(r.user){const a=await e().getUserProfile(r.user.id);t({user:{uid:r.user.id,email:r.user.email??null,displayName:(a==null?void 0:a.username)||((i=r.user.email)==null?void 0:i.split("@")[0])||null,photoURL:(a==null?void 0:a.avatar_url)||null,username:a==null?void 0:a.username,allowMessages:a==null?void 0:a.allow_messages},profile:a})}}catch(r){throw t({error:r.message}),r}finally{t({loading:!1})}},signUp:async(n,s,i)=>{t({loading:!0,error:null});try{if(!/^[a-zA-Z0-9_]{6,}$/.test(i))throw new Error("Username must be at least 6 alphanumeric characters (underscores allowed)");const{data:r,error:o}=await be.auth.signUp({email:n,password:s,options:{data:{username:i}}});if(o)throw o;if(r.user){const{error:a}=await be.from("profiles").insert({id:r.user.id,username:i,email:n,allow_messages:!0});if(a)throw a;t({user:{uid:r.user.id,email:r.user.email??null,displayName:i,photoURL:null,username:i,allowMessages:!0}})}}catch(r){throw t({error:r.message}),r}finally{t({loading:!1})}},signOut:async()=>{t({loading:!0});try{const{error:n}=await be.auth.signOut();if(n)throw n;t({user:null,profile:null,error:null})}catch(n){t({error:n.message})}finally{t({loading:!1})}},updateProfile:async n=>{t({loading:!0,error:null});try{const{user:s}=e();if(!s)throw new Error("No user logged in");const i={};n.username&&(i.username=n.username),n.allowMessages!==void 0&&(i.allow_messages=n.allowMessages),n.profilePicture&&(i.avatar_url=n.profilePicture);const{error:r}=await be.from("profiles").update(i).eq("id",s.uid);if(r)throw r;t(o=>({user:o.user?{...o.user,username:n.username||o.user.username,allowMessages:n.allowMessages!==void 0?n.allowMessages:o.user.allowMessages,photoURL:n.profilePicture||o.user.photoURL}:null}))}catch(s){throw t({error:s.message}),s}finally{t({loading:!1})}},getUserProfile:async n=>{try{const{data:s,error:i}=await be.from("profiles").select("*").eq("id",n).single();if(i)throw i;return s}catch(s){return console.error("Error fetching user profile:",s),null}},listFriendRequests:async n=>{try{const{data:s,error:i}=await be.from("friendships").select(`
          id,
          user_id,
          friend_id,
          status,
          created_at,
          profiles!friendships_user_id_fkey(username, avatar_url)
        `).eq("friend_id",n).eq("status","pending");if(i)throw i;return s||[]}catch(s){return console.error("Error fetching friend requests:",s),[]}},sendFriendRequest:async(n,s)=>{try{const{error:i}=await be.from("friendships").insert({user_id:n,friend_id:s,status:"pending"});if(i)throw i}catch(i){throw console.error("Error sending friend request:",i),i}},acceptFriendRequest:async n=>{try{const{error:s}=await be.from("friendships").update({status:"accepted"}).eq("id",n);if(s)throw s}catch(s){throw console.error("Error accepting friend request:",s),s}},storeGameResult:async(n,s,i,r,o=!1)=>{try{const{error:a}=await be.from("game_results").insert({player1_id:n,player2_id:s,game_type:i,winner_id:r,is_draw:o});if(a)throw a}catch(a){throw console.error("Error storing game result:",a),a}}}));be.auth.onAuthStateChange(async(t,e)=>{var s;const{getUserProfile:n}=yn.getState();if(t==="SIGNED_IN"&&(e!=null&&e.user)){const i=await n(e.user.id);yn.setState({user:{uid:e.user.id,email:e.user.email??null,displayName:(i==null?void 0:i.username)||((s=e.user.email)==null?void 0:s.split("@")[0])||null,photoURL:(i==null?void 0:i.avatar_url)||null,username:i==null?void 0:i.username,allowMessages:i==null?void 0:i.allow_messages},profile:i})}else t==="SIGNED_OUT"&&yn.setState({user:null,profile:null})});const Vc=({onGameEnd:t,isHost:e,sendGameState:n})=>{const[s,i]=y.useState(Array(9).fill(null)),[r,o]=y.useState(!0),[a,l]=y.useState(!1),c=e&&r||!e&&!r;y.useEffect(()=>{const m=_=>{const v=_.detail;v.type==="tictactoe"&&(i(v.board),o(v.isXNext))};return window.addEventListener("game_state",m),()=>{window.removeEventListener("game_state",m)}},[]);const u=m=>{if(!c||s[m]||Br(s)||a)return;const _=[...s];_[m]=e?"X":"O",i(_),o(!r),n({type:"tictactoe",board:_,isXNext:!r});const v=Br(_);(v||_.every(b=>b))&&(l(!0),setTimeout(()=>t(v),1500))},h=m=>{const _=s[m];return g.jsxs("button",{className:`w-24 h-24 bg-white bg-opacity-10 rounded-lg flex items-center justify-center transition
          ${c&&!_?"hover:bg-opacity-20":""}
          ${_==="X"?"text-pink-500":"text-violet-500"}
          ${!c||a?"cursor-not-allowed":"cursor-pointer"}`,onClick:()=>u(m),disabled:!c||a,children:[_==="X"&&g.jsx(Nm,{size:40}),_==="O"&&g.jsx(Dm,{size:40})]},m)},d=Br(s),f=!d&&s.every(m=>m),p=d?`Winner: ${d==="X"?"Player 1":"Player 2"}`:f?"It's a draw!":c?"Your turn":"Opponent's turn";return g.jsxs("div",{className:"flex flex-col items-center",children:[g.jsx("h3",{className:`text-xl font-bold mb-4 ${d?"text-green-500":f?"text-yellow-500":"text-white"}`,children:p}),g.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:Array(9).fill(null).map((m,_)=>h(_))}),g.jsx("div",{className:"mt-4 text-sm text-gray-400",children:e?"You are Player 1 (X)":"You are Player 2 (O)"})]})};function Br(t){const e=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const[n,s,i]of e)if(t[n]&&t[n]===t[s]&&t[n]===t[i])return t[n];return null}const ei=10,qn=[5,4,3,3,2],Uc=({onGameEnd:t,isHost:e,sendGameState:n})=>{const[s,i]=y.useState(v()),[r,o]=y.useState(v()),[a,l]=y.useState(!0),[c,u]=y.useState(0),[h,d]=y.useState(!1),[f,p]=y.useState(e),[m,_]=y.useState(!1);y.useEffect(()=>{const S=T=>{const A=T.detail;A.type==="battleships"&&(A.action==="shot"?E(A.position):A.action==="result"&&k(A.position,A.hit))};return window.addEventListener("game_state",S),()=>window.removeEventListener("game_state",S)},[]);function v(){return Array(ei).fill(null).map(()=>Array(ei).fill("empty"))}function b(S,T,A,I,N){if(N){if(T+I>ei)return!1;for(let W=0;W<I;W++)if(S[T+W][A]!=="empty")return!1}else{if(A+I>ei)return!1;for(let W=0;W<I;W++)if(S[T][A+W]!=="empty")return!1}return!0}function w(S,T){if(c>=qn.length)return;const A=qn[c];if(!b(s,S,T,A,h))return;const I=s.map(N=>[...N]);if(h)for(let N=0;N<A;N++)I[S+N][T]="ship";else for(let N=0;N<A;N++)I[S][T+N]="ship";i(I),u(c+1),c===qn.length-1&&(l(!1),n({type:"battleships",action:"ready"}))}function x(S,T,A){if(!m){if(a&&!A)w(S,T);else if(!a&&A&&f){if(r[S][T]==="hit"||r[S][T]==="miss")return;n({type:"battleships",action:"shot",position:{row:S,col:T}}),p(!1)}}}function E(S){const T=s[S.row][S.col]==="ship",A=s.map(I=>[...I]);A[S.row][S.col]=T?"hit":"miss",i(A),n({type:"battleships",action:"result",position:S,hit:T}),M(A)&&(_(!0),t("opponent"))}function k(S,T){const A=r.map(I=>[...I]);A[S.row][S.col]=T?"hit":"miss",o(A),p(!0),M(A)&&(_(!0),t("you"))}function M(S){return!S.some(T=>T.some(A=>A==="ship"))}function D(S,T){return g.jsx("div",{className:"grid grid-cols-10 gap-1 bg-slate-800 p-4 rounded-lg",children:S.map((A,I)=>A.map((N,W)=>g.jsx("button",{onClick:()=>x(I,W,T),disabled:a?T:!f||m,className:`
                w-10 h-10 rounded-md flex items-center justify-center transition
                ${P(N,T)}
                ${T&&!m?"hover:bg-opacity-50":""}
              `,children:R(N,T)},`${I}-${W}`)))})}function P(S,T){return S==="empty"?"bg-slate-700":S==="ship"&&!T?"bg-blue-500":S==="hit"?"bg-red-500":S==="miss"?"bg-slate-600":"bg-slate-700"}function R(S,T){return S==="ship"&&!T?g.jsx(Om,{className:"w-6 h-6 text-white"}):S==="hit"?g.jsx(jm,{className:"w-6 h-6 text-white"}):S==="miss"?g.jsx(Mm,{className:"w-6 h-6 text-gray-400"}):null}return g.jsxs("div",{className:"flex flex-col items-center gap-8",children:[g.jsxs("div",{className:"text-center",children:[g.jsx("h2",{className:"text-2xl font-bold mb-2",children:m?"Game Over!":a?"Place Your Ships":f?"Your Turn":"Opponent's Turn"}),a&&c<qn.length&&g.jsxs("div",{className:"flex flex-col items-center gap-2",children:[g.jsxs("p",{children:["Placing ship of length ",qn[c]]}),g.jsx("button",{onClick:()=>d(!h),className:"px-4 py-2 bg-blue-500 rounded-lg hover:bg-blue-600 transition",children:h?"Vertical":"Horizontal"})]})]}),g.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-bold mb-4 text-center",children:"Your Board"}),D(s,!1)]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-bold mb-4 text-center",children:"Opponent's Board"}),D(r,!0)]})]})]})},Wc=({onGameEnd:t,isHost:e,sendGameState:n})=>{const[s,i]=y.useState(_()),[r,o]=y.useState(!0),[a,l]=y.useState([]),[c,u]=y.useState(!1),[h,d]=y.useState(null),[f,p]=y.useState(null),m=e===r;y.useEffect(()=>{const P=R=>{const S=R.detail;S.type==="checkers"&&(i(S.data.board),o(S.data.isRedTurn),S.data.winner&&(d(S.data.winner),setTimeout(()=>t(S.data.winner),1500)))};return window.addEventListener("game_state",P),()=>{window.removeEventListener("game_state",P)}},[t]),y.useEffect(()=>{const P=w(s,r);u(P.length>0)},[s,r]);function _(){const P=Array(8).fill(null).map(()=>Array(8).fill(null));for(let R=0;R<3;R++)for(let S=0;S<8;S++)(R+S)%2===1&&(P[R][S]={isKing:!1,isRed:!0});for(let R=5;R<8;R++)for(let S=0;S<8;S++)(R+S)%2===1&&(P[R][S]={isKing:!1,isRed:!1});return P}function v(P,R){const S=s[P][R];if(!S)return[];const T=b(s,P,R);if(c)return T;const A=[...T];return(S.isKing?[-1,1]:[S.isRed?1:-1]).forEach(N=>{[-1,1].forEach(W=>{const L=P+N,H=R+W;L>=0&&L<8&&H>=0&&H<8&&!s[L][H]&&A.push({row:L,col:H})})}),A}function b(P,R,S){const T=P[R][S];if(!T)return[];const A=[];return(T.isKing?[-1,1]:[T.isRed?1:-1]).forEach(N=>{[-1,1].forEach(W=>{const L=R+N*2,H=S+W*2,ye=R+N,Te=S+W;L>=0&&L<8&&H>=0&&H<8&&!P[L][H]&&P[ye][Te]&&P[ye][Te].isRed!==T.isRed&&A.push({row:L,col:H})})}),A}function w(P,R){const S=[];for(let T=0;T<8;T++)for(let A=0;A<8;A++){const I=P[T][A];if(I&&I.isRed===R){const N=b(P,T,A);S.push(...N)}}return S}function x(P){let R=!1,S=!1;for(let T=0;T<8;T++)for(let A=0;A<8;A++){const I=P[T][A];if(I&&(I.isRed?R=!0:S=!0,R&&S))return null}return R?"red":"black"}const E=(P,R,S)=>{if(!m||h||!s[P][R])return;const T=s[P][R];if(T&&T.isRed===r){p({row:P,col:R});const A=v(P,R);l(A);const I=document.createElement("div");I.className=`w-12 h-12 rounded-full ${T.isRed?"bg-red-600":"bg-white"}`,document.body.appendChild(I),S.dataTransfer.setDragImage(I,30,30),setTimeout(()=>document.body.removeChild(I),0)}},k=P=>{P.preventDefault()},M=(P,R)=>{if(!f||!m||h)return;if(a.some(T=>T.row===P&&T.col===R)){const T=s.map(I=>[...I]);if(T[P][R]=T[f.row][f.col],T[f.row][f.col]=null,Math.abs(P-f.row)===2){const I=f.row+Math.sign(P-f.row),N=f.col+Math.sign(R-f.col);T[I][N]=null}T[P][R]&&(P===0||P===7)&&(T[P][R].isKing=!0);const A=x(T);A&&(d(A),setTimeout(()=>t(A),1500)),i(T),o(!r),l([]),p(null),n({type:"checkers",data:{board:T,isRedTurn:!r,winner:A}})}},D=()=>{l([]),p(null)};return g.jsxs("div",{className:"flex flex-col items-center",children:[g.jsx("div",{className:`mb-4 text-xl font-bold ${h?"text-green-500":""}`,children:h?`${h==="red"?"Red":"White"} Wins!`:m?"Your Turn":"Opponent's Turn"}),g.jsx("div",{className:"grid grid-cols-8 gap-0 bg-amber-900 p-2 rounded-lg shadow-xl",children:s.map((P,R)=>P.map((S,T)=>{const A=a.some(I=>I.row===R&&I.col===T);return g.jsx("div",{className:`
                  w-16 h-16 flex items-center justify-center
                  ${(R+T)%2===0?"bg-amber-200":"bg-amber-800"}
                  ${A?"ring-2 ring-green-400":""}
                  transition-all duration-200
                `,onDragOver:k,onDrop:()=>M(R,T),children:S&&g.jsx("div",{draggable:m&&S.isRed===r,onDragStart:I=>E(R,T,I),onDragEnd:D,className:`
                      w-12 h-12 rounded-full flex items-center justify-center
                      ${S.isRed?"bg-red-600":"bg-white shadow-lg"}
                      ${S.isKing?"ring-2 ring-yellow-400":""}
                      ${m&&S.isRed===r?"cursor-grab active:cursor-grabbing":"cursor-default"}
                      transform transition-transform duration-200
                      hover:scale-105
                    `,children:S.isKing&&g.jsx(Lm,{className:`w-6 h-6 ${S.isRed?"text-yellow-400":"text-amber-400"}`})})},`${R}-${T}`)}))}),g.jsx("div",{className:"mt-4 text-sm text-gray-400",children:e?"You are Red":"You are White"})]})},He=20,Ux=20,Wx=150;function Hc({onGameEnd:t,sendGameState:e}){const[n,s]=y.useState([{x:10,y:10}]),[i,r]=y.useState({x:15,y:15}),[o,a]=y.useState("RIGHT"),[l,c]=y.useState(0),[u,h]=y.useState(!1),d=y.useCallback(()=>{const m={x:Math.floor(Math.random()*He),y:Math.floor(Math.random()*He)};r(m),e&&e({type:"food",position:m})},[e]),f=m=>m.x<0||m.x>=He||m.y<0||m.y>=He?!0:n.slice(1).some(_=>_.x===m.x&&_.y===m.y),p=y.useCallback(()=>{u||s(m=>{const _={...m[0]};switch(o){case"UP":_.y-=1;break;case"DOWN":_.y+=1;break;case"LEFT":_.x-=1;break;case"RIGHT":_.x+=1;break}if(f(_))return h(!0),t==null||t(l.toString()),m;const v=[_,...m];return _.x===i.x&&_.y===i.y?(c(b=>b+1),d()):v.pop(),e&&e({type:"snake",positions:v}),v})},[o,i,u,d,t,l,e]);return y.useEffect(()=>{const m=_=>{switch(_.key){case"ArrowUp":a("UP");break;case"ArrowDown":a("DOWN");break;case"ArrowLeft":a("LEFT");break;case"ArrowRight":a("RIGHT");break}};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[]),y.useEffect(()=>{const m=setInterval(p,Wx);return()=>clearInterval(m)},[p]),g.jsxs("div",{className:"flex flex-col items-center gap-4",children:[g.jsxs("div",{className:"text-xl font-bold text-white",children:["Score: ",l]}),g.jsx("div",{className:"grid bg-black/20 backdrop-blur-sm rounded-lg p-4",style:{gridTemplateColumns:`repeat(${He}, ${Ux}px)`,gap:"1px"},children:Array.from({length:He*He}).map((m,_)=>{const v=_%He,b=Math.floor(_/He),w=n.some(E=>E.x===v&&E.y===b),x=i.x===v&&i.y===b;return g.jsx("div",{className:`w-5 h-5 rounded-sm ${w?"bg-green-500":x?"bg-red-500":"bg-white/5"}`},_)})}),u&&g.jsx("div",{className:"text-red-500 text-xl font-bold",children:"Game Over!"})]})}const Zt=800,en=400,zn=10,tn=100,Kn=10,Gc=5;function qc({onGameEnd:t,isHost:e,sendGameState:n}){const s=y.useRef(null),[i,r]=y.useState(Zt/2),[o,a]=y.useState(Zt/2),[l,c]=y.useState({x:Zt/2,y:en/2}),[u,h]=y.useState({x:Gc,y:Gc}),[d,f]=y.useState(0);return y.useEffect(()=>{const p=s.current;if(!p)return;const m=p.getContext("2d");if(!m)return;const _=setInterval(()=>{m.clearRect(0,0,Zt,en),m.fillStyle="#fff",m.fillRect(i-tn/2,0,tn,zn),m.fillRect(o-tn/2,en-zn,tn,zn),m.beginPath(),m.arc(l.x,l.y,Kn,0,Math.PI*2),m.fill(),c(b=>({x:b.x+u.x,y:b.y+u.y})),(l.x<=Kn||l.x>=Zt-Kn)&&h(b=>({...b,x:-b.x})),(l.y<=zn+Kn&&Math.abs(l.x-i)<tn/2||l.y>=en-zn-Kn&&Math.abs(l.x-o)<tn/2)&&(h(b=>({...b,y:-b.y})),f(b=>b+1)),(l.y<=0||l.y>=en)&&(clearInterval(_),t==null||t("Score: "+d))},1e3/60),v=b=>{const w=p.getBoundingClientRect(),x=b.clientX-w.left;e?(r(x),n==null||n({type:"PADDLE1_MOVE",position:x})):(a(x),n==null||n({type:"PADDLE2_MOVE",position:x}))};return p.addEventListener("mousemove",v),()=>{clearInterval(_),p.removeEventListener("mousemove",v)}},[l,u,i,o,d]),g.jsxs("div",{className:"flex flex-col items-center",children:[g.jsx("div",{className:"mb-4",children:g.jsxs("span",{className:"text-xl font-bold",children:["Score: ",d]})}),g.jsx("canvas",{ref:s,width:Zt,height:en,className:"border border-gray-700 rounded-lg"}),g.jsx("div",{className:"mt-4 text-sm text-gray-400",children:"Move your mouse to control your paddle"})]})}const Af=y.createContext({});function Hx(t){const e=y.useRef(null);return e.current===null&&(e.current=t()),e.current}const Ba=y.createContext(null),Nf=y.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function Gx(t=!0){const e=y.useContext(Ba);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:s,register:i}=e,r=y.useId();y.useEffect(()=>{t&&i(r)},[t]);const o=y.useCallback(()=>t&&s&&s(r),[r,s,t]);return!n&&s?[!1,o]:[!0]}const Va=typeof window<"u",qx=Va?y.useLayoutEffect:y.useEffect,Ee=t=>t;let Df=Ee;function Ua(t){let e;return()=>(e===void 0&&(e=t()),e)}const Pn=(t,e,n)=>{const s=e-t;return s===0?1:(n-t)/s},Je=t=>t*1e3,Qe=t=>t/1e3,zx={useManualTiming:!1};function Kx(t){let e=new Set,n=new Set,s=!1,i=!1;const r=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(c){r.has(c)&&(l.schedule(c),t()),c(o)}const l={schedule:(c,u=!1,h=!1)=>{const f=h&&s?e:n;return u&&r.add(c),f.has(c)||f.add(c),c},cancel:c=>{n.delete(c),r.delete(c)},process:c=>{if(o=c,s){i=!0;return}s=!0,[e,n]=[n,e],e.forEach(a),e.clear(),s=!1,i&&(i=!1,l.process(c))}};return l}const ti=["read","resolveKeyframes","update","preRender","render","postRender"],Yx=40;function Of(t,e){let n=!1,s=!0;const i={delta:0,timestamp:0,isProcessing:!1},r=()=>n=!0,o=ti.reduce((v,b)=>(v[b]=Kx(r),v),{}),{read:a,resolveKeyframes:l,update:c,preRender:u,render:h,postRender:d}=o,f=()=>{const v=performance.now();n=!1,i.delta=s?1e3/60:Math.max(Math.min(v-i.timestamp,Yx),1),i.timestamp=v,i.isProcessing=!0,a.process(i),l.process(i),c.process(i),u.process(i),h.process(i),d.process(i),i.isProcessing=!1,n&&e&&(s=!1,t(f))},p=()=>{n=!0,s=!0,i.isProcessing||t(f)};return{schedule:ti.reduce((v,b)=>{const w=o[b];return v[b]=(x,E=!1,k=!1)=>(n||p(),w.schedule(x,E,k)),v},{}),cancel:v=>{for(let b=0;b<ti.length;b++)o[ti[b]].cancel(v)},state:i,steps:o}}const{schedule:Q,cancel:wt,state:fe,steps:Vr}=Of(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ee,!0),jf=y.createContext({strict:!1}),zc={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},kn={};for(const t in zc)kn[t]={isEnabled:e=>zc[t].some(n=>!!e[n])};function Jx(t){for(const e in t)kn[e]={...kn[e],...t[e]}}const Qx=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Di(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||Qx.has(t)}let Mf=t=>!Di(t);function Xx(t){t&&(Mf=e=>e.startsWith("on")?!Di(e):t(e))}try{Xx(require("@emotion/is-prop-valid").default)}catch{}function Zx(t,e,n){const s={};for(const i in t)i==="values"&&typeof t.values=="object"||(Mf(i)||n===!0&&Di(i)||!e&&!Di(i)||t.draggable&&i.startsWith("onDrag"))&&(s[i]=t[i]);return s}function eS(t){if(typeof Proxy>"u")return t;const e=new Map,n=(...s)=>t(...s);return new Proxy(n,{get:(s,i)=>i==="create"?t:(e.has(i)||e.set(i,t(i)),e.get(i))})}const ur=y.createContext({});function Ts(t){return typeof t=="string"||Array.isArray(t)}function hr(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const Wa=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Ha=["initial",...Wa];function dr(t){return hr(t.animate)||Ha.some(e=>Ts(t[e]))}function Lf(t){return!!(dr(t)||t.variants)}function tS(t,e){if(dr(t)){const{initial:n,animate:s}=t;return{initial:n===!1||Ts(n)?n:void 0,animate:Ts(s)?s:void 0}}return t.inherit!==!1?e:{}}function nS(t){const{initial:e,animate:n}=tS(t,y.useContext(ur));return y.useMemo(()=>({initial:e,animate:n}),[Kc(e),Kc(n)])}function Kc(t){return Array.isArray(t)?t.join(" "):t}const sS=Symbol.for("motionComponentSymbol");function cn(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function iS(t,e,n){return y.useCallback(s=>{s&&t.onMount&&t.onMount(s),e&&(s?e.mount(s):e.unmount()),n&&(typeof n=="function"?n(s):cn(n)&&(n.current=s))},[e])}const Ga=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),rS="framerAppearId",Ff="data-"+Ga(rS),{schedule:qa}=Of(queueMicrotask,!1),$f=y.createContext({});function oS(t,e,n,s,i){var r,o;const{visualElement:a}=y.useContext(ur),l=y.useContext(jf),c=y.useContext(Ba),u=y.useContext(Nf).reducedMotion,h=y.useRef(null);s=s||l.renderer,!h.current&&s&&(h.current=s(t,{visualState:e,parent:a,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const d=h.current,f=y.useContext($f);d&&!d.projection&&i&&(d.type==="html"||d.type==="svg")&&aS(h.current,n,i,f);const p=y.useRef(!1);y.useInsertionEffect(()=>{d&&p.current&&d.update(n,c)});const m=n[Ff],_=y.useRef(!!m&&!(!((r=window.MotionHandoffIsComplete)===null||r===void 0)&&r.call(window,m))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,m)));return qx(()=>{d&&(p.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),qa.render(d.render),_.current&&d.animationState&&d.animationState.animateChanges())}),y.useEffect(()=>{d&&(!_.current&&d.animationState&&d.animationState.animateChanges(),_.current&&(queueMicrotask(()=>{var v;(v=window.MotionHandoffMarkAsComplete)===null||v===void 0||v.call(window,m)}),_.current=!1))}),d}function aS(t,e,n,s){const{layoutId:i,layout:r,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:Bf(t.parent)),t.projection.setOptions({layoutId:i,layout:r,alwaysMeasureLayout:!!o||a&&cn(a),visualElement:t,animationType:typeof r=="string"?r:"both",initialPromotionConfig:s,layoutScroll:l,layoutRoot:c})}function Bf(t){if(t)return t.options.allowProjection!==!1?t.projection:Bf(t.parent)}function lS({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:s,Component:i}){var r,o;t&&Jx(t);function a(c,u){let h;const d={...y.useContext(Nf),...c,layoutId:cS(c)},{isStatic:f}=d,p=nS(c),m=s(c,f);if(!f&&Va){uS();const _=hS(d);h=_.MeasureLayout,p.visualElement=oS(i,m,d,e,_.ProjectionNode)}return g.jsxs(ur.Provider,{value:p,children:[h&&p.visualElement?g.jsx(h,{visualElement:p.visualElement,...d}):null,n(i,c,iS(m,p.visualElement,u),m,f,p.visualElement)]})}a.displayName=`motion.${typeof i=="string"?i:`create(${(o=(r=i.displayName)!==null&&r!==void 0?r:i.name)!==null&&o!==void 0?o:""})`}`;const l=y.forwardRef(a);return l[sS]=i,l}function cS({layoutId:t}){const e=y.useContext(Af).id;return e&&t!==void 0?e+"-"+t:t}function uS(t,e){y.useContext(jf).strict}function hS(t){const{drag:e,layout:n}=kn;if(!e&&!n)return{};const s={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}const dS=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function za(t){return typeof t!="string"||t.includes("-")?!1:!!(dS.indexOf(t)>-1||/[A-Z]/u.test(t))}function Yc(t){const e=[{},{}];return t==null||t.values.forEach((n,s)=>{e[0][s]=n.get(),e[1][s]=n.getVelocity()}),e}function Ka(t,e,n,s){if(typeof e=="function"){const[i,r]=Yc(s);e=e(n!==void 0?n:t.custom,i,r)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,r]=Yc(s);e=e(n!==void 0?n:t.custom,i,r)}return e}const Oo=t=>Array.isArray(t),fS=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),pS=t=>Oo(t)?t[t.length-1]||0:t,ge=t=>!!(t&&t.getVelocity);function ai(t){const e=ge(t)?t.get():t;return fS(e)?e.toValue():e}function mS({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:n},s,i,r){const o={latestValues:gS(s,i,r,t),renderState:e()};return n&&(o.onMount=a=>n({props:s,current:a,...o}),o.onUpdate=a=>n(a)),o}const Vf=t=>(e,n)=>{const s=y.useContext(ur),i=y.useContext(Ba),r=()=>mS(t,e,s,i);return n?r():Hx(r)};function gS(t,e,n,s){const i={},r=s(t,{});for(const d in r)i[d]=ai(r[d]);let{initial:o,animate:a}=t;const l=dr(t),c=Lf(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let u=n?n.initial===!1:!1;u=u||o===!1;const h=u?a:o;if(h&&typeof h!="boolean"&&!hr(h)){const d=Array.isArray(h)?h:[h];for(let f=0;f<d.length;f++){const p=Ka(t,d[f]);if(p){const{transitionEnd:m,transition:_,...v}=p;for(const b in v){let w=v[b];if(Array.isArray(w)){const x=u?w.length-1:0;w=w[x]}w!==null&&(i[b]=w)}for(const b in m)i[b]=m[b]}}}return i}const Ln=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Gt=new Set(Ln),Uf=t=>e=>typeof e=="string"&&e.startsWith(t),Wf=Uf("--"),yS=Uf("var(--"),Ya=t=>yS(t)?_S.test(t.split("/*")[0].trim()):!1,_S=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Hf=(t,e)=>e&&typeof t=="number"?e.transform(t):t,tt=(t,e,n)=>n>e?e:n<t?t:n,Fn={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Ps={...Fn,transform:t=>tt(0,1,t)},ni={...Fn,default:1},Us=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),lt=Us("deg"),$e=Us("%"),O=Us("px"),vS=Us("vh"),wS=Us("vw"),Jc={...$e,parse:t=>$e.parse(t)/100,transform:t=>$e.transform(t*100)},bS={borderWidth:O,borderTopWidth:O,borderRightWidth:O,borderBottomWidth:O,borderLeftWidth:O,borderRadius:O,radius:O,borderTopLeftRadius:O,borderTopRightRadius:O,borderBottomRightRadius:O,borderBottomLeftRadius:O,width:O,maxWidth:O,height:O,maxHeight:O,top:O,right:O,bottom:O,left:O,padding:O,paddingTop:O,paddingRight:O,paddingBottom:O,paddingLeft:O,margin:O,marginTop:O,marginRight:O,marginBottom:O,marginLeft:O,backgroundPositionX:O,backgroundPositionY:O},xS={rotate:lt,rotateX:lt,rotateY:lt,rotateZ:lt,scale:ni,scaleX:ni,scaleY:ni,scaleZ:ni,skew:lt,skewX:lt,skewY:lt,distance:O,translateX:O,translateY:O,translateZ:O,x:O,y:O,z:O,perspective:O,transformPerspective:O,opacity:Ps,originX:Jc,originY:Jc,originZ:O},Qc={...Fn,transform:Math.round},Ja={...bS,...xS,zIndex:Qc,size:O,fillOpacity:Ps,strokeOpacity:Ps,numOctaves:Qc},SS={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},ES=Ln.length;function CS(t,e,n){let s="",i=!0;for(let r=0;r<ES;r++){const o=Ln[r],a=t[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){const c=Hf(a,Ja[o]);if(!l){i=!1;const u=SS[o]||o;s+=`${u}(${c}) `}n&&(e[o]=c)}}return s=s.trim(),n?s=n(e,i?"":s):i&&(s="none"),s}function Qa(t,e,n){const{style:s,vars:i,transformOrigin:r}=t;let o=!1,a=!1;for(const l in e){const c=e[l];if(Gt.has(l)){o=!0;continue}else if(Wf(l)){i[l]=c;continue}else{const u=Hf(c,Ja[l]);l.startsWith("origin")?(a=!0,r[l]=u):s[l]=u}}if(e.transform||(o||n?s.transform=CS(e,t.transform,n):s.transform&&(s.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:u=0}=r;s.transformOrigin=`${l} ${c} ${u}`}}const TS={offset:"stroke-dashoffset",array:"stroke-dasharray"},PS={offset:"strokeDashoffset",array:"strokeDasharray"};function kS(t,e,n=1,s=0,i=!0){t.pathLength=1;const r=i?TS:PS;t[r.offset]=O.transform(-s);const o=O.transform(e),a=O.transform(n);t[r.array]=`${o} ${a}`}function Xc(t,e,n){return typeof t=="string"?t:O.transform(e+n*t)}function RS(t,e,n){const s=Xc(e,t.x,t.width),i=Xc(n,t.y,t.height);return`${s} ${i}`}function Xa(t,{attrX:e,attrY:n,attrScale:s,originX:i,originY:r,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},u,h){if(Qa(t,c,h),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:d,style:f,dimensions:p}=t;d.transform&&(p&&(f.transform=d.transform),delete d.transform),p&&(i!==void 0||r!==void 0||f.transform)&&(f.transformOrigin=RS(p,i!==void 0?i:.5,r!==void 0?r:.5)),e!==void 0&&(d.x=e),n!==void 0&&(d.y=n),s!==void 0&&(d.scale=s),o!==void 0&&kS(d,o,a,l,!1)}const Za=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),Gf=()=>({...Za(),attrs:{}}),el=t=>typeof t=="string"&&t.toLowerCase()==="svg";function qf(t,{style:e,vars:n},s,i){Object.assign(t.style,e,i&&i.getProjectionStyles(s));for(const r in n)t.style.setProperty(r,n[r])}const zf=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Kf(t,e,n,s){qf(t,e,void 0,s);for(const i in e.attrs)t.setAttribute(zf.has(i)?i:Ga(i),e.attrs[i])}const Oi={};function IS(t){Object.assign(Oi,t)}function Yf(t,{layout:e,layoutId:n}){return Gt.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Oi[t]||t==="opacity")}function tl(t,e,n){var s;const{style:i}=t,r={};for(const o in i)(ge(i[o])||e.style&&ge(e.style[o])||Yf(o,t)||((s=n==null?void 0:n.getValue(o))===null||s===void 0?void 0:s.liveStyle)!==void 0)&&(r[o]=i[o]);return r}function Jf(t,e,n){const s=tl(t,e,n);for(const i in t)if(ge(t[i])||ge(e[i])){const r=Ln.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;s[r]=t[i]}return s}function AS(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const Zc=["x","y","width","height","cx","cy","r"],NS={useVisualState:Vf({scrapeMotionValuesFromProps:Jf,createRenderState:Gf,onUpdate:({props:t,prevProps:e,current:n,renderState:s,latestValues:i})=>{if(!n)return;let r=!!t.drag;if(!r){for(const a in i)if(Gt.has(a)){r=!0;break}}if(!r)return;let o=!e;if(e)for(let a=0;a<Zc.length;a++){const l=Zc[a];t[l]!==e[l]&&(o=!0)}o&&Q.read(()=>{AS(n,s),Q.render(()=>{Xa(s,i,el(n.tagName),t.transformTemplate),Kf(n,s)})})}})},DS={useVisualState:Vf({scrapeMotionValuesFromProps:tl,createRenderState:Za})};function Qf(t,e,n){for(const s in e)!ge(e[s])&&!Yf(s,n)&&(t[s]=e[s])}function OS({transformTemplate:t},e){return y.useMemo(()=>{const n=Za();return Qa(n,e,t),Object.assign({},n.vars,n.style)},[e])}function jS(t,e){const n=t.style||{},s={};return Qf(s,n,t),Object.assign(s,OS(t,e)),s}function MS(t,e){const n={},s=jS(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=s,n}function LS(t,e,n,s){const i=y.useMemo(()=>{const r=Gf();return Xa(r,e,el(s),t.transformTemplate),{...r.attrs,style:{...r.style}}},[e]);if(t.style){const r={};Qf(r,t.style,t),i.style={...r,...i.style}}return i}function FS(t=!1){return(n,s,i,{latestValues:r},o)=>{const l=(za(n)?LS:MS)(s,r,o,n),c=Zx(s,typeof n=="string",t),u=n!==y.Fragment?{...c,...l,ref:i}:{},{children:h}=s,d=y.useMemo(()=>ge(h)?h.get():h,[h]);return y.createElement(n,{...u,children:d})}}function $S(t,e){return function(s,{forwardMotionProps:i}={forwardMotionProps:!1}){const o={...za(s)?NS:DS,preloadedFeatures:t,useRender:FS(i),createVisualElement:e,Component:s};return lS(o)}}function Xf(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}function fr(t,e,n){const s=t.getProps();return Ka(s,e,n!==void 0?n:s.custom,t)}const BS=Ua(()=>window.ScrollTimeline!==void 0);class VS{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,n){for(let s=0;s<this.animations.length;s++)this.animations[s][e]=n}attachTimeline(e,n){const s=this.animations.map(i=>{if(BS()&&i.attachTimeline)return i.attachTimeline(e);if(typeof n=="function")return n(i)});return()=>{s.forEach((i,r)=>{i&&i(),this.animations[r].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class US extends VS{then(e,n){return Promise.all(this.animations).then(e).catch(n)}}function nl(t,e){return t?t[e]||t.default||t:void 0}const jo=2e4;function Zf(t){let e=0;const n=50;let s=t.next(e);for(;!s.done&&e<jo;)e+=n,s=t.next(e);return e>=jo?1/0:e}function sl(t){return typeof t=="function"}function eu(t,e){t.timeline=e,t.onfinish=null}const il=t=>Array.isArray(t)&&typeof t[0]=="number",WS={linearEasing:void 0};function HS(t,e){const n=Ua(t);return()=>{var s;return(s=WS[e])!==null&&s!==void 0?s:n()}}const ji=HS(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),ep=(t,e,n=10)=>{let s="";const i=Math.max(Math.round(e/n),2);for(let r=0;r<i;r++)s+=t(Pn(0,i-1,r))+", ";return`linear(${s.substring(0,s.length-2)})`};function tp(t){return!!(typeof t=="function"&&ji()||!t||typeof t=="string"&&(t in Mo||ji())||il(t)||Array.isArray(t)&&t.every(tp))}const Zn=([t,e,n,s])=>`cubic-bezier(${t}, ${e}, ${n}, ${s})`,Mo={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Zn([0,.65,.55,1]),circOut:Zn([.55,0,1,.45]),backIn:Zn([.31,.01,.66,-.59]),backOut:Zn([.33,1.53,.69,.99])};function np(t,e){if(t)return typeof t=="function"&&ji()?ep(t,e):il(t)?Zn(t):Array.isArray(t)?t.map(n=>np(n,e)||Mo.easeOut):Mo[t]}const De={x:!1,y:!1};function sp(){return De.x||De.y}function GS(t,e,n){var s;if(t instanceof Element)return[t];if(typeof t=="string"){let i=document;const r=(s=void 0)!==null&&s!==void 0?s:i.querySelectorAll(t);return r?Array.from(r):[]}return Array.from(t)}function ip(t,e){const n=GS(t),s=new AbortController,i={passive:!0,...e,signal:s.signal};return[n,i,()=>s.abort()]}function tu(t){return e=>{e.pointerType==="touch"||sp()||t(e)}}function qS(t,e,n={}){const[s,i,r]=ip(t,n),o=tu(a=>{const{target:l}=a,c=e(a);if(typeof c!="function"||!l)return;const u=tu(h=>{c(h),l.removeEventListener("pointerleave",u)});l.addEventListener("pointerleave",u,i)});return s.forEach(a=>{a.addEventListener("pointerenter",o,i)}),r}const rp=(t,e)=>e?t===e?!0:rp(t,e.parentElement):!1,rl=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,zS=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function KS(t){return zS.has(t.tagName)||t.tabIndex!==-1}const es=new WeakSet;function nu(t){return e=>{e.key==="Enter"&&t(e)}}function Ur(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const YS=(t,e)=>{const n=t.currentTarget;if(!n)return;const s=nu(()=>{if(es.has(n))return;Ur(n,"down");const i=nu(()=>{Ur(n,"up")}),r=()=>Ur(n,"cancel");n.addEventListener("keyup",i,e),n.addEventListener("blur",r,e)});n.addEventListener("keydown",s,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",s),e)};function su(t){return rl(t)&&!sp()}function JS(t,e,n={}){const[s,i,r]=ip(t,n),o=a=>{const l=a.currentTarget;if(!su(a)||es.has(l))return;es.add(l);const c=e(a),u=(f,p)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",d),!(!su(f)||!es.has(l))&&(es.delete(l),typeof c=="function"&&c(f,{success:p}))},h=f=>{u(f,n.useGlobalTarget||rp(l,f.target))},d=f=>{u(f,!1)};window.addEventListener("pointerup",h,i),window.addEventListener("pointercancel",d,i)};return s.forEach(a=>{!KS(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(n.useGlobalTarget?window:a).addEventListener("pointerdown",o,i),a.addEventListener("focus",c=>YS(c,i),i)}),r}function QS(t){return t==="x"||t==="y"?De[t]?null:(De[t]=!0,()=>{De[t]=!1}):De.x||De.y?null:(De.x=De.y=!0,()=>{De.x=De.y=!1})}const op=new Set(["width","height","top","left","right","bottom",...Ln]);let li;function XS(){li=void 0}const Be={now:()=>(li===void 0&&Be.set(fe.isProcessing||zx.useManualTiming?fe.timestamp:performance.now()),li),set:t=>{li=t,queueMicrotask(XS)}};function ol(t,e){t.indexOf(e)===-1&&t.push(e)}function al(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class ll{constructor(){this.subscriptions=[]}add(e){return ol(this.subscriptions,e),()=>al(this.subscriptions,e)}notify(e,n,s){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,n,s);else for(let r=0;r<i;r++){const o=this.subscriptions[r];o&&o(e,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function ap(t,e){return e?t*(1e3/e):0}const iu=30,ZS=t=>!isNaN(parseFloat(t));class eE{constructor(e,n={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,i=!0)=>{const r=Be.now();this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Be.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=ZS(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new ll);const s=this.events[e].add(n);return e==="change"?()=>{s(),Q.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,s){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Be.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>iu)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,iu);return ap(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ks(t,e){return new eE(t,e)}function tE(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,ks(n))}function nE(t,e){const n=fr(t,e);let{transitionEnd:s={},transition:i={},...r}=n||{};r={...r,...s};for(const o in r){const a=pS(r[o]);tE(t,o,a)}}function sE(t){return!!(ge(t)&&t.add)}function Lo(t,e){const n=t.getValue("willChange");if(sE(n))return n.add(e)}function lp(t){return t.props[Ff]}const cp=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,iE=1e-7,rE=12;function oE(t,e,n,s,i){let r,o,a=0;do o=e+(n-e)/2,r=cp(o,s,i)-t,r>0?n=o:e=o;while(Math.abs(r)>iE&&++a<rE);return o}function Ws(t,e,n,s){if(t===e&&n===s)return Ee;const i=r=>oE(r,0,1,t,n);return r=>r===0||r===1?r:cp(i(r),e,s)}const up=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,hp=t=>e=>1-t(1-e),dp=Ws(.33,1.53,.69,.99),cl=hp(dp),fp=up(cl),pp=t=>(t*=2)<1?.5*cl(t):.5*(2-Math.pow(2,-10*(t-1))),ul=t=>1-Math.sin(Math.acos(t)),mp=hp(ul),gp=up(ul),yp=t=>/^0[^.\s]+$/u.test(t);function aE(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||yp(t):!0}const cs=t=>Math.round(t*1e5)/1e5,hl=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function lE(t){return t==null}const cE=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,dl=(t,e)=>n=>!!(typeof n=="string"&&cE.test(n)&&n.startsWith(t)||e&&!lE(n)&&Object.prototype.hasOwnProperty.call(n,e)),_p=(t,e,n)=>s=>{if(typeof s!="string")return s;const[i,r,o,a]=s.match(hl);return{[t]:parseFloat(i),[e]:parseFloat(r),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},uE=t=>tt(0,255,t),Wr={...Fn,transform:t=>Math.round(uE(t))},Lt={test:dl("rgb","red"),parse:_p("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:s=1})=>"rgba("+Wr.transform(t)+", "+Wr.transform(e)+", "+Wr.transform(n)+", "+cs(Ps.transform(s))+")"};function hE(t){let e="",n="",s="",i="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),s=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),s=t.substring(3,4),i=t.substring(4,5),e+=e,n+=n,s+=s,i+=i),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:i?parseInt(i,16)/255:1}}const Fo={test:dl("#"),parse:hE,transform:Lt.transform},un={test:dl("hsl","hue"),parse:_p("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:s=1})=>"hsla("+Math.round(t)+", "+$e.transform(cs(e))+", "+$e.transform(cs(n))+", "+cs(Ps.transform(s))+")"},me={test:t=>Lt.test(t)||Fo.test(t)||un.test(t),parse:t=>Lt.test(t)?Lt.parse(t):un.test(t)?un.parse(t):Fo.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Lt.transform(t):un.transform(t)},dE=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function fE(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(hl))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(dE))===null||n===void 0?void 0:n.length)||0)>0}const vp="number",wp="color",pE="var",mE="var(",ru="${}",gE=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Rs(t){const e=t.toString(),n=[],s={color:[],number:[],var:[]},i=[];let r=0;const a=e.replace(gE,l=>(me.test(l)?(s.color.push(r),i.push(wp),n.push(me.parse(l))):l.startsWith(mE)?(s.var.push(r),i.push(pE),n.push(l)):(s.number.push(r),i.push(vp),n.push(parseFloat(l))),++r,ru)).split(ru);return{values:n,split:a,indexes:s,types:i}}function bp(t){return Rs(t).values}function xp(t){const{split:e,types:n}=Rs(t),s=e.length;return i=>{let r="";for(let o=0;o<s;o++)if(r+=e[o],i[o]!==void 0){const a=n[o];a===vp?r+=cs(i[o]):a===wp?r+=me.transform(i[o]):r+=i[o]}return r}}const yE=t=>typeof t=="number"?0:t;function _E(t){const e=bp(t);return xp(t)(e.map(yE))}const bt={test:fE,parse:bp,createTransformer:xp,getAnimatableNone:_E},vE=new Set(["brightness","contrast","saturate","opacity"]);function wE(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[s]=n.match(hl)||[];if(!s)return t;const i=n.replace(s,"");let r=vE.has(e)?1:0;return s!==n&&(r*=100),e+"("+r+i+")"}const bE=/\b([a-z-]*)\(.*?\)/gu,$o={...bt,getAnimatableNone:t=>{const e=t.match(bE);return e?e.map(wE).join(" "):t}},xE={...Ja,color:me,backgroundColor:me,outlineColor:me,fill:me,stroke:me,borderColor:me,borderTopColor:me,borderRightColor:me,borderBottomColor:me,borderLeftColor:me,filter:$o,WebkitFilter:$o},fl=t=>xE[t];function Sp(t,e){let n=fl(t);return n!==$o&&(n=bt),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const SE=new Set(["auto","none","0"]);function EE(t,e,n){let s=0,i;for(;s<t.length&&!i;){const r=t[s];typeof r=="string"&&!SE.has(r)&&Rs(r).values.length&&(i=t[s]),s++}if(i&&n)for(const r of e)t[r]=Sp(n,i)}const ou=t=>t===Fn||t===O,au=(t,e)=>parseFloat(t.split(", ")[e]),lu=(t,e)=>(n,{transform:s})=>{if(s==="none"||!s)return 0;const i=s.match(/^matrix3d\((.+)\)$/u);if(i)return au(i[1],e);{const r=s.match(/^matrix\((.+)\)$/u);return r?au(r[1],t):0}},CE=new Set(["x","y","z"]),TE=Ln.filter(t=>!CE.has(t));function PE(t){const e=[];return TE.forEach(n=>{const s=t.getValue(n);s!==void 0&&(e.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),e}const Rn={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:lu(4,13),y:lu(5,14)};Rn.translateX=Rn.x;Rn.translateY=Rn.y;const Ft=new Set;let Bo=!1,Vo=!1;function Ep(){if(Vo){const t=Array.from(Ft).filter(s=>s.needsMeasurement),e=new Set(t.map(s=>s.element)),n=new Map;e.forEach(s=>{const i=PE(s);i.length&&(n.set(s,i),s.render())}),t.forEach(s=>s.measureInitialState()),e.forEach(s=>{s.render();const i=n.get(s);i&&i.forEach(([r,o])=>{var a;(a=s.getValue(r))===null||a===void 0||a.set(o)})}),t.forEach(s=>s.measureEndState()),t.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}Vo=!1,Bo=!1,Ft.forEach(t=>t.complete()),Ft.clear()}function Cp(){Ft.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Vo=!0)})}function kE(){Cp(),Ep()}class pl{constructor(e,n,s,i,r,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=s,this.motionValue=i,this.element=r,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Ft.add(this),Bo||(Bo=!0,Q.read(Cp),Q.resolveKeyframes(Ep))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:s,motionValue:i}=this;for(let r=0;r<e.length;r++)if(e[r]===null)if(r===0){const o=i==null?void 0:i.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(s&&n){const l=s.readValue(n,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),i&&o===void 0&&i.set(e[0])}else e[r]=e[r-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Ft.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Ft.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const Tp=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),RE=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function IE(t){const e=RE.exec(t);if(!e)return[,];const[,n,s,i]=e;return[`--${n??s}`,i]}function Pp(t,e,n=1){const[s,i]=IE(t);if(!s)return;const r=window.getComputedStyle(e).getPropertyValue(s);if(r){const o=r.trim();return Tp(o)?parseFloat(o):o}return Ya(i)?Pp(i,e,n+1):i}const kp=t=>e=>e.test(t),AE={test:t=>t==="auto",parse:t=>t},Rp=[Fn,O,$e,lt,wS,vS,AE],cu=t=>Rp.find(kp(t));class Ip extends pl{constructor(e,n,s,i,r){super(e,n,s,i,r,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:s}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),Ya(c))){const u=Pp(c,n.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!op.has(s)||e.length!==2)return;const[i,r]=e,o=cu(i),a=cu(r);if(o!==a)if(ou(o)&&ou(a))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,s=[];for(let i=0;i<e.length;i++)aE(e[i])&&s.push(i);s.length&&EE(e,s,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:s}=this;if(!e||!e.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Rn[s](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&e.getValue(s,i).jump(i,!1)}measureEndState(){var e;const{element:n,name:s,unresolvedKeyframes:i}=this;if(!n||!n.current)return;const r=n.getValue(s);r&&r.jump(this.measuredOrigin,!1);const o=i.length-1,a=i[o];i[o]=Rn[s](n.measureViewportBox(),window.getComputedStyle(n.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{n.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const uu=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(bt.test(t)||t==="0")&&!t.startsWith("url("));function NE(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function DE(t,e,n,s){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const r=t[t.length-1],o=uu(i,e),a=uu(r,e);return!o||!a?!1:NE(t)||(n==="spring"||sl(n))&&s}const OE=t=>t!==null;function pr(t,{repeat:e,repeatType:n="loop"},s){const i=t.filter(OE),r=e&&n!=="loop"&&e%2===1?0:i.length-1;return!r||s===void 0?i[r]:s}const jE=40;class Ap{constructor({autoplay:e=!0,delay:n=0,type:s="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Be.now(),this.options={autoplay:e,delay:n,type:s,repeat:i,repeatDelay:r,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>jE?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&kE(),this._resolved}onKeyframesResolved(e,n){this.resolvedAt=Be.now(),this.hasAttemptedResolve=!0;const{name:s,type:i,velocity:r,delay:o,onComplete:a,onUpdate:l,isGenerator:c}=this.options;if(!c&&!DE(e,s,i,r))if(o)this.options.duration=0;else{l&&l(pr(e,this.options,n)),a&&a(),this.resolveFinishedPromise();return}const u=this.initPlayback(e,n);u!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...u},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Z=(t,e,n)=>t+(e-t)*n;function Hr(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function ME({hue:t,saturation:e,lightness:n,alpha:s}){t/=360,e/=100,n/=100;let i=0,r=0,o=0;if(!e)i=r=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;i=Hr(l,a,t+1/3),r=Hr(l,a,t),o=Hr(l,a,t-1/3)}return{red:Math.round(i*255),green:Math.round(r*255),blue:Math.round(o*255),alpha:s}}function Mi(t,e){return n=>n>0?e:t}const Gr=(t,e,n)=>{const s=t*t,i=n*(e*e-s)+s;return i<0?0:Math.sqrt(i)},LE=[Fo,Lt,un],FE=t=>LE.find(e=>e.test(t));function hu(t){const e=FE(t);if(!e)return!1;let n=e.parse(t);return e===un&&(n=ME(n)),n}const du=(t,e)=>{const n=hu(t),s=hu(e);if(!n||!s)return Mi(t,e);const i={...n};return r=>(i.red=Gr(n.red,s.red,r),i.green=Gr(n.green,s.green,r),i.blue=Gr(n.blue,s.blue,r),i.alpha=Z(n.alpha,s.alpha,r),Lt.transform(i))},$E=(t,e)=>n=>e(t(n)),Hs=(...t)=>t.reduce($E),Uo=new Set(["none","hidden"]);function BE(t,e){return Uo.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function VE(t,e){return n=>Z(t,e,n)}function ml(t){return typeof t=="number"?VE:typeof t=="string"?Ya(t)?Mi:me.test(t)?du:HE:Array.isArray(t)?Np:typeof t=="object"?me.test(t)?du:UE:Mi}function Np(t,e){const n=[...t],s=n.length,i=t.map((r,o)=>ml(r)(r,e[o]));return r=>{for(let o=0;o<s;o++)n[o]=i[o](r);return n}}function UE(t,e){const n={...t,...e},s={};for(const i in n)t[i]!==void 0&&e[i]!==void 0&&(s[i]=ml(t[i])(t[i],e[i]));return i=>{for(const r in s)n[r]=s[r](i);return n}}function WE(t,e){var n;const s=[],i={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const o=e.types[r],a=t.indexes[o][i[o]],l=(n=t.values[a])!==null&&n!==void 0?n:0;s[r]=l,i[o]++}return s}const HE=(t,e)=>{const n=bt.createTransformer(e),s=Rs(t),i=Rs(e);return s.indexes.var.length===i.indexes.var.length&&s.indexes.color.length===i.indexes.color.length&&s.indexes.number.length>=i.indexes.number.length?Uo.has(t)&&!i.values.length||Uo.has(e)&&!s.values.length?BE(t,e):Hs(Np(WE(s,i),i.values),n):Mi(t,e)};function Dp(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?Z(t,e,n):ml(t)(t,e)}const GE=5;function Op(t,e,n){const s=Math.max(e-GE,0);return ap(n-t(s),e-s)}const ne={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},fu=.001;function qE({duration:t=ne.duration,bounce:e=ne.bounce,velocity:n=ne.velocity,mass:s=ne.mass}){let i,r,o=1-e;o=tt(ne.minDamping,ne.maxDamping,o),t=tt(ne.minDuration,ne.maxDuration,Qe(t)),o<1?(i=c=>{const u=c*o,h=u*t,d=u-n,f=Wo(c,o),p=Math.exp(-h);return fu-d/f*p},r=c=>{const h=c*o*t,d=h*n+n,f=Math.pow(o,2)*Math.pow(c,2)*t,p=Math.exp(-h),m=Wo(Math.pow(c,2),o);return(-i(c)+fu>0?-1:1)*((d-f)*p)/m}):(i=c=>{const u=Math.exp(-c*t),h=(c-n)*t+1;return-.001+u*h},r=c=>{const u=Math.exp(-c*t),h=(n-c)*(t*t);return u*h});const a=5/t,l=KE(i,r,a);if(t=Je(t),isNaN(l))return{stiffness:ne.stiffness,damping:ne.damping,duration:t};{const c=Math.pow(l,2)*s;return{stiffness:c,damping:o*2*Math.sqrt(s*c),duration:t}}}const zE=12;function KE(t,e,n){let s=n;for(let i=1;i<zE;i++)s=s-t(s)/e(s);return s}function Wo(t,e){return t*Math.sqrt(1-e*e)}const YE=["duration","bounce"],JE=["stiffness","damping","mass"];function pu(t,e){return e.some(n=>t[n]!==void 0)}function QE(t){let e={velocity:ne.velocity,stiffness:ne.stiffness,damping:ne.damping,mass:ne.mass,isResolvedFromDuration:!1,...t};if(!pu(t,JE)&&pu(t,YE))if(t.visualDuration){const n=t.visualDuration,s=2*Math.PI/(n*1.2),i=s*s,r=2*tt(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:ne.mass,stiffness:i,damping:r}}else{const n=qE(t);e={...e,...n,mass:ne.mass},e.isResolvedFromDuration=!0}return e}function jp(t=ne.visualDuration,e=ne.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:s,restDelta:i}=n;const r=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],a={done:!1,value:r},{stiffness:l,damping:c,mass:u,duration:h,velocity:d,isResolvedFromDuration:f}=QE({...n,velocity:-Qe(n.velocity||0)}),p=d||0,m=c/(2*Math.sqrt(l*u)),_=o-r,v=Qe(Math.sqrt(l/u)),b=Math.abs(_)<5;s||(s=b?ne.restSpeed.granular:ne.restSpeed.default),i||(i=b?ne.restDelta.granular:ne.restDelta.default);let w;if(m<1){const E=Wo(v,m);w=k=>{const M=Math.exp(-m*v*k);return o-M*((p+m*v*_)/E*Math.sin(E*k)+_*Math.cos(E*k))}}else if(m===1)w=E=>o-Math.exp(-v*E)*(_+(p+v*_)*E);else{const E=v*Math.sqrt(m*m-1);w=k=>{const M=Math.exp(-m*v*k),D=Math.min(E*k,300);return o-M*((p+m*v*_)*Math.sinh(D)+E*_*Math.cosh(D))/E}}const x={calculatedDuration:f&&h||null,next:E=>{const k=w(E);if(f)a.done=E>=h;else{let M=0;m<1&&(M=E===0?Je(p):Op(w,E,k));const D=Math.abs(M)<=s,P=Math.abs(o-k)<=i;a.done=D&&P}return a.value=a.done?o:k,a},toString:()=>{const E=Math.min(Zf(x),jo),k=ep(M=>x.next(E*M).value,E,30);return E+"ms "+k}};return x}function mu({keyframes:t,velocity:e=0,power:n=.8,timeConstant:s=325,bounceDamping:i=10,bounceStiffness:r=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:u}){const h=t[0],d={done:!1,value:h},f=D=>a!==void 0&&D<a||l!==void 0&&D>l,p=D=>a===void 0?l:l===void 0||Math.abs(a-D)<Math.abs(l-D)?a:l;let m=n*e;const _=h+m,v=o===void 0?_:o(_);v!==_&&(m=v-h);const b=D=>-m*Math.exp(-D/s),w=D=>v+b(D),x=D=>{const P=b(D),R=w(D);d.done=Math.abs(P)<=c,d.value=d.done?v:R};let E,k;const M=D=>{f(d.value)&&(E=D,k=jp({keyframes:[d.value,p(d.value)],velocity:Op(w,D,d.value),damping:i,stiffness:r,restDelta:c,restSpeed:u}))};return M(0),{calculatedDuration:null,next:D=>{let P=!1;return!k&&E===void 0&&(P=!0,x(D),M(D)),E!==void 0&&D>=E?k.next(D-E):(!P&&x(D),d)}}}const XE=Ws(.42,0,1,1),ZE=Ws(0,0,.58,1),Mp=Ws(.42,0,.58,1),eC=t=>Array.isArray(t)&&typeof t[0]!="number",tC={linear:Ee,easeIn:XE,easeInOut:Mp,easeOut:ZE,circIn:ul,circInOut:gp,circOut:mp,backIn:cl,backInOut:fp,backOut:dp,anticipate:pp},gu=t=>{if(il(t)){Df(t.length===4);const[e,n,s,i]=t;return Ws(e,n,s,i)}else if(typeof t=="string")return tC[t];return t};function nC(t,e,n){const s=[],i=n||Dp,r=t.length-1;for(let o=0;o<r;o++){let a=i(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||Ee:e;a=Hs(l,a)}s.push(a)}return s}function sC(t,e,{clamp:n=!0,ease:s,mixer:i}={}){const r=t.length;if(Df(r===e.length),r===1)return()=>e[0];if(r===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[r-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=nC(e,s,i),l=a.length,c=u=>{if(o&&u<t[0])return e[0];let h=0;if(l>1)for(;h<t.length-2&&!(u<t[h+1]);h++);const d=Pn(t[h],t[h+1],u);return a[h](d)};return n?u=>c(tt(t[0],t[r-1],u)):c}function iC(t,e){const n=t[t.length-1];for(let s=1;s<=e;s++){const i=Pn(0,e,s);t.push(Z(n,1,i))}}function rC(t){const e=[0];return iC(e,t.length-1),e}function oC(t,e){return t.map(n=>n*e)}function aC(t,e){return t.map(()=>e||Mp).splice(0,t.length-1)}function Li({duration:t=300,keyframes:e,times:n,ease:s="easeInOut"}){const i=eC(s)?s.map(gu):gu(s),r={done:!1,value:e[0]},o=oC(n&&n.length===e.length?n:rC(e),t),a=sC(o,e,{ease:Array.isArray(i)?i:aC(e,i)});return{calculatedDuration:t,next:l=>(r.value=a(l),r.done=l>=t,r)}}const lC=t=>{const e=({timestamp:n})=>t(n);return{start:()=>Q.update(e,!0),stop:()=>wt(e),now:()=>fe.isProcessing?fe.timestamp:Be.now()}},cC={decay:mu,inertia:mu,tween:Li,keyframes:Li,spring:jp},uC=t=>t/100;class gl extends Ap{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:n,motionValue:s,element:i,keyframes:r}=this.options,o=(i==null?void 0:i.KeyframeResolver)||pl,a=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new o(r,a,n,s,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:n="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:r,velocity:o=0}=this.options,a=sl(n)?n:cC[n]||Li;let l,c;a!==Li&&typeof e[0]!="number"&&(l=Hs(uC,Dp(e[0],e[1])),e=[0,100]);const u=a({...this.options,keyframes:e});r==="mirror"&&(c=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=Zf(u));const{calculatedDuration:h}=u,d=h+i,f=d*(s+1)-i;return{generator:u,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:h,resolvedDuration:d,totalDuration:f}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:s}=this;if(!s){const{keyframes:D}=this.options;return{done:!0,value:D[D.length-1]}}const{finalKeyframe:i,generator:r,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:c,totalDuration:u,resolvedDuration:h}=s;if(this.startTime===null)return r.next(0);const{delay:d,repeat:f,repeatType:p,repeatDelay:m,onUpdate:_}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-u/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const v=this.currentTime-d*(this.speed>=0?1:-1),b=this.speed>=0?v<0:v>u;this.currentTime=Math.max(v,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let w=this.currentTime,x=r;if(f){const D=Math.min(this.currentTime,u)/h;let P=Math.floor(D),R=D%1;!R&&D>=1&&(R=1),R===1&&P--,P=Math.min(P,f+1),!!(P%2)&&(p==="reverse"?(R=1-R,m&&(R-=m/h)):p==="mirror"&&(x=o)),w=tt(0,1,R)*h}const E=b?{done:!1,value:l[0]}:x.next(w);a&&(E.value=a(E.value));let{done:k}=E;!b&&c!==null&&(k=this.speed>=0?this.currentTime>=u:this.currentTime<=0);const M=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&k);return M&&i!==void 0&&(E.value=pr(l,this.options,i)),_&&_(E.value),M&&this.finish(),E}get duration(){const{resolved:e}=this;return e?Qe(e.calculatedDuration):0}get time(){return Qe(this.currentTime)}set time(e){e=Je(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=Qe(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=lC,onPlay:n,startTime:s}=this.options;this.driver||(this.driver=e(r=>this.tick(r))),n&&n();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=s??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const hC=new Set(["opacity","clipPath","filter","transform"]);function dC(t,e,n,{delay:s=0,duration:i=300,repeat:r=0,repeatType:o="loop",ease:a="easeInOut",times:l}={}){const c={[e]:n};l&&(c.offset=l);const u=np(a,i);return Array.isArray(u)&&(c.easing=u),t.animate(c,{delay:s,duration:i,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:r+1,direction:o==="reverse"?"alternate":"normal"})}const fC=Ua(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Fi=10,pC=2e4;function mC(t){return sl(t.type)||t.type==="spring"||!tp(t.ease)}function gC(t,e){const n=new gl({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let s={done:!1,value:t[0]};const i=[];let r=0;for(;!s.done&&r<pC;)s=n.sample(r),i.push(s.value),r+=Fi;return{times:void 0,keyframes:i,duration:r-Fi,ease:"linear"}}const Lp={anticipate:pp,backInOut:fp,circInOut:gp};function yC(t){return t in Lp}class yu extends Ap{constructor(e){super(e);const{name:n,motionValue:s,element:i,keyframes:r}=this.options;this.resolver=new Ip(r,(o,a)=>this.onKeyframesResolved(o,a),n,s,i),this.resolver.scheduleResolve()}initPlayback(e,n){let{duration:s=300,times:i,ease:r,type:o,motionValue:a,name:l,startTime:c}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof r=="string"&&ji()&&yC(r)&&(r=Lp[r]),mC(this.options)){const{onComplete:h,onUpdate:d,motionValue:f,element:p,...m}=this.options,_=gC(e,m);e=_.keyframes,e.length===1&&(e[1]=e[0]),s=_.duration,i=_.times,r=_.ease,o="keyframes"}const u=dC(a.owner.current,l,e,{...this.options,duration:s,times:i,ease:r});return u.startTime=c??this.calcStartTime(),this.pendingTimeline?(eu(u,this.pendingTimeline),this.pendingTimeline=void 0):u.onfinish=()=>{const{onComplete:h}=this.options;a.set(pr(e,this.options,n)),h&&h(),this.cancel(),this.resolveFinishedPromise()},{animation:u,duration:s,times:i,type:o,ease:r,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return Qe(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return Qe(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.currentTime=Je(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:n}=e;return n.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return Ee;const{animation:s}=n;eu(s,e)}return Ee}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:s,duration:i,type:r,ease:o,times:a}=e;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:u,onComplete:h,element:d,...f}=this.options,p=new gl({...f,keyframes:s,duration:i,type:r,ease:o,times:a,isGenerator:!0}),m=Je(this.time);c.setWithVelocity(p.sample(m-Fi).value,p.sample(m).value,Fi)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:s,repeatDelay:i,repeatType:r,damping:o,type:a}=e;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=n.owner.getProps();return fC()&&s&&hC.has(s)&&!l&&!c&&!i&&r!=="mirror"&&o!==0&&a!=="inertia"}}const _C={type:"spring",stiffness:500,damping:25,restSpeed:10},vC=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),wC={type:"keyframes",duration:.8},bC={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},xC=(t,{keyframes:e})=>e.length>2?wC:Gt.has(t)?t.startsWith("scale")?vC(e[1]):_C:bC;function SC({when:t,delay:e,delayChildren:n,staggerChildren:s,staggerDirection:i,repeat:r,repeatType:o,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const yl=(t,e,n,s={},i,r)=>o=>{const a=nl(s,t)||{},l=a.delay||s.delay||0;let{elapsed:c=0}=s;c=c-Je(l);let u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:d=>{e.set(d),a.onUpdate&&a.onUpdate(d)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:r?void 0:i};SC(a)||(u={...u,...xC(t,u)}),u.duration&&(u.duration=Je(u.duration)),u.repeatDelay&&(u.repeatDelay=Je(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let h=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(h=!0)),h&&!r&&e.get()!==void 0){const d=pr(u.keyframes,a);if(d!==void 0)return Q.update(()=>{u.onUpdate(d),u.onComplete()}),new US([])}return!r&&yu.supports(u)?new yu(u):new gl(u)};function EC({protectedKeys:t,needsAnimating:e},n){const s=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,s}function Fp(t,e,{delay:n=0,transitionOverride:s,type:i}={}){var r;let{transition:o=t.getDefaultTransition(),transitionEnd:a,...l}=e;s&&(o=s);const c=[],u=i&&t.animationState&&t.animationState.getState()[i];for(const h in l){const d=t.getValue(h,(r=t.latestValues[h])!==null&&r!==void 0?r:null),f=l[h];if(f===void 0||u&&EC(u,h))continue;const p={delay:n,...nl(o||{},h)};let m=!1;if(window.MotionHandoffAnimation){const v=lp(t);if(v){const b=window.MotionHandoffAnimation(v,h,Q);b!==null&&(p.startTime=b,m=!0)}}Lo(t,h),d.start(yl(h,d,f,t.shouldReduceMotion&&op.has(h)?{type:!1}:p,t,m));const _=d.animation;_&&c.push(_)}return a&&Promise.all(c).then(()=>{Q.update(()=>{a&&nE(t,a)})}),c}function Ho(t,e,n={}){var s;const i=fr(t,e,n.type==="exit"?(s=t.presenceContext)===null||s===void 0?void 0:s.custom:void 0);let{transition:r=t.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(r=n.transitionOverride);const o=i?()=>Promise.all(Fp(t,i,n)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:d}=r;return CC(t,e,u+c,h,d,n)}:()=>Promise.resolve(),{when:l}=r;if(l){const[c,u]=l==="beforeChildren"?[o,a]:[a,o];return c().then(()=>u())}else return Promise.all([o(),a(n.delay)])}function CC(t,e,n=0,s=0,i=1,r){const o=[],a=(t.variantChildren.size-1)*s,l=i===1?(c=0)=>c*s:(c=0)=>a-c*s;return Array.from(t.variantChildren).sort(TC).forEach((c,u)=>{c.notify("AnimationStart",e),o.push(Ho(c,e,{...r,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function TC(t,e){return t.sortNodePosition(e)}function PC(t,e,n={}){t.notify("AnimationStart",e);let s;if(Array.isArray(e)){const i=e.map(r=>Ho(t,r,n));s=Promise.all(i)}else if(typeof e=="string")s=Ho(t,e,n);else{const i=typeof e=="function"?fr(t,e,n.custom):e;s=Promise.all(Fp(t,i,n))}return s.then(()=>{t.notify("AnimationComplete",e)})}const kC=Ha.length;function $p(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?$p(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<kC;n++){const s=Ha[n],i=t.props[s];(Ts(i)||i===!1)&&(e[s]=i)}return e}const RC=[...Wa].reverse(),IC=Wa.length;function AC(t){return e=>Promise.all(e.map(({animation:n,options:s})=>PC(t,n,s)))}function NC(t){let e=AC(t),n=_u(),s=!0;const i=l=>(c,u)=>{var h;const d=fr(t,u,l==="exit"?(h=t.presenceContext)===null||h===void 0?void 0:h.custom:void 0);if(d){const{transition:f,transitionEnd:p,...m}=d;c={...c,...m,...p}}return c};function r(l){e=l(t)}function o(l){const{props:c}=t,u=$p(t.parent)||{},h=[],d=new Set;let f={},p=1/0;for(let _=0;_<IC;_++){const v=RC[_],b=n[v],w=c[v]!==void 0?c[v]:u[v],x=Ts(w),E=v===l?b.isActive:null;E===!1&&(p=_);let k=w===u[v]&&w!==c[v]&&x;if(k&&s&&t.manuallyAnimateOnMount&&(k=!1),b.protectedKeys={...f},!b.isActive&&E===null||!w&&!b.prevProp||hr(w)||typeof w=="boolean")continue;const M=DC(b.prevProp,w);let D=M||v===l&&b.isActive&&!k&&x||_>p&&x,P=!1;const R=Array.isArray(w)?w:[w];let S=R.reduce(i(v),{});E===!1&&(S={});const{prevResolvedValues:T={}}=b,A={...T,...S},I=L=>{D=!0,d.has(L)&&(P=!0,d.delete(L)),b.needsAnimating[L]=!0;const H=t.getValue(L);H&&(H.liveStyle=!1)};for(const L in A){const H=S[L],ye=T[L];if(f.hasOwnProperty(L))continue;let Te=!1;Oo(H)&&Oo(ye)?Te=!Xf(H,ye):Te=H!==ye,Te?H!=null?I(L):d.add(L):H!==void 0&&d.has(L)?I(L):b.protectedKeys[L]=!0}b.prevProp=w,b.prevResolvedValues=S,b.isActive&&(f={...f,...S}),s&&t.blockInitialAnimation&&(D=!1),D&&(!(k&&M)||P)&&h.push(...R.map(L=>({animation:L,options:{type:v}})))}if(d.size){const _={};d.forEach(v=>{const b=t.getBaseTarget(v),w=t.getValue(v);w&&(w.liveStyle=!0),_[v]=b??null}),h.push({animation:_})}let m=!!h.length;return s&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(m=!1),s=!1,m?e(h):Promise.resolve()}function a(l,c){var u;if(n[l].isActive===c)return Promise.resolve();(u=t.variantChildren)===null||u===void 0||u.forEach(d=>{var f;return(f=d.animationState)===null||f===void 0?void 0:f.setActive(l,c)}),n[l].isActive=c;const h=o(l);for(const d in n)n[d].protectedKeys={};return h}return{animateChanges:o,setActive:a,setAnimateFunction:r,getState:()=>n,reset:()=>{n=_u(),s=!0}}}function DC(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!Xf(e,t):!1}function Pt(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function _u(){return{animate:Pt(!0),whileInView:Pt(),whileHover:Pt(),whileTap:Pt(),whileDrag:Pt(),whileFocus:Pt(),exit:Pt()}}class Et{constructor(e){this.isMounted=!1,this.node=e}update(){}}class OC extends Et{constructor(e){super(e),e.animationState||(e.animationState=NC(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();hr(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let jC=0;class MC extends Et{constructor(){super(...arguments),this.id=jC++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const i=this.node.animationState.setActive("exit",!e);n&&!e&&i.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const LC={animation:{Feature:OC},exit:{Feature:MC}};function Is(t,e,n,s={passive:!0}){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n)}function Gs(t){return{point:{x:t.pageX,y:t.pageY}}}const FC=t=>e=>rl(e)&&t(e,Gs(e));function us(t,e,n,s){return Is(t,e,FC(n),s)}const vu=(t,e)=>Math.abs(t-e);function $C(t,e){const n=vu(t.x,e.x),s=vu(t.y,e.y);return Math.sqrt(n**2+s**2)}class Bp{constructor(e,n,{transformPagePoint:s,contextWindow:i,dragSnapToOrigin:r=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=zr(this.lastMoveEventInfo,this.history),d=this.startEvent!==null,f=$C(h.offset,{x:0,y:0})>=3;if(!d&&!f)return;const{point:p}=h,{timestamp:m}=fe;this.history.push({...p,timestamp:m});const{onStart:_,onMove:v}=this.handlers;d||(_&&_(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,h)},this.handlePointerMove=(h,d)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=qr(d,this.transformPagePoint),Q.update(this.updatePoint,!0)},this.handlePointerUp=(h,d)=>{this.end();const{onEnd:f,onSessionEnd:p,resumeAnimation:m}=this.handlers;if(this.dragSnapToOrigin&&m&&m(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const _=zr(h.type==="pointercancel"?this.lastMoveEventInfo:qr(d,this.transformPagePoint),this.history);this.startEvent&&f&&f(h,_),p&&p(h,_)},!rl(e))return;this.dragSnapToOrigin=r,this.handlers=n,this.transformPagePoint=s,this.contextWindow=i||window;const o=Gs(e),a=qr(o,this.transformPagePoint),{point:l}=a,{timestamp:c}=fe;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(e,zr(a,this.history)),this.removeListeners=Hs(us(this.contextWindow,"pointermove",this.handlePointerMove),us(this.contextWindow,"pointerup",this.handlePointerUp),us(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),wt(this.updatePoint)}}function qr(t,e){return e?{point:e(t.point)}:t}function wu(t,e){return{x:t.x-e.x,y:t.y-e.y}}function zr({point:t},e){return{point:t,delta:wu(t,Vp(e)),offset:wu(t,BC(e)),velocity:VC(e,.1)}}function BC(t){return t[0]}function Vp(t){return t[t.length-1]}function VC(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,s=null;const i=Vp(t);for(;n>=0&&(s=t[n],!(i.timestamp-s.timestamp>Je(e)));)n--;if(!s)return{x:0,y:0};const r=Qe(i.timestamp-s.timestamp);if(r===0)return{x:0,y:0};const o={x:(i.x-s.x)/r,y:(i.y-s.y)/r};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const Up=1e-4,UC=1-Up,WC=1+Up,Wp=.01,HC=0-Wp,GC=0+Wp;function Ce(t){return t.max-t.min}function qC(t,e,n){return Math.abs(t-e)<=n}function bu(t,e,n,s=.5){t.origin=s,t.originPoint=Z(e.min,e.max,t.origin),t.scale=Ce(n)/Ce(e),t.translate=Z(n.min,n.max,t.origin)-t.originPoint,(t.scale>=UC&&t.scale<=WC||isNaN(t.scale))&&(t.scale=1),(t.translate>=HC&&t.translate<=GC||isNaN(t.translate))&&(t.translate=0)}function hs(t,e,n,s){bu(t.x,e.x,n.x,s?s.originX:void 0),bu(t.y,e.y,n.y,s?s.originY:void 0)}function xu(t,e,n){t.min=n.min+e.min,t.max=t.min+Ce(e)}function zC(t,e,n){xu(t.x,e.x,n.x),xu(t.y,e.y,n.y)}function Su(t,e,n){t.min=e.min-n.min,t.max=t.min+Ce(e)}function ds(t,e,n){Su(t.x,e.x,n.x),Su(t.y,e.y,n.y)}function KC(t,{min:e,max:n},s){return e!==void 0&&t<e?t=s?Z(e,t,s.min):Math.max(t,e):n!==void 0&&t>n&&(t=s?Z(n,t,s.max):Math.min(t,n)),t}function Eu(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function YC(t,{top:e,left:n,bottom:s,right:i}){return{x:Eu(t.x,n,i),y:Eu(t.y,e,s)}}function Cu(t,e){let n=e.min-t.min,s=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,s]=[s,n]),{min:n,max:s}}function JC(t,e){return{x:Cu(t.x,e.x),y:Cu(t.y,e.y)}}function QC(t,e){let n=.5;const s=Ce(t),i=Ce(e);return i>s?n=Pn(e.min,e.max-s,t.min):s>i&&(n=Pn(t.min,t.max-i,e.min)),tt(0,1,n)}function XC(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const Go=.35;function ZC(t=Go){return t===!1?t=0:t===!0&&(t=Go),{x:Tu(t,"left","right"),y:Tu(t,"top","bottom")}}function Tu(t,e,n){return{min:Pu(t,e),max:Pu(t,n)}}function Pu(t,e){return typeof t=="number"?t:t[e]||0}const ku=()=>({translate:0,scale:1,origin:0,originPoint:0}),hn=()=>({x:ku(),y:ku()}),Ru=()=>({min:0,max:0}),ie=()=>({x:Ru(),y:Ru()});function ke(t){return[t("x"),t("y")]}function Hp({top:t,left:e,right:n,bottom:s}){return{x:{min:e,max:n},y:{min:t,max:s}}}function eT({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function tT(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),s=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}function Kr(t){return t===void 0||t===1}function qo({scale:t,scaleX:e,scaleY:n}){return!Kr(t)||!Kr(e)||!Kr(n)}function At(t){return qo(t)||Gp(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function Gp(t){return Iu(t.x)||Iu(t.y)}function Iu(t){return t&&t!=="0%"}function $i(t,e,n){const s=t-n,i=e*s;return n+i}function Au(t,e,n,s,i){return i!==void 0&&(t=$i(t,i,s)),$i(t,n,s)+e}function zo(t,e=0,n=1,s,i){t.min=Au(t.min,e,n,s,i),t.max=Au(t.max,e,n,s,i)}function qp(t,{x:e,y:n}){zo(t.x,e.translate,e.scale,e.originPoint),zo(t.y,n.translate,n.scale,n.originPoint)}const Nu=.999999999999,Du=1.0000000000001;function nT(t,e,n,s=!1){const i=n.length;if(!i)return;e.x=e.y=1;let r,o;for(let a=0;a<i;a++){r=n[a],o=r.projectionDelta;const{visualElement:l}=r.options;l&&l.props.style&&l.props.style.display==="contents"||(s&&r.options.layoutScroll&&r.scroll&&r!==r.root&&fn(t,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,qp(t,o)),s&&At(r.latestValues)&&fn(t,r.latestValues))}e.x<Du&&e.x>Nu&&(e.x=1),e.y<Du&&e.y>Nu&&(e.y=1)}function dn(t,e){t.min=t.min+e,t.max=t.max+e}function Ou(t,e,n,s,i=.5){const r=Z(t.min,t.max,i);zo(t,e,n,r,s)}function fn(t,e){Ou(t.x,e.x,e.scaleX,e.scale,e.originX),Ou(t.y,e.y,e.scaleY,e.scale,e.originY)}function zp(t,e){return Hp(tT(t.getBoundingClientRect(),e))}function sT(t,e,n){const s=zp(t,n),{scroll:i}=e;return i&&(dn(s.x,i.offset.x),dn(s.y,i.offset.y)),s}const Kp=({current:t})=>t?t.ownerDocument.defaultView:null,iT=new WeakMap;class rT{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ie(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const i=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Gs(u).point)},r=(u,h)=>{const{drag:d,dragPropagation:f,onDragStart:p}=this.getProps();if(d&&!f&&(this.openDragLock&&this.openDragLock(),this.openDragLock=QS(d),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ke(_=>{let v=this.getAxisMotionValue(_).get()||0;if($e.test(v)){const{projection:b}=this.visualElement;if(b&&b.layout){const w=b.layout.layoutBox[_];w&&(v=Ce(w)*(parseFloat(v)/100))}}this.originPoint[_]=v}),p&&Q.postRender(()=>p(u,h)),Lo(this.visualElement,"transform");const{animationState:m}=this.visualElement;m&&m.setActive("whileDrag",!0)},o=(u,h)=>{const{dragPropagation:d,dragDirectionLock:f,onDirectionLock:p,onDrag:m}=this.getProps();if(!d&&!this.openDragLock)return;const{offset:_}=h;if(f&&this.currentDirection===null){this.currentDirection=oT(_),this.currentDirection!==null&&p&&p(this.currentDirection);return}this.updateAxis("x",h.point,_),this.updateAxis("y",h.point,_),this.visualElement.render(),m&&m(u,h)},a=(u,h)=>this.stop(u,h),l=()=>ke(u=>{var h;return this.getAnimationState(u)==="paused"&&((h=this.getAxisMotionValue(u).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new Bp(e,{onSessionStart:i,onStart:r,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:Kp(this.visualElement)})}stop(e,n){const s=this.isDragging;if(this.cancel(),!s)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:r}=this.getProps();r&&Q.postRender(()=>r(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,s){const{drag:i}=this.getProps();if(!s||!si(e,i,this.currentDirection))return;const r=this.getAxisMotionValue(e);let o=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(o=KC(o,this.constraints[e],this.elastic[e])),r.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:s}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,r=this.constraints;n&&cn(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&i?this.constraints=YC(i.layoutBox,n):this.constraints=!1,this.elastic=ZC(s),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&ke(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=XC(i.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!cn(e))return!1;const s=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const r=sT(s,i.root,this.visualElement.getTransformPagePoint());let o=JC(i.layout.layoutBox,r);if(n){const a=n(eT(o));this.hasMutatedConstraints=!!a,a&&(o=Hp(a))}return o}startAnimation(e){const{drag:n,dragMomentum:s,dragElastic:i,dragTransition:r,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=ke(u=>{if(!si(u,n,this.currentDirection))return;let h=l&&l[u]||{};o&&(h={min:0,max:0});const d=i?200:1e6,f=i?40:1e7,p={type:"inertia",velocity:s?e[u]:0,bounceStiffness:d,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...r,...h};return this.startAxisValueAnimation(u,p)});return Promise.all(c).then(a)}startAxisValueAnimation(e,n){const s=this.getAxisMotionValue(e);return Lo(this.visualElement,e),s.start(yl(e,s,0,n,this.visualElement,!1))}stopAnimation(){ke(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ke(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps(),i=s[n];return i||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){ke(n=>{const{drag:s}=this.getProps();if(!si(n,s,this.currentDirection))return;const{projection:i}=this.visualElement,r=this.getAxisMotionValue(n);if(i&&i.layout){const{min:o,max:a}=i.layout.layoutBox[n];r.set(e[n]-Z(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:s}=this.visualElement;if(!cn(n)||!s||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};ke(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();i[o]=QC({min:l,max:l},this.constraints[o])}});const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),ke(o=>{if(!si(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(Z(l,c,i[o]))})}addListeners(){if(!this.visualElement.current)return;iT.set(this.visualElement,this);const e=this.visualElement.current,n=us(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),s=()=>{const{dragConstraints:l}=this.getProps();cn(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,r=i.addEventListener("measure",s);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Q.read(s);const o=Is(window,"resize",()=>this.scalePositionWithinConstraints()),a=i.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(ke(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=l[u].translate,h.set(h.get()+l[u].translate))}),this.visualElement.render())});return()=>{o(),n(),r(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:s=!1,dragPropagation:i=!1,dragConstraints:r=!1,dragElastic:o=Go,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:s,dragPropagation:i,dragConstraints:r,dragElastic:o,dragMomentum:a}}}function si(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function oT(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class aT extends Et{constructor(e){super(e),this.removeGroupControls=Ee,this.removeListeners=Ee,this.controls=new rT(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ee}unmount(){this.removeGroupControls(),this.removeListeners()}}const ju=t=>(e,n)=>{t&&Q.postRender(()=>t(e,n))};class lT extends Et{constructor(){super(...arguments),this.removePointerDownListener=Ee}onPointerDown(e){this.session=new Bp(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Kp(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:s,onPanEnd:i}=this.node.getProps();return{onSessionStart:ju(e),onStart:ju(n),onMove:s,onEnd:(r,o)=>{delete this.session,i&&Q.postRender(()=>i(r,o))}}}mount(){this.removePointerDownListener=us(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const ci={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Mu(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Yn={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(O.test(t))t=parseFloat(t);else return t;const n=Mu(t,e.target.x),s=Mu(t,e.target.y);return`${n}% ${s}%`}},cT={correct:(t,{treeScale:e,projectionDelta:n})=>{const s=t,i=bt.parse(t);if(i.length>5)return s;const r=bt.createTransformer(t),o=typeof i[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;i[0+o]/=a,i[1+o]/=l;const c=Z(a,l,.5);return typeof i[2+o]=="number"&&(i[2+o]/=c),typeof i[3+o]=="number"&&(i[3+o]/=c),r(i)}};class uT extends y.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s,layoutId:i}=this.props,{projection:r}=e;IS(hT),r&&(n.group&&n.group.add(r),s&&s.register&&i&&s.register(r),r.root.didUpdate(),r.addEventListener("animationComplete",()=>{this.safeToRemove()}),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),ci.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:s,drag:i,isPresent:r}=this.props,o=s.projection;return o&&(o.isPresent=r,i||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==r&&(r?o.promote():o.relegate()||Q.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),qa.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),s&&s.deregister&&s.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Yp(t){const[e,n]=Gx(),s=y.useContext(Af);return g.jsx(uT,{...t,layoutGroup:s,switchLayoutGroup:y.useContext($f),isPresent:e,safeToRemove:n})}const hT={borderRadius:{...Yn,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Yn,borderTopRightRadius:Yn,borderBottomLeftRadius:Yn,borderBottomRightRadius:Yn,boxShadow:cT};function dT(t,e,n){const s=ge(t)?t:ks(t);return s.start(yl("",s,e,n)),s.animation}function fT(t){return t instanceof SVGElement&&t.tagName!=="svg"}const pT=(t,e)=>t.depth-e.depth;class mT{constructor(){this.children=[],this.isDirty=!1}add(e){ol(this.children,e),this.isDirty=!0}remove(e){al(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(pT),this.isDirty=!1,this.children.forEach(e)}}function gT(t,e){const n=Be.now(),s=({timestamp:i})=>{const r=i-n;r>=e&&(wt(s),t(r-e))};return Q.read(s,!0),()=>wt(s)}const Jp=["TopLeft","TopRight","BottomLeft","BottomRight"],yT=Jp.length,Lu=t=>typeof t=="string"?parseFloat(t):t,Fu=t=>typeof t=="number"||O.test(t);function _T(t,e,n,s,i,r){i?(t.opacity=Z(0,n.opacity!==void 0?n.opacity:1,vT(s)),t.opacityExit=Z(e.opacity!==void 0?e.opacity:1,0,wT(s))):r&&(t.opacity=Z(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,s));for(let o=0;o<yT;o++){const a=`border${Jp[o]}Radius`;let l=$u(e,a),c=$u(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||Fu(l)===Fu(c)?(t[a]=Math.max(Z(Lu(l),Lu(c),s),0),($e.test(c)||$e.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||n.rotate)&&(t.rotate=Z(e.rotate||0,n.rotate||0,s))}function $u(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const vT=Qp(0,.5,mp),wT=Qp(.5,.95,Ee);function Qp(t,e,n){return s=>s<t?0:s>e?1:n(Pn(t,e,s))}function Bu(t,e){t.min=e.min,t.max=e.max}function Pe(t,e){Bu(t.x,e.x),Bu(t.y,e.y)}function Vu(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function Uu(t,e,n,s,i){return t-=e,t=$i(t,1/n,s),i!==void 0&&(t=$i(t,1/i,s)),t}function bT(t,e=0,n=1,s=.5,i,r=t,o=t){if($e.test(e)&&(e=parseFloat(e),e=Z(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=Z(r.min,r.max,s);t===r&&(a-=e),t.min=Uu(t.min,e,n,a,i),t.max=Uu(t.max,e,n,a,i)}function Wu(t,e,[n,s,i],r,o){bT(t,e[n],e[s],e[i],e.scale,r,o)}const xT=["x","scaleX","originX"],ST=["y","scaleY","originY"];function Hu(t,e,n,s){Wu(t.x,e,xT,n?n.x:void 0,s?s.x:void 0),Wu(t.y,e,ST,n?n.y:void 0,s?s.y:void 0)}function Gu(t){return t.translate===0&&t.scale===1}function Xp(t){return Gu(t.x)&&Gu(t.y)}function qu(t,e){return t.min===e.min&&t.max===e.max}function ET(t,e){return qu(t.x,e.x)&&qu(t.y,e.y)}function zu(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function Zp(t,e){return zu(t.x,e.x)&&zu(t.y,e.y)}function Ku(t){return Ce(t.x)/Ce(t.y)}function Yu(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class CT{constructor(){this.members=[]}add(e){ol(this.members,e),e.scheduleRender()}remove(e){if(al(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(i=>e===i);if(n===0)return!1;let s;for(let i=n;i>=0;i--){const r=this.members[i];if(r.isPresent!==!1){s=r;break}}return s?(this.promote(s),!0):!1}promote(e,n){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,n&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:s}=e;n.onExitComplete&&n.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function TT(t,e,n){let s="";const i=t.x.translate/e.x,r=t.y.translate/e.y,o=(n==null?void 0:n.z)||0;if((i||r||o)&&(s=`translate3d(${i}px, ${r}px, ${o}px) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:h,rotateY:d,skewX:f,skewY:p}=n;c&&(s=`perspective(${c}px) ${s}`),u&&(s+=`rotate(${u}deg) `),h&&(s+=`rotateX(${h}deg) `),d&&(s+=`rotateY(${d}deg) `),f&&(s+=`skewX(${f}deg) `),p&&(s+=`skewY(${p}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(s+=`scale(${a}, ${l})`),s||"none"}const Nt={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},ts=typeof window<"u"&&window.MotionDebug!==void 0,Yr=["","X","Y","Z"],PT={visibility:"hidden"},Ju=1e3;let kT=0;function Jr(t,e,n,s){const{latestValues:i}=e;i[t]&&(n[t]=i[t],e.setStaticValue(t,0),s&&(s[t]=0))}function em(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=lp(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:r}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",Q,!(i||r))}const{parent:s}=t;s&&!s.hasCheckedOptimisedAppear&&em(s)}function tm({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:s,resetTransform:i}){return class{constructor(o={},a=e==null?void 0:e()){this.id=kT++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,ts&&(Nt.totalNodes=Nt.resolvedTargetDeltas=Nt.recalculatedProjection=0),this.nodes.forEach(AT),this.nodes.forEach(MT),this.nodes.forEach(LT),this.nodes.forEach(NT),ts&&window.MotionDebug.record(Nt)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new mT)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new ll),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=fT(o),this.instance=o;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),t){let h;const d=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=gT(d,250),ci.hasAnimatedSinceResize&&(ci.hasAnimatedSinceResize=!1,this.nodes.forEach(Xu))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:d,hasRelativeTargetChanged:f,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||u.getDefaultTransition()||UT,{onLayoutAnimationStart:_,onLayoutAnimationComplete:v}=u.getProps(),b=!this.targetLayout||!Zp(this.targetLayout,p)||f,w=!d&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||w||d&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,w);const x={...nl(m,"layout"),onPlay:_,onComplete:v};(u.shouldReduceMotion||this.options.layoutRoot)&&(x.delay=0,x.type=!1),this.startAnimation(x)}else d||Xu(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,wt(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(FT),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&em(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Qu);return}this.isUpdating||this.nodes.forEach(OT),this.isUpdating=!1,this.nodes.forEach(jT),this.nodes.forEach(RT),this.nodes.forEach(IT),this.clearAllSnapshots();const a=Be.now();fe.delta=tt(0,1e3/60,a-fe.timestamp),fe.timestamp=a,fe.isProcessing=!0,Vr.update.process(fe),Vr.preRender.process(fe),Vr.render.process(fe),fe.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,qa.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(DT),this.sharedNodes.forEach($T)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Q.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Q.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ie(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const l=s(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!Xp(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&(a||At(this.latestValues)||u)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),WT(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return ie();const l=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(HT))){const{scroll:u}=this.root;u&&(dn(l.x,u.offset.x),dn(l.y,u.offset.y))}return l}removeElementScroll(o){var a;const l=ie();if(Pe(l,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return l;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:h,options:d}=u;u!==this.root&&h&&d.layoutScroll&&(h.wasRoot&&Pe(l,o),dn(l.x,h.offset.x),dn(l.y,h.offset.y))}return l}applyTransform(o,a=!1){const l=ie();Pe(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&fn(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),At(u.latestValues)&&fn(l,u.latestValues)}return At(this.latestValues)&&fn(l,this.latestValues),l}removeTransform(o){const a=ie();Pe(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!At(c.latestValues))continue;qo(c.latestValues)&&c.updateSnapshot();const u=ie(),h=c.measurePageBox();Pe(u,h),Hu(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return At(this.latestValues)&&Hu(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==fe.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:d}=this.options;if(!(!this.layout||!(h||d))){if(this.resolvedRelativeTargetAt=fe.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ie(),this.relativeTargetOrigin=ie(),ds(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),Pe(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=ie(),this.targetWithTransforms=ie()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),zC(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Pe(this.target,this.layout.layoutBox),qp(this.target,this.targetDelta)):Pe(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ie(),this.relativeTargetOrigin=ie(),ds(this.relativeTargetOrigin,this.target,f.target),Pe(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}ts&&Nt.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||qo(this.parent.latestValues)||Gp(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===fe.timestamp&&(c=!1),c)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;Pe(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,f=this.treeScale.y;nT(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=ie());const{target:p}=a;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Vu(this.prevProjectionDelta.x,this.projectionDelta.x),Vu(this.prevProjectionDelta.y,this.projectionDelta.y)),hs(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==f||!Yu(this.projectionDelta.x,this.prevProjectionDelta.x)||!Yu(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p)),ts&&Nt.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=hn(),this.projectionDelta=hn(),this.projectionDeltaWithTransform=hn()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},h=hn();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const d=ie(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,m=f!==p,_=this.getStack(),v=!_||_.members.length<=1,b=!!(m&&!v&&this.options.crossfade===!0&&!this.path.some(VT));this.animationProgress=0;let w;this.mixTargetDelta=x=>{const E=x/1e3;Zu(h.x,o.x,E),Zu(h.y,o.y,E),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ds(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),BT(this.relativeTarget,this.relativeTargetOrigin,d,E),w&&ET(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=ie()),Pe(w,this.relativeTarget)),m&&(this.animationValues=u,_T(u,c,this.latestValues,E,b,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=E},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(wt(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Q.update(()=>{ci.hasAnimatedSinceResize=!0,this.currentAnimation=dT(0,Ju,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Ju),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&nm(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||ie();const h=Ce(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+h;const d=Ce(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+d}Pe(a,l),fn(a,u),hs(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new CT),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&Jr("z",o,c,this.animationValues);for(let u=0;u<Yr.length;u++)Jr(`rotate${Yr[u]}`,o,c,this.animationValues),Jr(`skew${Yr[u]}`,o,c,this.animationValues);o.render();for(const u in c)o.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return PT;const c={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=ai(o==null?void 0:o.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=ai(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!At(this.latestValues)&&(m.transform=u?u({},""):"none",this.hasProjected=!1),m}const d=h.animationValues||h.latestValues;this.applyTransformsToTarget(),c.transform=TT(this.projectionDeltaWithTransform,this.treeScale,d),u&&(c.transform=u(d,c.transform));const{x:f,y:p}=this.projectionDelta;c.transformOrigin=`${f.origin*100}% ${p.origin*100}% 0`,h.animationValues?c.opacity=h===this?(l=(a=d.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:c.opacity=h===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const m in Oi){if(d[m]===void 0)continue;const{correct:_,applyTo:v}=Oi[m],b=c.transform==="none"?d[m]:_(d[m],h);if(v){const w=v.length;for(let x=0;x<w;x++)c[v[x]]=b}else c[m]=b}return this.options.layoutId&&(c.pointerEvents=h===this?ai(o==null?void 0:o.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(Qu),this.root.sharedNodes.clear()}}}function RT(t){t.updateLayout()}function IT(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:i}=t.layout,{animationType:r}=t.options,o=n.source!==t.layout.source;r==="size"?ke(h=>{const d=o?n.measuredBox[h]:n.layoutBox[h],f=Ce(d);d.min=s[h].min,d.max=d.min+f}):nm(r,n.layoutBox,s)&&ke(h=>{const d=o?n.measuredBox[h]:n.layoutBox[h],f=Ce(s[h]);d.max=d.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+f)});const a=hn();hs(a,s,n.layoutBox);const l=hn();o?hs(l,t.applyTransform(i,!0),n.measuredBox):hs(l,s,n.layoutBox);const c=!Xp(a);let u=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:d,layout:f}=h;if(d&&f){const p=ie();ds(p,n.layoutBox,d.layoutBox);const m=ie();ds(m,s,f.layoutBox),Zp(p,m)||(u=!0),h.options.layoutRoot&&(t.relativeTarget=m,t.relativeTargetOrigin=p,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:s,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(t.isLead()){const{onExitComplete:s}=t.options;s&&s()}t.options.transition=void 0}function AT(t){ts&&Nt.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function NT(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function DT(t){t.clearSnapshot()}function Qu(t){t.clearMeasurements()}function OT(t){t.isLayoutDirty=!1}function jT(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function Xu(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function MT(t){t.resolveTargetDelta()}function LT(t){t.calcProjection()}function FT(t){t.resetSkewAndRotation()}function $T(t){t.removeLeadSnapshot()}function Zu(t,e,n){t.translate=Z(e.translate,0,n),t.scale=Z(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function eh(t,e,n,s){t.min=Z(e.min,n.min,s),t.max=Z(e.max,n.max,s)}function BT(t,e,n,s){eh(t.x,e.x,n.x,s),eh(t.y,e.y,n.y,s)}function VT(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const UT={duration:.45,ease:[.4,0,.1,1]},th=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),nh=th("applewebkit/")&&!th("chrome/")?Math.round:Ee;function sh(t){t.min=nh(t.min),t.max=nh(t.max)}function WT(t){sh(t.x),sh(t.y)}function nm(t,e,n){return t==="position"||t==="preserve-aspect"&&!qC(Ku(e),Ku(n),.2)}function HT(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const GT=tm({attachResizeListener:(t,e)=>Is(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Qr={current:void 0},sm=tm({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Qr.current){const t=new GT({});t.mount(window),t.setOptions({layoutScroll:!0}),Qr.current=t}return Qr.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),qT={pan:{Feature:lT},drag:{Feature:aT,ProjectionNode:sm,MeasureLayout:Yp}};function ih(t,e,n){const{props:s}=t;t.animationState&&s.whileHover&&t.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,r=s[i];r&&Q.postRender(()=>r(e,Gs(e)))}class zT extends Et{mount(){const{current:e}=this.node;e&&(this.unmount=qS(e,n=>(ih(this.node,n,"Start"),s=>ih(this.node,s,"End"))))}unmount(){}}class KT extends Et{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Hs(Is(this.node.current,"focus",()=>this.onFocus()),Is(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function rh(t,e,n){const{props:s}=t;t.animationState&&s.whileTap&&t.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),r=s[i];r&&Q.postRender(()=>r(e,Gs(e)))}class YT extends Et{mount(){const{current:e}=this.node;e&&(this.unmount=JS(e,n=>(rh(this.node,n,"Start"),(s,{success:i})=>rh(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Ko=new WeakMap,Xr=new WeakMap,JT=t=>{const e=Ko.get(t.target);e&&e(t)},QT=t=>{t.forEach(JT)};function XT({root:t,...e}){const n=t||document;Xr.has(n)||Xr.set(n,{});const s=Xr.get(n),i=JSON.stringify(e);return s[i]||(s[i]=new IntersectionObserver(QT,{root:t,...e})),s[i]}function ZT(t,e,n){const s=XT(e);return Ko.set(t,n),s.observe(t),()=>{Ko.delete(t),s.unobserve(t)}}const eP={some:0,all:1};class tP extends Et{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:s,amount:i="some",once:r}=e,o={root:n?n.current:void 0,rootMargin:s,threshold:typeof i=="number"?i:eP[i]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,r&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),d=c?u:h;d&&d(l)};return ZT(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(nP(e,n))&&this.startObserver()}unmount(){}}function nP({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const sP={inView:{Feature:tP},tap:{Feature:YT},focus:{Feature:KT},hover:{Feature:zT}},iP={layout:{ProjectionNode:sm,MeasureLayout:Yp}},Yo={current:null},im={current:!1};function rP(){if(im.current=!0,!!Va)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Yo.current=t.matches;t.addListener(e),e()}else Yo.current=!1}const oP=[...Rp,me,bt],aP=t=>oP.find(kp(t)),oh=new WeakMap;function lP(t,e,n){for(const s in e){const i=e[s],r=n[s];if(ge(i))t.addValue(s,i);else if(ge(r))t.addValue(s,ks(i,{owner:t}));else if(r!==i)if(t.hasValue(s)){const o=t.getValue(s);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=t.getStaticValue(s);t.addValue(s,ks(o!==void 0?o:i,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const ah=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class cP{scrapeMotionValuesFromProps(e,n,s){return{}}constructor({parent:e,props:n,presenceContext:s,reducedMotionConfig:i,blockInitialAnimation:r,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=pl,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=Be.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,Q.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:u}=o;this.onUpdate=u,this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.blockInitialAnimation=!!r,this.isControllingVariants=dr(n),this.isVariantNode=Lf(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const f in d){const p=d[f];l[f]!==void 0&&ge(p)&&p.set(l[f],!1)}}mount(e){this.current=e,oh.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),im.current||rP(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Yo.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){oh.delete(this.current),this.projection&&this.projection.unmount(),wt(this.notifyUpdate),wt(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const s=Gt.has(e),i=n.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&Q.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),r=n.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{i(),r(),o&&o(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in kn){const n=kn[e];if(!n)continue;const{isEnabled:s,Feature:i}=n;if(!this.features[e]&&i&&s(this.props)&&(this.features[e]=new i(this)),this.features[e]){const r=this.features[e];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ie()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<ah.length;s++){const i=ah[s];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const r="on"+i,o=e[r];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=lP(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const s=this.values.get(e);n!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&n!==void 0&&(s=ks(n===null?void 0:n,{owner:this}),this.addValue(e,s)),s}readValue(e,n){var s;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(s=this.getBaseTargetFromProps(this.props,e))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(Tp(i)||yp(i))?i=parseFloat(i):!aP(i)&&bt.test(n)&&(i=Sp(e,n)),this.setBaseTarget(e,ge(i)?i.get():i)),ge(i)?i.get():i}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:s}=this.props;let i;if(typeof s=="string"||typeof s=="object"){const o=Ka(this.props,s,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);o&&(i=o[e])}if(s&&i!==void 0)return i;const r=this.getBaseTargetFromProps(this.props,e);return r!==void 0&&!ge(r)?r:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new ll),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class rm extends cP{constructor(){super(...arguments),this.KeyframeResolver=Ip}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:s}){delete n[e],delete s[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ge(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function uP(t){return window.getComputedStyle(t)}class hP extends rm{constructor(){super(...arguments),this.type="html",this.renderInstance=qf}readValueFromInstance(e,n){if(Gt.has(n)){const s=fl(n);return s&&s.default||0}else{const s=uP(e),i=(Wf(n)?s.getPropertyValue(n):s[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return zp(e,n)}build(e,n,s){Qa(e,n,s.transformTemplate)}scrapeMotionValuesFromProps(e,n,s){return tl(e,n,s)}}class dP extends rm{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ie}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Gt.has(n)){const s=fl(n);return s&&s.default||0}return n=zf.has(n)?n:Ga(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,s){return Jf(e,n,s)}build(e,n,s){Xa(e,n,this.isSVGTag,s.transformTemplate)}renderInstance(e,n,s,i){Kf(e,n,s,i)}mount(e){this.isSVGTag=el(e.tagName),super.mount(e)}}const fP=(t,e)=>za(t)?new dP(e):new hP(e,{allowProjection:t!==y.Fragment}),pP=$S({...LC,...sP,...qT,...iP},fP),Jo=eS(pP),lh=["GAMES","QUEST","MAGIC","BRAVE","STORM","PLANT","DANCE","MUSIC","HEART","LIGHT","DREAM","SPACE","OCEAN","MOUNT","TIGER","PEACE"],ch=({onGameEnd:t,isHost:e,sendGameState:n})=>{const[s,i]=y.useState(""),[r,o]=y.useState({word:"",guesses:[],currentPlayer:"host",winner:null,gamePhase:"waiting",maxGuesses:6,timeLeft:30});y.useEffect(()=>{if(e&&r.gamePhase==="waiting"){const f=lh[Math.floor(Math.random()*lh.length)],p={...r,word:f,currentPlayer:"host",gamePhase:"playing",timeLeft:30};o(p),n({type:"wordduel",data:p})}},[e]),y.useEffect(()=>{const f=p=>{const m=p.detail;m.type==="wordduel"&&(o(m.data),m.data.winner&&m.data.winner!=="draw"?setTimeout(()=>t(m.data.winner),1500):m.data.winner==="draw"&&setTimeout(()=>t(null),1500))};return window.addEventListener("game_state",f),()=>{window.removeEventListener("game_state",f)}},[t]),y.useEffect(()=>{let f;const p=e?"host":"guest";return r.gamePhase==="playing"&&r.currentPlayer===p&&r.timeLeft>0&&(f=setInterval(()=>{o(m=>{const _=m.timeLeft-1;if(_<=0){const v={...m,currentPlayer:m.currentPlayer==="host"?"guest":"host",timeLeft:30};return n({type:"wordduel",data:v}),v}return{...m,timeLeft:_}})},1e3)),()=>clearInterval(f)},[r.gamePhase,r.currentPlayer,e,n]);const a=(f,p)=>{const m=[],_=p.split(""),v=f.split("");for(let b=0;b<v.length;b++)v[b]===_[b]&&(m[b]="correct",_[b]="",v[b]="");for(let b=0;b<v.length;b++)if(v[b]&&_.includes(v[b])){m[b]="present";const w=_.indexOf(v[b]);_[w]=""}else v[b]&&(m[b]="absent");return m},l=()=>{const f=e?"host":"guest";if(s.length!==5||r.currentPlayer!==f)return;const p=a(s.toUpperCase(),r.word),m=p.every(b=>b==="correct"),_={word:s.toUpperCase(),feedback:p,player:f},v={...r,guesses:[...r.guesses,_],winner:m?f:null,gamePhase:m?"finished":r.gamePhase,currentPlayer:m?r.currentPlayer:r.currentPlayer==="host"?"guest":"host",timeLeft:30};v.guesses.length>=r.maxGuesses&&!m&&(v.gamePhase="finished",v.winner="draw"),o(v),n({type:"wordduel",data:v}),i("")},c=f=>{f.key==="Enter"&&l()},u=f=>{switch(f){case"correct":return"bg-green-500";case"present":return"bg-yellow-500";case"absent":return"bg-gray-500";default:return"bg-gray-700"}},h=e?"host":"guest",d=r.currentPlayer===h;return g.jsxs("div",{className:"max-w-2xl mx-auto p-6 bg-slate-800 rounded-xl",children:[g.jsxs("div",{className:"text-center mb-6",children:[g.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Word Duel"}),g.jsx("p",{className:"text-gray-400",children:"Guess the 5-letter word before your opponent!"})]}),g.jsxs("div",{className:"flex justify-between items-center mb-6 p-4 bg-slate-700 rounded-lg",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(wh,{className:"w-5 h-5 text-blue-400"}),g.jsx("span",{className:"text-white",children:d?"Your Turn":"Opponent's Turn"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Fm,{className:"w-5 h-5 text-yellow-400"}),g.jsxs("span",{className:"text-white font-mono",children:[r.timeLeft,"s"]})]})]}),g.jsxs("div",{className:"mb-6 space-y-2",children:[r.guesses.map((f,p)=>g.jsxs(Jo.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex gap-1 justify-center",children:[f.word.split("").map((m,_)=>g.jsx("div",{className:`w-12 h-12 flex items-center justify-center text-white font-bold text-lg rounded ${u(f.feedback[_])}`,children:m},_)),g.jsx("div",{className:"ml-2 flex items-center",children:g.jsx("span",{className:"text-xs text-gray-400",children:f.player===h?"You":"Opponent"})})]},p)),Array.from({length:r.maxGuesses-r.guesses.length}).map((f,p)=>g.jsx("div",{className:"flex gap-1 justify-center",children:Array.from({length:5}).map((m,_)=>g.jsx("div",{className:"w-12 h-12 border-2 border-gray-600 rounded"},_))},`empty-${p}`))]}),r.gamePhase==="playing"&&d&&g.jsx("div",{className:"mb-6",children:g.jsxs("div",{className:"flex gap-2",children:[g.jsx("input",{type:"text",value:s,onChange:f=>i(f.target.value.slice(0,5).toUpperCase()),onKeyPress:c,className:"flex-1 px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white text-center text-lg font-mono tracking-widest",placeholder:"GUESS",maxLength:5}),g.jsxs("button",{onClick:l,disabled:s.length!==5,className:"px-6 py-3 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[g.jsx(bh,{className:"w-4 h-4"}),"Submit"]})]})}),r.gamePhase==="finished"&&g.jsxs(Jo.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center p-6 bg-slate-700 rounded-lg",children:[g.jsx(xh,{className:"w-12 h-12 mx-auto mb-4 text-yellow-400"}),g.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:r.winner===h?"You Won!":r.winner==="draw"?"It's a Draw!":"You Lost!"}),g.jsxs("p",{className:"text-gray-400 mb-4",children:["The word was: ",g.jsx("span",{className:"text-white font-bold",children:r.word})]})]})]})};function uh(t,e){const n=y.useRef(t);y.useEffect(()=>{n.current=t},[t]),y.useEffect(()=>{if(e===null)return;const s=setInterval(()=>n.current(),e);return()=>clearInterval(s)},[e])}const nn=600,sn=800,hh=({onGameEnd:t,isHost:e,sendGameState:n})=>{const s=y.useRef(null),[i,r]=y.useState({player:{x:nn/2,y:e?sn-50:50,width:40,height:40,speed:5},opponent:{x:nn/2,y:e?50:sn-50,width:40,height:40},bullets:[],enemies:[],score:0}),[o,a]=y.useState({});return y.useEffect(()=>{const l=u=>{a(h=>({...h,[u.key]:!0}))},c=u=>{a(h=>({...h,[u.key]:!1}))};return window.addEventListener("keydown",l),window.addEventListener("keyup",c),()=>{window.removeEventListener("keydown",l),window.removeEventListener("keyup",c)}},[]),uh(()=>{if(e&&Math.random()<.05){const l={x:Math.random()*(nn-30),y:0,width:30,height:30,speed:2};r(c=>({...c,enemies:[...c.enemies,l]}))}},1e3),uh(()=>{const l=s.current;if(!l)return;const c={...i};if(o.ArrowLeft&&c.player.x>0&&(c.player.x-=c.player.speed),o.ArrowRight&&c.player.x<nn-c.player.width&&(c.player.x+=c.player.speed),o[" "]&&i.bullets.length<5){const h={x:c.player.x+c.player.width/2-2,y:e?c.player.y-10:c.player.y+c.player.height,width:4,height:10,speed:7};c.bullets=[...c.bullets,h]}c.bullets=c.bullets.map(h=>({...h,y:e?h.y-h.speed:h.y+h.speed})).filter(h=>h.y>0&&h.y<sn),e&&(c.enemies=c.enemies.map(h=>({...h,y:h.y+h.speed})).filter(h=>h.y>sn?(t(null),!1):!0),c.enemies=c.enemies.filter(h=>!c.bullets.some(f=>{const p=dh(f,h);return p&&(c.score+=10),p})),c.bullets=c.bullets.filter(h=>!c.enemies.some(d=>dh(h,d)))),r(c),n({type:"spaceshooter",data:c});const u=l.getContext("2d");u&&(u.fillStyle="#000",u.fillRect(0,0,nn,sn),u.fillStyle="#00ff00",u.fillRect(c.player.x,c.player.y,c.player.width,c.player.height),u.fillStyle="#ff0000",u.fillRect(c.opponent.x,c.opponent.y,c.opponent.width,c.opponent.height),u.fillStyle="#fff",c.bullets.forEach(h=>{u.fillRect(h.x,h.y,h.width,h.height)}),u.fillStyle="#ff00ff",c.enemies.forEach(h=>{u.fillRect(h.x,h.y,h.width,h.height)}))},1e3/60),g.jsxs("div",{className:"flex flex-col items-center",children:[g.jsx("div",{className:"mb-4",children:g.jsxs("span",{className:"text-xl font-bold",children:["Score: ",i.score]})}),g.jsx("canvas",{ref:s,width:nn,height:sn,className:"border border-gray-700 rounded-lg"}),g.jsx("div",{className:"mt-4 text-sm text-gray-400",children:"Use   to move, SPACE to shoot"})]})};function dh(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}const ii=2e3;function mP(){const[t,e]=y.useState(""),[n,s]=y.useState(!1),[i,r]=y.useState(!1),[o,a]=y.useState(!1),[l,c]=y.useState(null),[u,h]=y.useState(!1),[d,f]=y.useState([]),[p,m]=y.useState(!1),[_,v]=y.useState(0),b=y.useRef(Math.random().toString(36).substring(7)),w=y.useRef(0),x=y.useRef(null),E=y.useRef(null),k=y.useRef(null);y.useEffect(()=>{const I=re(oe,".info/connected");ln(I,L=>{const H=L.val()===!0;r(H),a(!H),c(H?null:"Connecting to game server...")});const N=re(oe,`presence/${b.current}`);Dt(N,!0),Qn(N).remove();const W=re(oe,"presence");return ln(W,L=>{const H=L.exists()?Object.keys(L.val()).length:0;v(H)}),()=>{ct(I),ct(W),ot(N)}},[]),y.useEffect(()=>()=>{k.current&&ot(k.current),x.current&&ct(x.current),E.current&&ct(E.current)},[]);const M=y.useCallback(async I=>{if(!u){h(!0),m(!1),f([]),w.current=Date.now();try{const N=re(oe,`matchmaking/${I}`),W=await Fw(N);if(W.exists()){const yr=W.val(),Em=Object.keys(yr);for(const _r of Em)if(yr[_r].playerId!==b.current){const vr=yr[_r].gameId;await ot(re(oe,`matchmaking/${I}/${_r}`));const Cm=re(oe,`games/${vr}`);await Lw(Cm,{guest:b.current,status:"playing"}),s(!1),e(vr);const Cl=Date.now()-w.current;Cl<ii&&await new Promise(Tm=>setTimeout(Tm,ii-Cl)),h(!1),D(vr);return}}const L=Ar(re(oe,"games")),H=L.key,ye={host:b.current,guest:null,gameType:I,state:{},status:"waiting",createdAt:Date.now()};await Dt(L,ye);const Te=Ar(re(oe,`matchmaking/${I}`));k.current=Te,await Dt(Te,{playerId:b.current,gameId:H,createdAt:Date.now()}),Qn(Te).remove(),Qn(L).remove(),s(!0),e(H),D(H)}catch(N){console.error("Error creating game:",N),c("Failed to create game"),h(!1)}}},[u]),D=y.useCallback(I=>{x.current=re(oe,`games/${I}`),ln(x.current,W=>{if(!W.exists()){m(!0),h(!1);return}const L=W.val();if(L.status==="playing"&&L.guest){k.current&&(ot(k.current),k.current=null);const H=Date.now()-w.current;H<ii?setTimeout(()=>{h(!1)},ii-H):h(!1)}L.state&&Object.keys(L.state).length>0&&window.dispatchEvent(new CustomEvent("game_state",{detail:L.state}))}),E.current=re(oe,`chats/${I}`),ln(E.current,W=>{if(!W.exists())return;const L=W.val(),H=Object.values(L).map(ye=>({sender:ye.sender,message:ye.message,isMe:ye.sender===b.current,timestamp:ye.timestamp}));H.sort((ye,Te)=>(ye.timestamp||0)-(Te.timestamp||0)),f(H)});const N=re(oe,`games/${I}/disconnected`);Qn(N).set(b.current)},[]),P=y.useCallback(I=>{if(!t)return;const N=re(oe,`games/${t}/state`);Dt(N,I)},[t]),R=y.useCallback(I=>{if(!t)return;const N=Ar(re(oe,`chats/${t}`));Dt(N,{sender:b.current,message:I,timestamp:Date.now()})},[t]),S=y.useCallback(I=>{console.log("Friend request for game:",I)},[]),T=y.useCallback(async()=>{t&&(await ot(re(oe,`games/${t}`)),await ot(re(oe,`chats/${t}`))),k.current&&(await ot(k.current),k.current=null),x.current&&(ct(x.current),x.current=null),E.current&&(ct(E.current),E.current=null),e(""),h(!1),f([]),m(!1)},[t]),A=y.useCallback(()=>{c(null)},[]);return{gameId:t,isHost:n,isConnected:i,isOffline:o,lastError:l,isMatchmaking:u,messages:d,opponentLeft:p,onlinePlayers:_,playerId:b.current,createGame:M,sendGameState:P,sendChat:R,sendFriendRequest:S,leaveGame:T,reconnect:A}}const gP=["Hello! ","Good game! ","Nice move! ","Well played! ","Good luck! ","Thanks for the game! "];function yP({onSendMessage:t,messages:e}){const[n,s]=y.useState(!1),[i,r]=y.useState(""),o=y.useRef(null),a=y.useRef(null),l=()=>{var h;(h=o.current)==null||h.scrollIntoView({behavior:"smooth"})};y.useEffect(()=>{l()},[e]);const c=()=>{var h;i.trim()&&(t(i.trim()),r(""),(h=a.current)==null||h.focus())},u=h=>{h.key==="Enter"&&!h.shiftKey&&(h.preventDefault(),c())};return g.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:n?g.jsxs("div",{className:"bg-white bg-opacity-10 backdrop-blur-lg rounded-xl w-80 shadow-lg",children:[g.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-white border-opacity-10",children:[g.jsx("h3",{className:"font-semibold",children:"Chat"}),g.jsx("button",{onClick:()=>s(!1),className:"text-gray-400 hover:text-white transition",children:""})]}),g.jsxs("div",{className:"h-64 overflow-y-auto p-4 space-y-2",children:[e.map((h,d)=>g.jsx("div",{className:`flex ${h.isMe?"justify-end":"justify-start"}`,children:g.jsx("div",{className:`rounded-lg px-3 py-2 max-w-[80%] ${h.isMe?"bg-pink-500 text-white":"bg-white bg-opacity-5 text-gray-200"}`,children:h.message})},d)),g.jsx("div",{ref:o})]}),g.jsxs("div",{className:"p-4 border-t border-white border-opacity-10",children:[g.jsxs("div",{className:"flex gap-2 mb-4",children:[g.jsx("input",{ref:a,type:"text",value:i,onChange:h=>r(h.target.value),onKeyPress:u,placeholder:"Type a message...",className:"flex-1 bg-white bg-opacity-5 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-pink-500"}),g.jsx("button",{onClick:c,disabled:!i.trim(),className:"p-2 bg-pink-500 rounded-lg hover:bg-pink-600 transition disabled:opacity-50 disabled:cursor-not-allowed",children:g.jsx(bh,{className:"w-5 h-5"})})]}),g.jsx("div",{className:"grid grid-cols-2 gap-2",children:gP.map(h=>g.jsx("button",{onClick:()=>{var d;t(h),(d=a.current)==null||d.focus()},className:"text-sm px-3 py-1.5 bg-white bg-opacity-5 rounded hover:bg-opacity-10 transition text-left truncate",children:h},h))})]})]}):g.jsx("button",{onClick:()=>s(!0),className:"bg-white bg-opacity-10 backdrop-blur-lg p-3 rounded-full hover:bg-opacity-20 transition",children:g.jsx(Vi,{className:"w-6 h-6"})})})}function _P({show:t,gameType:e,winner:n,opponentDisconnected:s=!1,onMainMenu:i,onRequeue:r,onFriendRequest:o}){const[a,l]=y.useState(!1),[c,u]=y.useState(!1);if(y.useEffect(()=>{t&&!s&&l(!0)},[t,s]),!t)return null;const h=e?{checkers:"Checkers",tictactoe:"Tic Tac Toe",spaceshooter:"Space Shooter",battleships:"Battleships",snake:"Snake Battle",cooppong:"Coop Pong",wordduel:"Word Duel"}[e]:"this game";return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:g.jsxs("div",{className:"bg-white bg-opacity-10 backdrop-blur-lg rounded-xl p-6 max-w-md w-full",children:[s?g.jsxs(g.Fragment,{children:[g.jsx("h2",{className:"text-2xl font-bold mb-4 text-red-400",children:"Your opponent has left!"}),g.jsx("p",{className:"text-gray-300 mb-6",children:"Would you like to return to the main menu or find a new opponent?"})]}):g.jsxs(g.Fragment,{children:[g.jsx("h2",{className:"text-2xl font-bold mb-4",children:n?`${n} Wins!`:"It's a Draw!"}),a&&!c&&g.jsxs("div",{className:"mb-6",children:[g.jsx("p",{className:"text-gray-300 mb-4",children:"Would you like to add your opponent as a friend?"}),g.jsxs("button",{onClick:()=>{u(!0),o()},className:"w-full px-4 py-3 bg-gradient-to-r from-pink-500 to-violet-500 rounded-lg hover:opacity-90 transition flex items-center justify-center gap-2",children:[g.jsx($m,{size:20}),"Send Friend Request"]})]}),c&&g.jsx("p",{className:"text-green-400 mb-6",children:"Friend request sent! They'll need to accept it too."})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsxs("button",{onClick:i,className:"px-4 py-3 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition flex items-center justify-center gap-2",children:[g.jsx(Bm,{size:20}),"Main Menu"]}),g.jsxs("button",{onClick:r,className:"px-4 py-3 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition flex items-center justify-center gap-2",children:[g.jsx(Sh,{size:20}),"Play ",h," Again"]})]})]})})}function om({onGameEnd:t=()=>{}}){const[e,n]=y.useState(null),[s,i]=y.useState(!1),[r,o]=y.useState(null),[a,l]=y.useState(!1),{isHost:c,gameId:u,isConnected:h,isOffline:d,lastError:f,isMatchmaking:p,createGame:m,sendGameState:_,sendChat:v,sendFriendRequest:b,messages:w,reconnect:x}=mP(),E=N=>{o(N),i(!0)},k=()=>{n(null),i(!1),l(!1),o(null),t()},M=()=>{i(!1),l(!1),o(null),e&&m(e)},D=()=>{u&&b(u)},P=()=>{x()},R=N=>{n(N),(h||d)&&!p&&!u&&N&&m(N)},S=()=>g.jsxs("div",{className:"flex flex-col items-center justify-center p-8",role:"alert",children:[g.jsx("div",{className:"w-16 h-16 mb-6 text-red-500",children:g.jsx(Um,{className:"w-16 h-16","aria-hidden":"true"})}),g.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Connection Error"}),f&&g.jsx("p",{className:"text-gray-400 mb-4 text-center",children:f}),!d&&g.jsxs("button",{onClick:P,className:"px-6 py-3 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition flex items-center gap-2",children:[g.jsx(Sh,{className:"w-5 h-5","aria-hidden":"true"}),"Retry Connection"]})]}),T=()=>{if(!d&&!h&&f)return S();if(!e)return I();if(!d&&(!u||p))return A();const N={onGameEnd:E,isHost:c,sendGameState:_,gameId:u,isOffline:d};return g.jsxs(g.Fragment,{children:[e==="battleships"&&g.jsx(Uc,{...N}),e==="tictactoe"&&g.jsx(Vc,{...N}),e==="checkers"&&g.jsx(Wc,{...N}),e==="snake"&&g.jsx(Hc,{...N}),e==="cooppong"&&g.jsx(qc,{...N}),e==="wordduel"&&g.jsx(ch,{...N}),e==="spaceshooter"&&g.jsx(hh,{...N}),!d&&g.jsx(yP,{onSendMessage:v,messages:w}),g.jsx(_P,{show:s,gameType:e,winner:r,opponentDisconnected:a,onMainMenu:k,onRequeue:M,onFriendRequest:D})]})},A=()=>g.jsxs("div",{className:"flex flex-col items-center justify-center p-8",role:"status",children:[g.jsx("div",{className:"w-16 h-16 mb-6",children:g.jsx(Vm,{className:"w-16 h-16 text-pink-500 animate-spin","aria-hidden":"true"})}),g.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Finding Opponent..."}),g.jsx("p",{className:"text-gray-400",children:"This won't take long"}),g.jsx("button",{onClick:()=>n(null),className:"mt-6 px-4 py-2 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition",children:"Cancel"})]}),I=()=>{const N=[{id:"wordduel",name:"Word Duel",component:ch,description:"Guess the hidden word first",icon:"",players:"2 Players"},{id:"tictactoe",name:"Tic Tac Toe",component:Vc,description:"Classic 3x3 grid game",icon:"",players:"2 Players"},{id:"battleships",name:"Battleships",component:Uc,description:"Sink your opponent's fleet",icon:"",players:"2 Players"},{id:"checkers",name:"Checkers",component:Wc,description:"Strategic board game",icon:"",players:"2 Players"},{id:"snake",name:"Snake Battle",component:Hc,description:"Competitive snake game",icon:"",players:"2 Players"},{id:"spaceshooter",name:"Space Shooter",component:hh,description:"Defend against aliens",icon:"",players:"1-2 Players"},{id:"cooppong",name:"Coop Pong",component:qc,description:"Work together in Pong",icon:"",players:"2 Players"}];return g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",role:"menu",children:N.map(W=>g.jsx("button",{onClick:()=>R(W.id),className:"p-6 bg-white bg-opacity-5 rounded-xl hover:bg-opacity-10 transition group",role:"menuitem","aria-label":`Play ${W.name}`,children:g.jsxs("div",{className:"flex flex-col items-center",children:[g.jsx("div",{className:"w-16 h-16 rounded-lg flex items-center justify-center mb-4 group-hover:scale-110 transition",style:{backgroundColor:"rgba(255,255,255,0.1)"},children:W.icon}),g.jsx("h3",{className:"text-xl font-bold text-white",children:W.name}),g.jsx("p",{className:"text-gray-400 text-sm mt-2",children:W.description})]})},W.id))})};return g.jsx("div",{className:"bg-white bg-opacity-10 backdrop-blur-lg rounded-xl p-8 relative",children:T()})}var _l={};Object.defineProperty(_l,"__esModule",{value:!0});_l.parse=CP;_l.serialize=TP;const vP=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,wP=/^[\u0021-\u003A\u003C-\u007E]*$/,bP=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,xP=/^[\u0020-\u003A\u003D-\u007E]*$/,SP=Object.prototype.toString,EP=(()=>{const t=function(){};return t.prototype=Object.create(null),t})();function CP(t,e){const n=new EP,s=t.length;if(s<2)return n;const i=(e==null?void 0:e.decode)||PP;let r=0;do{const o=t.indexOf("=",r);if(o===-1)break;const a=t.indexOf(";",r),l=a===-1?s:a;if(o>l){r=t.lastIndexOf(";",o-1)+1;continue}const c=fh(t,r,o),u=ph(t,o,c),h=t.slice(c,u);if(n[h]===void 0){let d=fh(t,o+1,l),f=ph(t,l,d);const p=i(t.slice(d,f));n[h]=p}r=l+1}while(r<s);return n}function fh(t,e,n){do{const s=t.charCodeAt(e);if(s!==32&&s!==9)return e}while(++e<n);return n}function ph(t,e,n){for(;e>n;){const s=t.charCodeAt(--e);if(s!==32&&s!==9)return e+1}return n}function TP(t,e,n){const s=(n==null?void 0:n.encode)||encodeURIComponent;if(!vP.test(t))throw new TypeError(`argument name is invalid: ${t}`);const i=s(e);if(!wP.test(i))throw new TypeError(`argument val is invalid: ${e}`);let r=t+"="+i;if(!n)return r;if(n.maxAge!==void 0){if(!Number.isInteger(n.maxAge))throw new TypeError(`option maxAge is invalid: ${n.maxAge}`);r+="; Max-Age="+n.maxAge}if(n.domain){if(!bP.test(n.domain))throw new TypeError(`option domain is invalid: ${n.domain}`);r+="; Domain="+n.domain}if(n.path){if(!xP.test(n.path))throw new TypeError(`option path is invalid: ${n.path}`);r+="; Path="+n.path}if(n.expires){if(!kP(n.expires)||!Number.isFinite(n.expires.valueOf()))throw new TypeError(`option expires is invalid: ${n.expires}`);r+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(r+="; HttpOnly"),n.secure&&(r+="; Secure"),n.partitioned&&(r+="; Partitioned"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():void 0){case"low":r+="; Priority=Low";break;case"medium":r+="; Priority=Medium";break;case"high":r+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${n.priority}`)}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"none":r+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${n.sameSite}`)}return r}function PP(t){if(t.indexOf("%")===-1)return t;try{return decodeURIComponent(t)}catch{return t}}function kP(t){return SP.call(t)==="[object Date]"}var mh="popstate";function RP(t={}){function e(s,i){let{pathname:r,search:o,hash:a}=s.location;return Qo("",{pathname:r,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){return typeof i=="string"?i:As(i)}return AP(e,n,null,t)}function te(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ve(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function IP(){return Math.random().toString(36).substring(2,10)}function gh(t,e){return{usr:t.state,key:t.key,idx:e}}function Qo(t,e,n=null,s){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?$n(e):e,state:n,key:e&&e.key||s||IP()}}function As({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function $n(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substring(s),t=t.substring(0,s)),t&&(e.pathname=t)}return e}function AP(t,e,n,s={}){let{window:i=document.defaultView,v5Compat:r=!1}=s,o=i.history,a="POP",l=null,c=u();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function u(){return(o.state||{idx:null}).idx}function h(){a="POP";let _=u(),v=_==null?null:_-c;c=_,l&&l({action:a,location:m.location,delta:v})}function d(_,v){a="PUSH";let b=Qo(m.location,_,v);c=u()+1;let w=gh(b,c),x=m.createHref(b);try{o.pushState(w,"",x)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;i.location.assign(x)}r&&l&&l({action:a,location:m.location,delta:1})}function f(_,v){a="REPLACE";let b=Qo(m.location,_,v);c=u();let w=gh(b,c),x=m.createHref(b);o.replaceState(w,"",x),r&&l&&l({action:a,location:m.location,delta:0})}function p(_){let v=i.location.origin!=="null"?i.location.origin:i.location.href,b=typeof _=="string"?_:As(_);return b=b.replace(/ $/,"%20"),te(v,`No window.location.(origin|href) available to create URL for href: ${b}`),new URL(b,v)}let m={get action(){return a},get location(){return t(i,o)},listen(_){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(mh,h),l=_,()=>{i.removeEventListener(mh,h),l=null}},createHref(_){return e(i,_)},createURL:p,encodeLocation(_){let v=p(_);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:d,replace:f,go(_){return o.go(_)}};return m}function am(t,e,n="/"){return NP(t,e,n,!1)}function NP(t,e,n,s){let i=typeof e=="string"?$n(e):e,r=nt(i.pathname||"/",n);if(r==null)return null;let o=lm(t);DP(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=HP(r);a=UP(o[l],c,s)}return a}function lm(t,e=[],n=[],s=""){let i=(r,o,a)=>{let l={relativePath:a===void 0?r.path||"":a,caseSensitive:r.caseSensitive===!0,childrenIndex:o,route:r};l.relativePath.startsWith("/")&&(te(l.relativePath.startsWith(s),`Absolute route path "${l.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(s.length));let c=Xe([s,l.relativePath]),u=n.concat(l);r.children&&r.children.length>0&&(te(r.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),lm(r.children,e,u,c)),!(r.path==null&&!r.index)&&e.push({path:c,score:BP(c,r.index),routesMeta:u})};return t.forEach((r,o)=>{var a;if(r.path===""||!((a=r.path)!=null&&a.includes("?")))i(r,o);else for(let l of cm(r.path))i(r,o,l)}),e}function cm(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,i=n.endsWith("?"),r=n.replace(/\?$/,"");if(s.length===0)return i?[r,""]:[r];let o=cm(s.join("/")),a=[];return a.push(...o.map(l=>l===""?r:[r,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function DP(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:VP(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}var OP=/^:[\w-]+$/,jP=3,MP=2,LP=1,FP=10,$P=-2,yh=t=>t==="*";function BP(t,e){let n=t.split("/"),s=n.length;return n.some(yh)&&(s+=$P),e&&(s+=MP),n.filter(i=>!yh(i)).reduce((i,r)=>i+(OP.test(r)?jP:r===""?LP:FP),s)}function VP(t,e){return t.length===e.length&&t.slice(0,-1).every((s,i)=>s===e[i])?t[t.length-1]-e[e.length-1]:0}function UP(t,e,n=!1){let{routesMeta:s}=t,i={},r="/",o=[];for(let a=0;a<s.length;++a){let l=s[a],c=a===s.length-1,u=r==="/"?e:e.slice(r.length)||"/",h=Bi({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),d=l.route;if(!h&&c&&n&&!s[s.length-1].route.index&&(h=Bi({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!h)return null;Object.assign(i,h.params),o.push({params:i,pathname:Xe([r,h.pathname]),pathnameBase:KP(Xe([r,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(r=Xe([r,h.pathnameBase]))}return o}function Bi(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=WP(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let r=i[0],o=r.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:s.reduce((c,{paramName:u,isOptional:h},d)=>{if(u==="*"){let p=a[d]||"";o=r.slice(0,r.length-p.length).replace(/(.)\/+$/,"$1")}const f=a[d];return h&&!f?c[u]=void 0:c[u]=(f||"").replace(/%2F/g,"/"),c},{}),pathname:r,pathnameBase:o,pattern:t}}function WP(t,e=!1,n=!0){Ve(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let s=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),s]}function HP(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ve(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function nt(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function GP(t,e="/"){let{pathname:n,search:s="",hash:i=""}=typeof t=="string"?$n(t):t;return{pathname:n?n.startsWith("/")?n:qP(n,e):e,search:YP(s),hash:JP(i)}}function qP(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function Zr(t,e,n,s){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function zP(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function um(t){let e=zP(t);return e.map((n,s)=>s===e.length-1?n.pathname:n.pathnameBase)}function hm(t,e,n,s=!1){let i;typeof t=="string"?i=$n(t):(i={...t},te(!i.pathname||!i.pathname.includes("?"),Zr("?","pathname","search",i)),te(!i.pathname||!i.pathname.includes("#"),Zr("#","pathname","hash",i)),te(!i.search||!i.search.includes("#"),Zr("#","search","hash",i)));let r=t===""||i.pathname==="",o=r?"/":i.pathname,a;if(o==null)a=n;else{let h=e.length-1;if(!s&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),h-=1;i.pathname=d.join("/")}a=h>=0?e[h]:"/"}let l=GP(i,a),c=o&&o!=="/"&&o.endsWith("/"),u=(r||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var Xe=t=>t.join("/").replace(/\/\/+/g,"/"),KP=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),YP=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,JP=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function QP(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var dm=["POST","PUT","PATCH","DELETE"];new Set(dm);var XP=["GET",...dm];new Set(XP);var Bn=y.createContext(null);Bn.displayName="DataRouter";var mr=y.createContext(null);mr.displayName="DataRouterState";var fm=y.createContext({isTransitioning:!1});fm.displayName="ViewTransition";var ZP=y.createContext(new Map);ZP.displayName="Fetchers";var ek=y.createContext(null);ek.displayName="Await";var We=y.createContext(null);We.displayName="Navigation";var qs=y.createContext(null);qs.displayName="Location";var it=y.createContext({outlet:null,matches:[],isDataRoute:!1});it.displayName="Route";var vl=y.createContext(null);vl.displayName="RouteError";function tk(t,{relative:e}={}){te(zs(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:s}=y.useContext(We),{hash:i,pathname:r,search:o}=Ks(t,{relative:e}),a=r;return n!=="/"&&(a=r==="/"?n:Xe([n,r])),s.createHref({pathname:a,search:o,hash:i})}function zs(){return y.useContext(qs)!=null}function qt(){return te(zs(),"useLocation() may be used only in the context of a <Router> component."),y.useContext(qs).location}var pm="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function mm(t){y.useContext(We).static||y.useLayoutEffect(t)}function gm(){let{isDataRoute:t}=y.useContext(it);return t?pk():nk()}function nk(){te(zs(),"useNavigate() may be used only in the context of a <Router> component.");let t=y.useContext(Bn),{basename:e,navigator:n}=y.useContext(We),{matches:s}=y.useContext(it),{pathname:i}=qt(),r=JSON.stringify(um(s)),o=y.useRef(!1);return mm(()=>{o.current=!0}),y.useCallback((l,c={})=>{if(Ve(o.current,pm),!o.current)return;if(typeof l=="number"){n.go(l);return}let u=hm(l,JSON.parse(r),i,c.relative==="path");t==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:Xe([e,u.pathname])),(c.replace?n.replace:n.push)(u,c.state,c)},[e,n,r,i,t])}y.createContext(null);function Ks(t,{relative:e}={}){let{matches:n}=y.useContext(it),{pathname:s}=qt(),i=JSON.stringify(um(n));return y.useMemo(()=>hm(t,JSON.parse(i),s,e==="path"),[t,i,s,e])}function sk(t,e){return ym(t,e)}function ym(t,e,n,s){var b;te(zs(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i,static:r}=y.useContext(We),{matches:o}=y.useContext(it),a=o[o.length-1],l=a?a.params:{},c=a?a.pathname:"/",u=a?a.pathnameBase:"/",h=a&&a.route;{let w=h&&h.path||"";_m(c,!h||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let d=qt(),f;if(e){let w=typeof e=="string"?$n(e):e;te(u==="/"||((b=w.pathname)==null?void 0:b.startsWith(u)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${w.pathname}" was given in the \`location\` prop.`),f=w}else f=d;let p=f.pathname||"/",m=p;if(u!=="/"){let w=u.replace(/^\//,"").split("/");m="/"+p.replace(/^\//,"").split("/").slice(w.length).join("/")}let _=!r&&n&&n.matches&&n.matches.length>0?n.matches:am(t,{pathname:m});Ve(h||_!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),Ve(_==null||_[_.length-1].route.element!==void 0||_[_.length-1].route.Component!==void 0||_[_.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let v=lk(_&&_.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:Xe([u,i.encodeLocation?i.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?u:Xe([u,i.encodeLocation?i.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),o,n,s);return e&&v?y.createElement(qs.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},v):v}function ik(){let t=fk(),e=QP(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:s},r={padding:"2px 4px",backgroundColor:s},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=y.createElement(y.Fragment,null,y.createElement("p",null," Hey developer "),y.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",y.createElement("code",{style:r},"ErrorBoundary")," or"," ",y.createElement("code",{style:r},"errorElement")," prop on your route.")),y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},e),n?y.createElement("pre",{style:i},n):null,o)}var rk=y.createElement(ik,null),ok=class extends y.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?y.createElement(it.Provider,{value:this.props.routeContext},y.createElement(vl.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function ak({routeContext:t,match:e,children:n}){let s=y.useContext(Bn);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),y.createElement(it.Provider,{value:t},n)}function lk(t,e=[],n=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,r=n==null?void 0:n.errors;if(r!=null){let l=i.findIndex(c=>c.route.id&&(r==null?void 0:r[c.route.id])!==void 0);te(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(r).join(",")}`),i=i.slice(0,Math.min(i.length,l+1))}let o=!1,a=-1;if(n)for(let l=0;l<i.length;l++){let c=i[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(a=l),c.route.id){let{loaderData:u,errors:h}=n,d=c.route.loader&&!u.hasOwnProperty(c.route.id)&&(!h||h[c.route.id]===void 0);if(c.route.lazy||d){o=!0,a>=0?i=i.slice(0,a+1):i=[i[0]];break}}}return i.reduceRight((l,c,u)=>{let h,d=!1,f=null,p=null;n&&(h=r&&c.route.id?r[c.route.id]:void 0,f=c.route.errorElement||rk,o&&(a<0&&u===0?(_m("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,p=null):a===u&&(d=!0,p=c.route.hydrateFallbackElement||null)));let m=e.concat(i.slice(0,u+1)),_=()=>{let v;return h?v=f:d?v=p:c.route.Component?v=y.createElement(c.route.Component,null):c.route.element?v=c.route.element:v=l,y.createElement(ak,{match:c,routeContext:{outlet:l,matches:m,isDataRoute:n!=null},children:v})};return n&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?y.createElement(ok,{location:n.location,revalidation:n.revalidation,component:f,error:h,children:_(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):_()},null)}function wl(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ck(t){let e=y.useContext(Bn);return te(e,wl(t)),e}function uk(t){let e=y.useContext(mr);return te(e,wl(t)),e}function hk(t){let e=y.useContext(it);return te(e,wl(t)),e}function bl(t){let e=hk(t),n=e.matches[e.matches.length-1];return te(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function dk(){return bl("useRouteId")}function fk(){var s;let t=y.useContext(vl),e=uk("useRouteError"),n=bl("useRouteError");return t!==void 0?t:(s=e.errors)==null?void 0:s[n]}function pk(){let{router:t}=ck("useNavigate"),e=bl("useNavigate"),n=y.useRef(!1);return mm(()=>{n.current=!0}),y.useCallback(async(i,r={})=>{Ve(n.current,pm),n.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...r}))},[t,e])}var _h={};function _m(t,e,n){!e&&!_h[t]&&(_h[t]=!0,Ve(!1,n))}y.memo(mk);function mk({routes:t,future:e,state:n}){return ym(t,void 0,n,e)}function ui(t){te(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function gk({basename:t="/",children:e=null,location:n,navigationType:s="POP",navigator:i,static:r=!1}){te(!zs(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),a=y.useMemo(()=>({basename:o,navigator:i,static:r,future:{}}),[o,i,r]);typeof n=="string"&&(n=$n(n));let{pathname:l="/",search:c="",hash:u="",state:h=null,key:d="default"}=n,f=y.useMemo(()=>{let p=nt(l,o);return p==null?null:{location:{pathname:p,search:c,hash:u,state:h,key:d},navigationType:s}},[o,l,c,u,h,d,s]);return Ve(f!=null,`<Router basename="${o}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),f==null?null:y.createElement(We.Provider,{value:a},y.createElement(qs.Provider,{children:e,value:f}))}function yk({children:t,location:e}){return sk(Xo(t),e)}function Xo(t,e=[]){let n=[];return y.Children.forEach(t,(s,i)=>{if(!y.isValidElement(s))return;let r=[...e,i];if(s.type===y.Fragment){n.push.apply(n,Xo(s.props.children,r));return}te(s.type===ui,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),te(!s.props.index||!s.props.children,"An index route cannot have child routes.");let o={id:s.props.id||r.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=Xo(s.props.children,r)),n.push(o)}),n}var hi="get",di="application/x-www-form-urlencoded";function gr(t){return t!=null&&typeof t.tagName=="string"}function _k(t){return gr(t)&&t.tagName.toLowerCase()==="button"}function vk(t){return gr(t)&&t.tagName.toLowerCase()==="form"}function wk(t){return gr(t)&&t.tagName.toLowerCase()==="input"}function bk(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function xk(t,e){return t.button===0&&(!e||e==="_self")&&!bk(t)}var ri=null;function Sk(){if(ri===null)try{new FormData(document.createElement("form"),0),ri=!1}catch{ri=!0}return ri}var Ek=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function eo(t){return t!=null&&!Ek.has(t)?(Ve(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${di}"`),null):t}function Ck(t,e){let n,s,i,r,o;if(vk(t)){let a=t.getAttribute("action");s=a?nt(a,e):null,n=t.getAttribute("method")||hi,i=eo(t.getAttribute("enctype"))||di,r=new FormData(t)}else if(_k(t)||wk(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(s=l?nt(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||hi,i=eo(t.getAttribute("formenctype"))||eo(a.getAttribute("enctype"))||di,r=new FormData(a,t),!Sk()){let{name:c,type:u,value:h}=t;if(u==="image"){let d=c?`${c}.`:"";r.append(`${d}x`,"0"),r.append(`${d}y`,"0")}else c&&r.append(c,h)}}else{if(gr(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=hi,s=null,i=di,o=t}return r&&i==="text/plain"&&(o=r,r=void 0),{action:s,method:n.toLowerCase(),encType:i,formData:r,body:o}}function xl(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function Tk(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Pk(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function kk(t,e,n){let s=await Promise.all(t.map(async i=>{let r=e.routes[i.route.id];if(r){let o=await Tk(r,n);return o.links?o.links():[]}return[]}));return Nk(s.flat(1).filter(Pk).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function vh(t,e,n,s,i,r){let o=(l,c)=>n[c]?l.route.id!==n[c].route.id:!0,a=(l,c)=>{var u;return n[c].pathname!==l.pathname||((u=n[c].route.path)==null?void 0:u.endsWith("*"))&&n[c].params["*"]!==l.params["*"]};return r==="assets"?e.filter((l,c)=>o(l,c)||a(l,c)):r==="data"?e.filter((l,c)=>{var h;let u=s.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(o(l,c)||a(l,c))return!0;if(l.route.shouldRevalidate){let d=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((h=n[0])==null?void 0:h.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof d=="boolean")return d}return!0}):[]}function Rk(t,e,{includeHydrateFallback:n}={}){return Ik(t.map(s=>{let i=e.routes[s.route.id];if(!i)return[];let r=[i.module];return i.clientActionModule&&(r=r.concat(i.clientActionModule)),i.clientLoaderModule&&(r=r.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(r=r.concat(i.hydrateFallbackModule)),i.imports&&(r=r.concat(i.imports)),r}).flat(1))}function Ik(t){return[...new Set(t)]}function Ak(t){let e={},n=Object.keys(t).sort();for(let s of n)e[s]=t[s];return e}function Nk(t,e){let n=new Set;return new Set(e),t.reduce((s,i)=>{let r=JSON.stringify(Ak(i));return n.has(r)||(n.add(r),s.push({key:r,link:i})),s},[])}var Dk=new Set([100,101,204,205]);function Ok(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&nt(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function vm(){let t=y.useContext(Bn);return xl(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function jk(){let t=y.useContext(mr);return xl(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Sl=y.createContext(void 0);Sl.displayName="FrameworkContext";function wm(){let t=y.useContext(Sl);return xl(t,"You must render this element inside a <HydratedRouter> element"),t}function Mk(t,e){let n=y.useContext(Sl),[s,i]=y.useState(!1),[r,o]=y.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:h}=e,d=y.useRef(null);y.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let m=v=>{v.forEach(b=>{o(b.isIntersecting)})},_=new IntersectionObserver(m,{threshold:.5});return d.current&&_.observe(d.current),()=>{_.disconnect()}}},[t]),y.useEffect(()=>{if(s){let m=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(m)}}},[s]);let f=()=>{i(!0)},p=()=>{i(!1),o(!1)};return n?t!=="intent"?[r,d,{}]:[r,d,{onFocus:Jn(a,f),onBlur:Jn(l,p),onMouseEnter:Jn(c,f),onMouseLeave:Jn(u,p),onTouchStart:Jn(h,f)}]:[!1,d,{}]}function Jn(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function Lk({page:t,...e}){let{router:n}=vm(),s=y.useMemo(()=>am(n.routes,t,n.basename),[n.routes,t,n.basename]);return s?y.createElement($k,{page:t,matches:s,...e}):null}function Fk(t){let{manifest:e,routeModules:n}=wm(),[s,i]=y.useState([]);return y.useEffect(()=>{let r=!1;return kk(t,e,n).then(o=>{r||i(o)}),()=>{r=!0}},[t,e,n]),s}function $k({page:t,matches:e,...n}){let s=qt(),{manifest:i,routeModules:r}=wm(),{basename:o}=vm(),{loaderData:a,matches:l}=jk(),c=y.useMemo(()=>vh(t,e,l,i,s,"data"),[t,e,l,i,s]),u=y.useMemo(()=>vh(t,e,l,i,s,"assets"),[t,e,l,i,s]),h=y.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let p=new Set,m=!1;if(e.forEach(v=>{var w;let b=i.routes[v.route.id];!b||!b.hasLoader||(!c.some(x=>x.route.id===v.route.id)&&v.route.id in a&&((w=r[v.route.id])!=null&&w.shouldRevalidate)||b.hasClientLoader?m=!0:p.add(v.route.id))}),p.size===0)return[];let _=Ok(t,o);return m&&p.size>0&&_.searchParams.set("_routes",e.filter(v=>p.has(v.route.id)).map(v=>v.route.id).join(",")),[_.pathname+_.search]},[o,a,s,i,c,e,t,r]),d=y.useMemo(()=>Rk(u,i),[u,i]),f=Fk(u);return y.createElement(y.Fragment,null,h.map(p=>y.createElement("link",{key:p,rel:"prefetch",as:"fetch",href:p,...n})),d.map(p=>y.createElement("link",{key:p,rel:"modulepreload",href:p,...n})),f.map(({key:p,link:m})=>y.createElement("link",{key:p,...m})))}function Bk(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var bm=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{bm&&(window.__reactRouterVersion="7.5.3")}catch{}function Vk({basename:t,children:e,window:n}){let s=y.useRef();s.current==null&&(s.current=RP({window:n,v5Compat:!0}));let i=s.current,[r,o]=y.useState({action:i.action,location:i.location}),a=y.useCallback(l=>{y.startTransition(()=>o(l))},[o]);return y.useLayoutEffect(()=>i.listen(a),[i,a]),y.createElement(gk,{basename:t,children:e,location:r.location,navigationType:r.action,navigator:i})}var xm=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,El=y.forwardRef(function({onClick:e,discover:n="render",prefetch:s="none",relative:i,reloadDocument:r,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:h,...d},f){let{basename:p}=y.useContext(We),m=typeof c=="string"&&xm.test(c),_,v=!1;if(typeof c=="string"&&m&&(_=c,bm))try{let P=new URL(window.location.href),R=c.startsWith("//")?new URL(P.protocol+c):new URL(c),S=nt(R.pathname,p);R.origin===P.origin&&S!=null?c=S+R.search+R.hash:v=!0}catch{Ve(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=tk(c,{relative:i}),[w,x,E]=Mk(s,d),k=Gk(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:i,viewTransition:h});function M(P){e&&e(P),P.defaultPrevented||k(P)}let D=y.createElement("a",{...d,...E,href:_||b,onClick:v||r?e:M,ref:Bk(f,x),target:l,"data-discover":!m&&n==="render"?"true":void 0});return w&&!m?y.createElement(y.Fragment,null,D,y.createElement(Lk,{page:b})):D});El.displayName="Link";var Uk=y.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:s="",end:i=!1,style:r,to:o,viewTransition:a,children:l,...c},u){let h=Ks(o,{relative:c.relative}),d=qt(),f=y.useContext(mr),{navigator:p,basename:m}=y.useContext(We),_=f!=null&&Jk(h)&&a===!0,v=p.encodeLocation?p.encodeLocation(h).pathname:h.pathname,b=d.pathname,w=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;n||(b=b.toLowerCase(),w=w?w.toLowerCase():null,v=v.toLowerCase()),w&&m&&(w=nt(w,m)||w);const x=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let E=b===v||!i&&b.startsWith(v)&&b.charAt(x)==="/",k=w!=null&&(w===v||!i&&w.startsWith(v)&&w.charAt(v.length)==="/"),M={isActive:E,isPending:k,isTransitioning:_},D=E?e:void 0,P;typeof s=="function"?P=s(M):P=[s,E?"active":null,k?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let R=typeof r=="function"?r(M):r;return y.createElement(El,{...c,"aria-current":D,className:P,ref:u,style:R,to:o,viewTransition:a},typeof l=="function"?l(M):l)});Uk.displayName="NavLink";var Wk=y.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:s,replace:i,state:r,method:o=hi,action:a,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:h,...d},f)=>{let p=Kk(),m=Yk(a,{relative:c}),_=o.toLowerCase()==="get"?"get":"post",v=typeof a=="string"&&xm.test(a),b=w=>{if(l&&l(w),w.defaultPrevented)return;w.preventDefault();let x=w.nativeEvent.submitter,E=(x==null?void 0:x.getAttribute("formmethod"))||o;p(x||w.currentTarget,{fetcherKey:e,method:E,navigate:n,replace:i,state:r,relative:c,preventScrollReset:u,viewTransition:h})};return y.createElement("form",{ref:f,method:_,action:m,onSubmit:s?l:b,...d,"data-discover":!v&&t==="render"?"true":void 0})});Wk.displayName="Form";function Hk(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Sm(t){let e=y.useContext(Bn);return te(e,Hk(t)),e}function Gk(t,{target:e,replace:n,state:s,preventScrollReset:i,relative:r,viewTransition:o}={}){let a=gm(),l=qt(),c=Ks(t,{relative:r});return y.useCallback(u=>{if(xk(u,e)){u.preventDefault();let h=n!==void 0?n:As(l)===As(c);a(t,{replace:h,state:s,preventScrollReset:i,relative:r,viewTransition:o})}},[l,a,c,n,s,e,t,i,r,o])}var qk=0,zk=()=>`__${String(++qk)}__`;function Kk(){let{router:t}=Sm("useSubmit"),{basename:e}=y.useContext(We),n=dk();return y.useCallback(async(s,i={})=>{let{action:r,method:o,encType:a,formData:l,body:c}=Ck(s,e);if(i.navigate===!1){let u=i.fetcherKey||zk();await t.fetch(u,n,i.action||r,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||o,formEncType:i.encType||a,flushSync:i.flushSync})}else await t.navigate(i.action||r,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||o,formEncType:i.encType||a,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,n])}function Yk(t,{relative:e}={}){let{basename:n}=y.useContext(We),s=y.useContext(it);te(s,"useFormAction must be used inside a RouteContext");let[i]=s.matches.slice(-1),r={...Ks(t||".",{relative:e})},o=qt();if(t==null){r.search=o.search;let a=new URLSearchParams(r.search),l=a.getAll("index");if(l.some(u=>u==="")){a.delete("index"),l.filter(h=>h).forEach(h=>a.append("index",h));let u=a.toString();r.search=u?`?${u}`:""}}return(!t||t===".")&&i.route.index&&(r.search=r.search?r.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(r.pathname=r.pathname==="/"?n:Xe([n,r.pathname])),As(r)}function Jk(t,e={}){let n=y.useContext(fm);te(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=Sm("useViewTransitionState"),i=Ks(t,{relative:e.relative});if(!n.isTransitioning)return!1;let r=nt(n.currentLocation.pathname,s)||n.currentLocation.pathname,o=nt(n.nextLocation.pathname,s)||n.nextLocation.pathname;return Bi(i.pathname,o)!=null||Bi(i.pathname,r)!=null}new TextEncoder;[...Dk];const Qk=()=>{const{user:t}=yn();return g.jsx("nav",{className:"bg-white bg-opacity-10 backdrop-blur-lg border-b border-white/10",children:g.jsx("div",{className:"container mx-auto px-4",children:g.jsxs("div",{className:"flex items-center justify-between h-16",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Wm,{className:"text-pink-500",size:28}),g.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-pink-500 to-violet-500 text-transparent bg-clip-text",children:"2Players.io"})]}),g.jsxs("div",{className:"flex items-center gap-6",children:[t&&g.jsxs(g.Fragment,{children:[g.jsxs("button",{className:"nav-button",children:[g.jsx(ea,{size:20}),g.jsx("span",{children:"Friends"})]}),g.jsxs("button",{className:"nav-button",children:[g.jsx(Vi,{size:20}),g.jsx("span",{children:"Messages"})]})]}),g.jsx(El,{to:"/play",className:"ml-4 px-4 py-2 bg-gradient-to-r from-pink-500 to-violet-500 text-white rounded-lg hover:opacity-90 transition",children:"Play Now"})]})]})})})},Xk=()=>{const{user:t}=yn(),[e,n]=y.useState(window.location.hash==="#guest");y.useEffect(()=>{const i=()=>{n(window.location.hash==="#guest")};return window.addEventListener("hashchange",i),()=>window.removeEventListener("hashchange",i)},[]);const s=()=>{window.location.hash="guest",n(!0)};return!t&&!e?g.jsx("div",{className:"min-h-[80vh] flex items-center justify-center",children:g.jsxs("div",{className:"max-w-2xl mx-auto p-8 text-center",children:[g.jsx("h1",{className:"text-4xl font-bold mb-6 bg-gradient-to-r from-pink-500 via-violet-500 to-blue-500 text-transparent bg-clip-text",children:"2Players is more fun when you're logged in!"}),g.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl p-8 mb-8",children:[g.jsx("h2",{className:"text-2xl font-semibold text-white mb-4",children:"Sign up to unlock:"}),g.jsxs("ul",{className:"text-left space-y-3 text-gray-300 mb-6",children:[g.jsx("li",{children:" Add friends and build your gaming circle"}),g.jsx("li",{children:" Chat with other players during games"}),g.jsx("li",{children:" Track your stats and achievements"}),g.jsx("li",{children:" Play with the entire community"})]})]}),g.jsxs("div",{className:"flex flex-col items-center gap-4 mt-8",children:[g.jsx("button",{onClick:()=>{var i;return(i=document.getElementById("auth-modal"))==null?void 0:i.click()},className:"w-full px-6 py-3 bg-white/10 text-white rounded-lg font-semibold hover:bg-white/20 transition",children:"Log In"}),g.jsx("button",{onClick:()=>{const i=document.getElementById("auth-modal");i&&(i.dataset.signup="true",i.click())},className:"w-full px-6 py-3 bg-gradient-to-r from-pink-500 to-violet-500 text-white rounded-lg font-semibold hover:opacity-90 transition",children:"Sign Up"}),g.jsxs("div",{className:"relative w-full my-2",children:[g.jsx("div",{className:"absolute inset-0 flex items-center",children:g.jsx("div",{className:"w-full border-t border-white/10"})}),g.jsx("div",{className:"relative flex justify-center",children:g.jsx("span",{className:"px-2 bg-slate-900 text-gray-400 text-sm",children:"or"})})]}),g.jsx("button",{onClick:s,className:"w-full px-6 py-3 bg-white/5 text-gray-300 rounded-lg font-semibold hover:bg-white/10 transition",children:"Continue as Guest"}),g.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Note: Guest players can only play with other guests"})]})]})}):g.jsx("div",{className:"min-h-screen py-8",children:g.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e&&g.jsx("div",{className:"mb-8 p-4 bg-white/5 backdrop-blur-lg rounded-lg",children:g.jsxs("p",{className:"text-amber-400 text-center",children:["Playing as guest - Some features are limited.",g.jsx("button",{onClick:()=>{var i;return(i=document.getElementById("auth-modal"))==null?void 0:i.click()},className:"text-white underline ml-2 hover:text-pink-500",children:"Sign up now"})]})}),g.jsxs("div",{className:"text-center mb-12",children:[g.jsx("h1",{className:"text-4xl font-bold mb-4 bg-gradient-to-r from-pink-500 via-violet-500 to-blue-500 text-transparent bg-clip-text",children:"Choose Your Game"}),g.jsx("p",{className:"text-gray-400",children:"Challenge players and have fun!"})]}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12",children:[!e&&g.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl p-6",children:[g.jsxs("div",{className:"flex items-center justify-between mb-4",children:[g.jsx("h2",{className:"text-xl font-semibold text-white",children:"Your Stats"}),g.jsx(xh,{className:"w-6 h-6 text-amber-400"})]}),g.jsxs("div",{className:"space-y-2 text-gray-300",children:[g.jsx("p",{children:"Games Played: 0"}),g.jsx("p",{children:"Wins: 0"}),g.jsx("p",{children:"Win Rate: 0%"})]})]}),!e&&g.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl p-6",children:[g.jsxs("div",{className:"flex items-center justify-between mb-4",children:[g.jsx("h2",{className:"text-xl font-semibold text-white",children:"Friends Online"}),g.jsx(ea,{className:"w-6 h-6 text-green-400"})]}),g.jsx("p",{className:"text-gray-400",children:"No friends online"})]}),!e&&g.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl p-6",children:[g.jsxs("div",{className:"flex items-center justify-between mb-4",children:[g.jsx("h2",{className:"text-xl font-semibold text-white",children:"Recent Activity"}),g.jsx(Vi,{className:"w-6 h-6 text-blue-400"})]}),g.jsx("p",{className:"text-gray-400",children:"No recent activity"})]})]}),g.jsx(om,{})]})})};function Zk(){const[t,e]=y.useState(""),[n,s]=y.useState(""),i=gm(),r=l=>l.length<3?"Username must be at least 3 characters long":l.length>20?"Username must be less than 20 characters":/^[a-zA-Z0-9_]+$/.test(l)?"":"Username can only contain letters, numbers, and underscores",o=l=>{const c=l.target.value;e(c),s(r(c))},a=async l=>{l.preventDefault();const c=r(t);if(c){s(c);return}try{i("/play")}catch{s("Failed to update username. Please try again.")}};return g.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-900",children:g.jsxs(Jo.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-md w-full p-6 bg-slate-800 rounded-xl shadow-xl",children:[g.jsxs("div",{className:"mb-8 text-center",children:[g.jsx("div",{className:"w-16 h-16 bg-pink-500/10 rounded-full flex items-center justify-center mx-auto mb-4",children:g.jsx(wh,{className:"w-8 h-8 text-pink-500"})}),g.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Choose your username"}),g.jsx("p",{className:"text-slate-400",children:"This will be your identity in games and chat"})]}),g.jsxs("form",{onSubmit:a,children:[g.jsxs("div",{className:"mb-6",children:[g.jsx("input",{type:"text",value:t,onChange:o,className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-4 py-3 text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-pink-500",placeholder:"Enter username",autoFocus:!0}),n&&g.jsx("p",{className:"mt-2 text-sm text-red-400",children:n})]}),g.jsx("button",{type:"submit",disabled:!!n||!t,className:"w-full px-4 py-3 bg-gradient-to-r from-pink-500 to-violet-500 text-white rounded-lg font-semibold hover:opacity-90 transition disabled:opacity-50 disabled:cursor-not-allowed",children:"Continue"})]})]})})}const eR=()=>{const{onlinePlayers:t,isConnected:e}=Xw(),{user:n,loading:s,initializeAuth:i}=yn();Zo.useEffect(()=>{i()},[i]);const r=[{icon:g.jsx(Hm,{className:"w-8 h-8 text-pink-500"}),title:"Real-time Multiplayer",description:"Challenge players worldwide in classic games like Battleships, Tic Tac Toe, and Checkers"},{icon:g.jsx(ea,{className:"w-8 h-8 text-violet-500"}),title:"Make New Friends",description:"Connect with players, send friend requests, and build your gaming circle"},{icon:g.jsx(Vi,{className:"w-8 h-8 text-blue-500"}),title:"Live Chat",description:"Chat with your opponents during games and make new connections"},{icon:g.jsx(Gm,{className:"w-8 h-8 text-green-500"}),title:"Global Community",description:"Join players from around the world in friendly competition"}];return g.jsx(Vk,{children:g.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-violet-900 via-slate-900 to-black",children:[g.jsx(Qk,{}),g.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:g.jsxs(yk,{children:[g.jsx(ui,{path:"/",element:g.jsx(g.Fragment,{children:!n&&!s?g.jsxs("div",{className:"py-12 sm:py-20",children:[g.jsxs("div",{className:"text-center mb-16",children:[g.jsx("h1",{className:"text-4xl sm:text-6xl font-bold mb-6 bg-gradient-to-r from-pink-500 via-violet-500 to-blue-500 text-transparent bg-clip-text",children:"Play Games. Meet People."}),g.jsx("p",{className:"text-xl text-gray-300 mb-8 max-w-2xl mx-auto",children:"Challenge players worldwide in real-time multiplayer games and make new friends along the way."}),e&&t>0&&g.jsxs("p",{className:"text-green-400 text-lg animate-pulse",children:[t," Players Online Now"]})]}),g.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-8 mb-16",children:r.map((o,a)=>g.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl p-6 hover:bg-white/10 transition",children:[g.jsx("div",{className:"mb-4",children:o.icon}),g.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:o.title}),g.jsx("p",{className:"text-gray-400",children:o.description})]},a))}),g.jsx("div",{className:"text-center",children:g.jsx("button",{onClick:()=>window.location.href="/play",className:"px-8 py-4 bg-gradient-to-r from-pink-500 to-violet-500 text-white rounded-lg text-lg font-semibold hover:opacity-90 transition",children:"Start Playing Now"})})]}):g.jsx("div",{className:"py-8",children:g.jsx(om,{})})})}),g.jsx(ui,{path:"/play",element:g.jsx(Xk,{})}),g.jsx(ui,{path:"/onboarding",element:g.jsx(Zk,{})})]})})]})})};class tR extends y.Component{constructor(){super(...arguments);Tl(this,"state",{hasError:!1})}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(n,s){console.error("Uncaught error:",n,s)}render(){return this.state.hasError?g.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-violet-900 via-slate-900 to-black",children:g.jsxs("div",{className:"text-center p-8 bg-white/5 backdrop-blur-lg rounded-xl",children:[g.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Oops, something went wrong!"}),g.jsx("button",{className:"px-4 py-2 bg-violet-500 text-white rounded hover:bg-violet-600",onClick:()=>this.setState({hasError:!1}),children:"Try again"})]})}):this.props.children}}to.createRoot(document.getElementById("root")).render(g.jsx(Zo.StrictMode,{children:g.jsx(tR,{children:g.jsx(eR,{})})}));
//# sourceMappingURL=index-DeHn-lJX.js.map
