var xf=Object.defineProperty;var wf=(t,e,n)=>e in t?xf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var la=(t,e,n)=>wf(t,typeof e!="symbol"?e+"":e,n);import{r as m,a as bf,G as Cf,g as Sf,R as jc,X as Ef,C as Tf,A as Pf,T as Rf,b as If,c as Nf,U as Vc,d as Af,S as Bc,e as Df,M as Zs,f as kf,H as Mf,h as Fr,V as ca,i as Lf,j as jr,k as Vr,P as Of,L as Ff,l as $c,m as jf,n as Vf,o as Bf,p as $f}from"./vendor-T6PuhLJP.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=n(i);fetch(i.href,r)}})();var Uc={exports:{}},ei={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uf=m,Wf=Symbol.for("react.element"),Hf=Symbol.for("react.fragment"),Gf=Object.prototype.hasOwnProperty,zf=Uf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Kf={key:!0,ref:!0,__self:!0,__source:!0};function Wc(t,e,n){var s,i={},r=null,o=null;n!==void 0&&(r=""+n),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)Gf.call(e,s)&&!Kf.hasOwnProperty(s)&&(i[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)i[s]===void 0&&(i[s]=e[s]);return{$$typeof:Wf,type:t,key:r,ref:o,props:i,_owner:zf.current}}ei.Fragment=Hf;ei.jsx=Wc;ei.jsxs=Wc;Uc.exports=ei;var g=Uc.exports,qi={},ua=bf;qi.createRoot=ua.createRoot,qi.hydrateRoot=ua.hydrateRoot;var ha={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hc={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C=function(t,e){if(!t)throw Qt(e)},Qt=function(t){return new Error("Firebase Database ("+Hc.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gc=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Yf=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const i=t[n++];if(i<128)e[s++]=String.fromCharCode(i);else if(i>191&&i<224){const r=t[n++];e[s++]=String.fromCharCode((i&31)<<6|r&63)}else if(i>239&&i<365){const r=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(l>>10)),e[s++]=String.fromCharCode(56320+(l&1023))}else{const r=t[n++],o=t[n++];e[s++]=String.fromCharCode((i&15)<<12|(r&63)<<6|o&63)}}return e.join("")},Br={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let i=0;i<t.length;i+=3){const r=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,h=r>>2,u=(r&3)<<4|a>>4;let d=(a&15)<<2|c>>6,f=c&63;l||(f=64,o||(d=64)),s.push(n[h],n[u],n[d],n[f])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Gc(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Yf(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let i=0;i<t.length;){const r=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const u=i<t.length?n[t.charAt(i)]:64;if(++i,r==null||a==null||c==null||u==null)throw new qf;const d=r<<2|a>>4;if(s.push(d),c!==64){const f=a<<4&240|c>>2;if(s.push(f),u!==64){const y=c<<6&192|u;s.push(y)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class qf extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const zc=function(t){const e=Gc(t);return Br.encodeByteArray(e,!0)},Ts=function(t){return zc(t).replace(/\./g,"")},Xi=function(t){try{return Br.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xf(t){return Kc(void 0,t)}function Kc(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!Qf(n)||(t[n]=Kc(t[n],e[n]));return t}function Qf(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jf(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zf=()=>Jf().__FIREBASE_DEFAULTS__,ep=()=>{if(typeof process>"u"||typeof ha>"u")return;const t=ha.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},tp=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Xi(t[1]);return e&&JSON.parse(e)},Yc=()=>{try{return Zf()||ep()||tp()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},np=t=>{var e,n;return(n=(e=Yc())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},sp=t=>{const e=np(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},qc=()=>{var t;return(t=Yc())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ip(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",i=t.iat||0,r=t.sub||t.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:i,exp:i+3600,auth_time:i,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Ts(JSON.stringify(n)),Ts(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rp(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Xc(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(rp())}function op(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ap(){return Hc.NODE_ADMIN===!0}function lp(){try{return typeof indexedDB=="object"}catch{return!1}}function cp(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(s);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var r;e(((r=i.error)===null||r===void 0?void 0:r.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const up="FirebaseError";class qn extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=up,Object.setPrototypeOf(this,qn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qc.prototype.create)}}class Qc{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},i=`${this.service}/${e}`,r=this.errors[e],o=r?hp(r,s):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new qn(i,a,s)}}function hp(t,e){return t.replace(dp,(n,s)=>{const i=e[s];return i!=null?String(i):`<${s}?>`})}const dp=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nn(t){return JSON.parse(t)}function ie(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jc=function(t){let e={},n={},s={},i="";try{const r=t.split(".");e=Nn(Xi(r[0])||""),n=Nn(Xi(r[1])||""),i=r[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:i}},fp=function(t){const e=Jc(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},pp=function(t){const e=Jc(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function De(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Bt(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Qi(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ps(t,e,n){const s={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=e.call(n,t[i],i,t));return s}function Ji(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const i of n){if(!s.includes(i))return!1;const r=t[i],o=e[i];if(da(r)&&da(o)){if(!Ji(r,o))return!1}else if(r!==o)return!1}for(const i of s)if(!n.includes(i))return!1;return!0}function da(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mp(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let u=0;u<16;u++)s[u]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let u=0;u<16;u++)s[u]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let u=16;u<80;u++){const d=s[u-3]^s[u-8]^s[u-14]^s[u-16];s[u]=(d<<1|d>>>31)&4294967295}let i=this.chain_[0],r=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,h;for(let u=0;u<80;u++){u<40?u<20?(c=a^r&(o^a),h=1518500249):(c=r^o^a,h=1859775393):u<60?(c=r&o|a&(r|o),h=2400959708):(c=r^o^a,h=3395469782);const d=(i<<5|i>>>27)+c+l+h+s[u]&4294967295;l=a,a=o,o=(r<<30|r>>>2)&4294967295,r=i,i=d}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+r&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let i=0;const r=this.buf_;let o=this.inbuf_;for(;i<n;){if(o===0)for(;i<=s;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(r[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(r),o=0;break}}else for(;i<n;)if(r[o]=e[i],++o,++i,o===this.blockSize){this.compress_(r),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let i=0;i<5;i++)for(let r=24;r>=0;r-=8)e[s]=this.chain_[i]>>r&255,++s;return e}}function $t(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yp=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let i=t.charCodeAt(s);if(i>=55296&&i<=56319){const r=i-55296;s++,C(s<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(s)-56320;i=65536+(r<<10)+o}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},ti=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function at(t){return t&&t._delegate?t._delegate:t}class An{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ut="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new Pe;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&s.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(xp(e))try{this.getOrInitializeService({instanceIdentifier:ut})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const r=this.getOrInitializeService({instanceIdentifier:i});s.resolve(r)}catch{}}}}clearInstance(e=ut){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ut){return this.instances.has(e)}getOptions(e=ut){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);s===a&&o.resolve(i)}return i}onInit(e,n){var s;const i=this.normalizeInstanceIdentifier(n),r=(s=this.onInitCallbacks.get(i))!==null&&s!==void 0?s:new Set;r.add(e),this.onInitCallbacks.set(i,r);const o=this.instances.get(i);return o&&e(o,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const i of s)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:_p(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=ut){return this.component?this.component.multipleInstances?e:ut:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function _p(t){return t===ut?void 0:t}function xp(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new vp(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var q;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(q||(q={}));const bp={debug:q.DEBUG,verbose:q.VERBOSE,info:q.INFO,warn:q.WARN,error:q.ERROR,silent:q.SILENT},Cp=q.INFO,Sp={[q.DEBUG]:"log",[q.VERBOSE]:"log",[q.INFO]:"info",[q.WARN]:"warn",[q.ERROR]:"error"},Ep=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),i=Sp[e];if(i)console[i](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Zc{constructor(e){this.name=e,this._logLevel=Cp,this._logHandler=Ep,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in q))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?bp[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,q.DEBUG,...e),this._logHandler(this,q.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,q.VERBOSE,...e),this._logHandler(this,q.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,q.INFO,...e),this._logHandler(this,q.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,q.WARN,...e),this._logHandler(this,q.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,q.ERROR,...e),this._logHandler(this,q.ERROR,...e)}}const Tp=(t,e)=>e.some(n=>t instanceof n);let fa,pa;function Pp(){return fa||(fa=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Rp(){return pa||(pa=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const eu=new WeakMap,Zi=new WeakMap,tu=new WeakMap,bi=new WeakMap,$r=new WeakMap;function Ip(t){const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",o)},r=()=>{n(Qe(t.result)),i()},o=()=>{s(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&eu.set(n,t)}).catch(()=>{}),$r.set(e,t),e}function Np(t){if(Zi.has(t))return;const e=new Promise((n,s)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",o),t.removeEventListener("abort",o)},r=()=>{n(),i()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",o),t.addEventListener("abort",o)});Zi.set(t,e)}let er={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Zi.get(t);if(e==="objectStoreNames")return t.objectStoreNames||tu.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Qe(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Ap(t){er=t(er)}function Dp(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(Ci(this),e,...n);return tu.set(s,e.sort?e.sort():[e]),Qe(s)}:Rp().includes(t)?function(...e){return t.apply(Ci(this),e),Qe(eu.get(this))}:function(...e){return Qe(t.apply(Ci(this),e))}}function kp(t){return typeof t=="function"?Dp(t):(t instanceof IDBTransaction&&Np(t),Tp(t,Pp())?new Proxy(t,er):t)}function Qe(t){if(t instanceof IDBRequest)return Ip(t);if(bi.has(t))return bi.get(t);const e=kp(t);return e!==t&&(bi.set(t,e),$r.set(e,t)),e}const Ci=t=>$r.get(t);function Mp(t,e,{blocked:n,upgrade:s,blocking:i,terminated:r}={}){const o=indexedDB.open(t,e),a=Qe(o);return s&&o.addEventListener("upgradeneeded",l=>{s(Qe(o.result),l.oldVersion,l.newVersion,Qe(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{r&&l.addEventListener("close",()=>r()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const Lp=["get","getKey","getAll","getAllKeys","count"],Op=["put","add","delete","clear"],Si=new Map;function ma(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Si.get(e))return Si.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,i=Op.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(i||Lp.includes(n)))return;const r=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return s&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return Si.set(e,r),r}Ap(t=>({...t,get:(e,n,s)=>ma(e,n)||t.get(e,n,s),has:(e,n)=>!!ma(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(jp(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function jp(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const tr="@firebase/app",ga="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ue=new Zc("@firebase/app"),Vp="@firebase/app-compat",Bp="@firebase/analytics-compat",$p="@firebase/analytics",Up="@firebase/app-check-compat",Wp="@firebase/app-check",Hp="@firebase/auth",Gp="@firebase/auth-compat",zp="@firebase/database",Kp="@firebase/data-connect",Yp="@firebase/database-compat",qp="@firebase/functions",Xp="@firebase/functions-compat",Qp="@firebase/installations",Jp="@firebase/installations-compat",Zp="@firebase/messaging",em="@firebase/messaging-compat",tm="@firebase/performance",nm="@firebase/performance-compat",sm="@firebase/remote-config",im="@firebase/remote-config-compat",rm="@firebase/storage",om="@firebase/storage-compat",am="@firebase/firestore",lm="@firebase/vertexai-preview",cm="@firebase/firestore-compat",um="firebase",hm="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nr="[DEFAULT]",dm={[tr]:"fire-core",[Vp]:"fire-core-compat",[$p]:"fire-analytics",[Bp]:"fire-analytics-compat",[Wp]:"fire-app-check",[Up]:"fire-app-check-compat",[Hp]:"fire-auth",[Gp]:"fire-auth-compat",[zp]:"fire-rtdb",[Kp]:"fire-data-connect",[Yp]:"fire-rtdb-compat",[qp]:"fire-fn",[Xp]:"fire-fn-compat",[Qp]:"fire-iid",[Jp]:"fire-iid-compat",[Zp]:"fire-fcm",[em]:"fire-fcm-compat",[tm]:"fire-perf",[nm]:"fire-perf-compat",[sm]:"fire-rc",[im]:"fire-rc-compat",[rm]:"fire-gcs",[om]:"fire-gcs-compat",[am]:"fire-fst",[cm]:"fire-fst-compat",[lm]:"fire-vertex","fire-js":"fire-js",[um]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rs=new Map,fm=new Map,sr=new Map;function ya(t,e){try{t.container.addComponent(e)}catch(n){Ue.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Is(t){const e=t.name;if(sr.has(e))return Ue.debug(`There were multiple attempts to register component ${e}.`),!1;sr.set(e,t);for(const n of Rs.values())ya(n,t);for(const n of fm.values())ya(n,t);return!0}function pm(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mm={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Je=new Qc("app","Firebase",mm);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new An("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Je.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ym=hm;function nu(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s=Object.assign({name:nr,automaticDataCollectionEnabled:!1},e),i=s.name;if(typeof i!="string"||!i)throw Je.create("bad-app-name",{appName:String(i)});if(n||(n=qc()),!n)throw Je.create("no-options");const r=Rs.get(i);if(r){if(Ji(n,r.options)&&Ji(s,r.config))return r;throw Je.create("duplicate-app",{appName:i})}const o=new wp(i);for(const l of sr.values())o.addComponent(l);const a=new gm(n,s,o);return Rs.set(i,a),a}function vm(t=nr){const e=Rs.get(t);if(!e&&t===nr&&qc())return nu();if(!e)throw Je.create("no-app",{appName:t});return e}function Ft(t,e,n){var s;let i=(s=dm[t])!==null&&s!==void 0?s:t;n&&(i+=`-${n}`);const r=i.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const a=[`Unable to register library "${i}" with version "${e}":`];r&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ue.warn(a.join(" "));return}Is(new An(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _m="firebase-heartbeat-database",xm=1,Dn="firebase-heartbeat-store";let Ei=null;function su(){return Ei||(Ei=Mp(_m,xm,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Dn)}catch(n){console.warn(n)}}}}).catch(t=>{throw Je.create("idb-open",{originalErrorMessage:t.message})})),Ei}async function wm(t){try{const n=(await su()).transaction(Dn),s=await n.objectStore(Dn).get(iu(t));return await n.done,s}catch(e){if(e instanceof qn)Ue.warn(e.message);else{const n=Je.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ue.warn(n.message)}}}async function va(t,e){try{const s=(await su()).transaction(Dn,"readwrite");await s.objectStore(Dn).put(e,iu(t)),await s.done}catch(n){if(n instanceof qn)Ue.warn(n.message);else{const s=Je.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ue.warn(s.message)}}}function iu(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bm=1024,Cm=30*24*60*60*1e3;class Sm{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Tm(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=_a();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(o=>o.date===r)?void 0:(this._heartbeatsCache.heartbeats.push({date:r,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=Cm}),this._storage.overwrite(this._heartbeatsCache))}catch(s){Ue.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=_a(),{heartbeatsToSend:s,unsentEntries:i}=Em(this._heartbeatsCache.heartbeats),r=Ts(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(n){return Ue.warn(n),""}}}function _a(){return new Date().toISOString().substring(0,10)}function Em(t,e=bm){const n=[];let s=t.slice();for(const i of t){const r=n.find(o=>o.agent===i.agent);if(r){if(r.dates.push(i.date),xa(n)>e){r.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),xa(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class Tm{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return lp()?cp().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await wm(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return va(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return va(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function xa(t){return Ts(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pm(t){Is(new An("platform-logger",e=>new Fp(e),"PRIVATE")),Is(new An("heartbeat",e=>new Sm(e),"PRIVATE")),Ft(tr,ga,t),Ft(tr,ga,"esm2017"),Ft("fire-js","")}Pm("");var Rm="firebase",Im="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ft(Rm,Im,"app");var wa={};const ba="@firebase/database",Ca="1.0.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ru="";function Nm(t){ru=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ie(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Nn(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return De(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ou=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Am(e)}}catch{}return new Dm},pt=ou("localStorage"),km=ou("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jt=new Zc("@firebase/database"),Mm=function(){let t=1;return function(){return t++}}(),au=function(t){const e=yp(t),n=new gp;n.update(e);const s=n.digest();return Br.encodeByteArray(s)},Xn=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=Xn.apply(null,s):typeof s=="object"?e+=ie(s):e+=s,e+=" "}return e};let wn=null,Sa=!0;const Lm=function(t,e){C(!0,"Can't turn on custom loggers persistently."),jt.logLevel=q.VERBOSE,wn=jt.log.bind(jt)},ae=function(...t){if(Sa===!0&&(Sa=!1,wn===null&&km.get("logging_enabled")===!0&&Lm()),wn){const e=Xn.apply(null,t);wn(e)}},Qn=function(t){return function(...e){ae(t,...e)}},ir=function(...t){const e="FIREBASE INTERNAL ERROR: "+Xn(...t);jt.error(e)},We=function(...t){const e=`FIREBASE FATAL ERROR: ${Xn(...t)}`;throw jt.error(e),new Error(e)},pe=function(...t){const e="FIREBASE WARNING: "+Xn(...t);jt.warn(e)},Om=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&pe("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},ni=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},Fm=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Ut="[MIN_NAME]",vt="[MAX_NAME]",wt=function(t,e){if(t===e)return 0;if(t===Ut||e===vt)return-1;if(e===Ut||t===vt)return 1;{const n=Ea(t),s=Ea(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},jm=function(t,e){return t===e?0:t<e?-1:1},ln=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+ie(e))},Ur=function(t){if(typeof t!="object"||t===null)return ie(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=ie(e[s]),n+=":",n+=Ur(t[e[s]]);return n+="}",n},lu=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let i=0;i<n;i+=e)i+e>n?s.push(t.substring(i,n)):s.push(t.substring(i,i+e));return s};function le(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const cu=function(t){C(!ni(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let i,r,o,a,l;t===0?(r=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),s),r=a+s,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(r=0,o=Math.round(t/Math.pow(2,1-s-n))));const c=[];for(l=n;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(r%2?1:0),r=Math.floor(r/2);c.push(i?1:0),c.reverse();const h=c.join("");let u="";for(l=0;l<64;l+=8){let d=parseInt(h.substr(l,8),2).toString(16);d.length===1&&(d="0"+d),u=u+d}return u.toLowerCase()},Vm=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Bm=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function $m(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const Um=new RegExp("^-?(0*)\\d{1,10}$"),Wm=-2147483648,Hm=2147483647,Ea=function(t){if(Um.test(t)){const e=Number(t);if(e>=Wm&&e<=Hm)return e}return null},Jt=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw pe("Exception was thrown by user callback.",n),e},Math.floor(0))}},Gm=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},bn=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(s=>this.appCheck=s)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){pe(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(ae("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',pe(e)}}class _s{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}_s.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wr="5",uu="v",hu="s",du="r",fu="f",pu=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,mu="ls",gu="p",rr="ac",yu="websocket",vu="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{constructor(e,n,s,i,r=!1,o="",a=!1,l=!1){this.secure=n,this.namespace=s,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=pt.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&pt.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function Ym(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function xu(t,e,n){C(typeof e=="string","typeof type must == string"),C(typeof n=="object","typeof params must == object");let s;if(e===yu)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===vu)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Ym(t)&&(n.ns=t.namespace);const i=[];return le(n,(r,o)=>{i.push(r+"="+o)}),s+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qm{constructor(){this.counters_={}}incrementCounter(e,n=1){De(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return Xf(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ti={},Pi={};function Hr(t){const e=t.toString();return Ti[e]||(Ti[e]=new qm),Ti[e]}function Xm(t,e){const n=t.toString();return Pi[n]||(Pi[n]=e()),Pi[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<s.length;++i)s[i]&&Jt(()=>{this.onMessage_(s[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ta="start",Jm="close",Zm="pLPCommand",eg="pRTLPCB",wu="id",bu="pw",Cu="ser",tg="cb",ng="seg",sg="ts",ig="d",rg="dframe",Su=1870,Eu=30,og=Su-Eu,ag=25e3,lg=3e4;class At{constructor(e,n,s,i,r,o,a){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Qn(e),this.stats_=Hr(n),this.urlFn=l=>(this.appCheckToken&&(l[rr]=this.appCheckToken),xu(n,vu,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new Qm(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(lg)),Fm(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Gr((...r)=>{const[o,a,l,c,h]=r;if(this.incrementIncomingBytes_(r),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===Ta)this.id=a,this.password=l;else if(o===Jm)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...r)=>{const[o,a]=r;this.incrementIncomingBytes_(r),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const s={};s[Ta]="t",s[Cu]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[tg]=this.scriptTagHolder.uniqueCallbackIdentifier),s[uu]=Wr,this.transportSessionId&&(s[hu]=this.transportSessionId),this.lastSessionId&&(s[mu]=this.lastSessionId),this.applicationId&&(s[gu]=this.applicationId),this.appCheckToken&&(s[rr]=this.appCheckToken),typeof location<"u"&&location.hostname&&pu.test(location.hostname)&&(s[du]=fu);const i=this.urlFn(s);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){At.forceAllow_=!0}static forceDisallow(){At.forceDisallow_=!0}static isAvailable(){return At.forceAllow_?!0:!At.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Vm()&&!Bm()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=ie(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=zc(n),i=lu(s,og);for(let r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[rg]="t",s[wu]=e,s[bu]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=ie(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Gr{constructor(e,n,s,i){this.onDisconnect=s,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Mm(),window[Zm+this.uniqueCallbackIdentifier]=e,window[eg+this.uniqueCallbackIdentifier]=n,this.myIFrame=Gr.createIFrame_();let r="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(r='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){ae("frame writing exception"),a.stack&&ae(a.stack),ae(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||ae("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[wu]=this.myID,e[bu]=this.myPW,e[Cu]=this.currentSerial;let n=this.urlFn(e),s="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Eu+s.length<=Su;){const o=this.pendingSegs.shift();s=s+"&"+ng+i+"="+o.seg+"&"+sg+i+"="+o.ts+"&"+ig+i+"="+o.d,i++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(s,Math.floor(ag)),r=()=>{clearTimeout(i),s()};this.addTag(e,r)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const i=s.readyState;(!i||i==="loaded"||i==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{ae("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cg=16384,ug=45e3;let Ns=null;typeof MozWebSocket<"u"?Ns=MozWebSocket:typeof WebSocket<"u"&&(Ns=WebSocket);class Se{constructor(e,n,s,i,r,o,a){this.connId=e,this.applicationId=s,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Qn(this.connId),this.stats_=Hr(n),this.connURL=Se.connectionURL_(n,o,a,i,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,i,r){const o={};return o[uu]=Wr,typeof location<"u"&&location.hostname&&pu.test(location.hostname)&&(o[du]=fu),n&&(o[hu]=n),s&&(o[mu]=s),i&&(o[rr]=i),r&&(o[gu]=r),xu(e,yu,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,pt.set("previous_websocket_failure",!0);try{let s;ap(),this.mySock=new Ns(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const i=s.message||s.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Se.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&Ns!==null&&!Se.forceDisallow_}static previouslyFailed(){return pt.isInMemoryStorage||pt.get("previous_websocket_failure")===!0}markConnectionHealthy(){pt.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=Nn(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(C(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=ie(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=lu(n,cg);s.length>1&&this.sendString_(String(s.length));for(let i=0;i<s.length;i++)this.sendString_(s[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(ug))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Se.responsesRequiredToBeHealthy=2;Se.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[At,Se]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=Se&&Se.isAvailable();let s=n&&!Se.previouslyFailed();if(e.webSocketOnly&&(n||pe("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Se];else{const i=this.transports_=[];for(const r of kn.ALL_TRANSPORTS)r&&r.isAvailable()&&i.push(r);kn.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}kn.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hg=6e4,dg=5e3,fg=10*1024,pg=100*1024,Ri="t",Pa="d",mg="s",Ra="r",gg="e",Ia="o",Na="a",Aa="n",Da="p",yg="h";class vg{constructor(e,n,s,i,r,o,a,l,c,h){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=h,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Qn("c:"+this.id+":"),this.transportManager_=new kn(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=bn(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>pg?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>fg?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Ri in e){const n=e[Ri];n===Na?this.upgradeIfSecondaryHealthy_():n===Ra?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===Ia&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=ln("t",e),s=ln("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Da,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Na,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Aa,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=ln("t",e),s=ln("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=ln(Ri,e);if(Pa in e){const s=e[Pa];if(n===yg){const i=Object.assign({},s);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===Aa){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===mg?this.onConnectionShutdown_(s):n===Ra?this.onReset_(s):n===gg?ir("Server Error: "+s):n===Ia?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):ir("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Wr!==s&&pe("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),bn(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(hg))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):bn(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(dg))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Da,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(pt.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{put(e,n,s,i){}merge(e,n,s,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(e){this.allowedEvents_=e,this.listeners_={},C(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let i=0;i<s.length;i++)s[i].callback.apply(s[i].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const i=this.getInitialEvent(e);i&&n.apply(s,i)}off(e,n,s){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let r=0;r<i.length;r++)if(i[r].callback===n&&(!s||s===i[r].context)){i.splice(r,1);return}}validateEventType_(e){C(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends Pu{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Xc()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new As}getInitialEvent(e){return C(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ka=32,Ma=768;class H{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[s]=this.pieces_[i],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function W(){return new H("")}function V(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function tt(t){return t.pieces_.length-t.pieceNum_}function G(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new H(t.pieces_,e)}function zr(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function _g(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Mn(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Ru(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new H(e,0)}function Q(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof H)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let i=0;i<s.length;i++)s[i].length>0&&n.push(s[i])}return new H(n,0)}function B(t){return t.pieceNum_>=t.pieces_.length}function fe(t,e){const n=V(t),s=V(e);if(n===null)return e;if(n===s)return fe(G(t),G(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function xg(t,e){const n=Mn(t,0),s=Mn(e,0);for(let i=0;i<n.length&&i<s.length;i++){const r=wt(n[i],s[i]);if(r!==0)return r}return n.length===s.length?0:n.length<s.length?-1:1}function Kr(t,e){if(tt(t)!==tt(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function we(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(tt(t)>tt(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class wg{constructor(e,n){this.errorPrefix_=n,this.parts_=Mn(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=ti(this.parts_[s]);Iu(this)}}function bg(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=ti(e),Iu(t)}function Cg(t){const e=t.parts_.pop();t.byteLength_-=ti(e),t.parts_.length>0&&(t.byteLength_-=1)}function Iu(t){if(t.byteLength_>Ma)throw new Error(t.errorPrefix_+"has a key path longer than "+Ma+" bytes ("+t.byteLength_+").");if(t.parts_.length>ka)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ka+") or object contains a cycle "+ht(t))}function ht(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr extends Pu{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}static getInstance(){return new Yr}getInitialEvent(e){return C(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cn=1e3,Sg=60*5*1e3,La=30*1e3,Eg=1.3,Tg=3e4,Pg="server_kill",Oa=3;class je extends Tu{constructor(e,n,s,i,r,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=je.nextPersistentConnectionId_++,this.log_=Qn("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=cn,this.maxReconnectDelay_=Sg,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Yr.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&As.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const i=++this.requestNumber_,r={r:i,a:e,b:n};this.log_(ie(r)),C(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),s&&(this.requestCBHash_[i]=s)}get(e){this.initConnection_();const n=new Pe,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),n.promise}listen(e,n,s,i){this.initConnection_();const r=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+r),this.listens.has(o)||this.listens.set(o,new Map),C(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),C(!this.listens.get(o).has(r),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:n,query:e,tag:s};this.listens.get(o).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+s+" for "+i);const r={p:s},o="q";e.tag&&(r.q=n._queryObject,r.t=e.tag),r.h=e.hashFn(),this.sendRequest(o,r,a=>{const l=a.d,c=a.s;je.warnOnListenWarnings_(l,n),(this.listens.get(s)&&this.listens.get(s).get(i))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(s,i),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&De(e,"w")){const s=Bt(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',r=n._path.toString();pe(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||pp(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=La)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=fp(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,i=>{const r=i.s,o=i.d||"error";this.authToken_===e&&(r==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+i),C(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,i)&&this.connected_&&this.sendUnlisten_(s,i,e._queryObject,n)}sendUnlisten_(e,n,s,i){this.log_("Unlisten on "+e+" for "+n);const r={p:e},o="n";i&&(r.q=s,r.t=i),this.sendRequest(o,r)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,i){const r={p:n,d:s};this.log_("onDisconnect "+e,r),this.sendRequest(e,r,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,n,s,i){this.putInternal("p",e,n,s,i)}merge(e,n,s,i){this.putInternal("m",e,n,s,i)}putInternal(e,n,s,i,r){this.initConnection_();const o={p:n,d:s};r!==void 0&&(o.h=r),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,r=>{this.log_(n+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(r.s,r.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const r=s.d;this.log_("reportStats","Error sending stats: "+r)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ie(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):ir("Unrecognized action received from server: "+ie(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){C(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=cn,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=cn,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Tg&&(this.reconnectDelay_=cn),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Eg)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+je.nextConnectionId_++,r=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,s())},c=function(u){C(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(u)};this.realtime_={close:l,sendRequest:c};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[u,d]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);o?ae("getToken() completed but was canceled"):(ae("getToken() completed. Creating connection."),this.authToken_=u&&u.accessToken,this.appCheckToken_=d&&d.token,a=new vg(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,f=>{pe(f+" ("+this.repoInfo_.toString()+")"),this.interrupt(Pg)},r))}catch(u){this.log_("Failed to get token: "+u),o||(this.repoInfo_.nodeAdmin&&pe(u),l())}}}interrupt(e){ae("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){ae("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Qi(this.interruptReasons_)&&(this.reconnectDelay_=cn,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(r=>Ur(r)).join("$"):s="default";const i=this.removeListen_(e,s);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const s=new H(e).toString();let i;if(this.listens.has(s)){const r=this.listens.get(s);i=r.get(n),r.delete(n),r.size===0&&this.listens.delete(s)}else i=void 0;return i}onAuthRevoked_(e,n){ae("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Oa&&(this.reconnectDelay_=La,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){ae("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Oa&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+ru.replace(/\./g,"-")]=1,Xc()?e["framework.cordova"]=1:op()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=As.getInstance().currentlyOnline();return Qi(this.interruptReasons_)&&e}}je.nextPersistentConnectionId_=0;je.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new $(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new $(Ut,e),i=new $(Ut,n);return this.compare(s,i)!==0}minPost(){return $.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hs;class Nu extends si{static get __EMPTY_NODE(){return hs}static set __EMPTY_NODE(e){hs=e}compare(e,n){return wt(e.name,n.name)}isDefinedOn(e){throw Qt("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return $.MIN}maxPost(){return new $(vt,hs)}makePost(e,n){return C(typeof e=="string","KeyIndex indexValue must always be a string."),new $(e,hs)}toString(){return".key"}}const Vt=new Nu;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(e,n,s,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?s(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class oe{constructor(e,n,s,i,r){this.key=e,this.value=n,this.color=s??oe.RED,this.left=i??me.EMPTY_NODE,this.right=r??me.EMPTY_NODE}copy(e,n,s,i,r){return new oe(e??this.key,n??this.value,s??this.color,i??this.left,r??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let i=this;const r=s(e,i.key);return r<0?i=i.copy(null,null,null,i.left.insert(e,n,s),null):r===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,s)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return me.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,i;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return me.EMPTY_NODE;i=s.right.min_(),s=s.copy(i.key,i.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,oe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,oe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}oe.RED=!0;oe.BLACK=!1;class Rg{copy(e,n,s,i,r){return this}insert(e,n,s){return new oe(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class me{constructor(e,n=me.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new me(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,oe.BLACK,null,null))}remove(e){return new me(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,oe.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,i=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return i?i.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(i=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ds(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new ds(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new ds(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new ds(this.root_,null,this.comparator_,!0,e)}}me.EMPTY_NODE=new Rg;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ig(t,e){return wt(t.name,e.name)}function qr(t,e){return wt(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let or;function Ng(t){or=t}const Au=function(t){return typeof t=="number"?"number:"+cu(t):"string:"+t},Du=function(t){if(t.isLeafNode()){const e=t.val();C(typeof e=="string"||typeof e=="number"||typeof e=="object"&&De(e,".sv"),"Priority must be a string or number.")}else C(t===or||t.isEmpty(),"priority of unexpected type.");C(t===or||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fa;class re{constructor(e,n=re.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,C(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Du(this.priorityNode_)}static set __childrenNodeConstructor(e){Fa=e}static get __childrenNodeConstructor(){return Fa}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new re(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:re.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return B(e)?this:V(e)===".priority"?this.priorityNode_:re.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:re.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=V(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(C(s!==".priority"||tt(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,re.__childrenNodeConstructor.EMPTY_NODE.updateChild(G(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Au(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=cu(this.value_):e+=this.value_,this.lazyHash_=au(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===re.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof re.__childrenNodeConstructor?-1:(C(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,i=re.VALUE_TYPE_ORDER.indexOf(n),r=re.VALUE_TYPE_ORDER.indexOf(s);return C(i>=0,"Unknown leaf type: "+n),C(r>=0,"Unknown leaf type: "+s),i===r?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}re.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ku,Mu;function Ag(t){ku=t}function Dg(t){Mu=t}class kg extends si{compare(e,n){const s=e.node.getPriority(),i=n.node.getPriority(),r=s.compareTo(i);return r===0?wt(e.name,n.name):r}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return $.MIN}maxPost(){return new $(vt,new re("[PRIORITY-POST]",Mu))}makePost(e,n){const s=ku(e);return new $(n,new re("[PRIORITY-POST]",s))}toString(){return".priority"}}const Z=new kg;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mg=Math.log(2);class Lg{constructor(e){const n=r=>parseInt(Math.log(r)/Mg,10),s=r=>parseInt(Array(r+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=s(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Ds=function(t,e,n,s){t.sort(e);const i=function(l,c){const h=c-l;let u,d;if(h===0)return null;if(h===1)return u=t[l],d=n?n(u):u,new oe(d,u.node,oe.BLACK,null,null);{const f=parseInt(h/2,10)+l,y=i(l,f),p=i(f+1,c);return u=t[f],d=n?n(u):u,new oe(d,u.node,oe.BLACK,y,p)}},r=function(l){let c=null,h=null,u=t.length;const d=function(y,p){const v=u-y,x=u;u-=y;const _=i(v+1,x),w=t[v],P=n?n(w):w;f(new oe(P,w.node,p,null,_))},f=function(y){c?(c.left=y,c=y):(h=y,c=y)};for(let y=0;y<l.count;++y){const p=l.nextBitIsOne(),v=Math.pow(2,l.count-(y+1));p?d(v,oe.BLACK):(d(v,oe.BLACK),d(v,oe.RED))}return h},o=new Lg(t.length),a=r(o);return new me(s||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ii;const Et={};class Oe{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return C(Et&&Z,"ChildrenNode.ts has not been loaded"),Ii=Ii||new Oe({".priority":Et},{".priority":Z}),Ii}get(e){const n=Bt(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof me?n:null}hasIndex(e){return De(this.indexSet_,e.toString())}addIndex(e,n){C(e!==Vt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let i=!1;const r=n.getIterator($.Wrap);let o=r.getNext();for(;o;)i=i||e.isDefinedOn(o.node),s.push(o),o=r.getNext();let a;i?a=Ds(s,e.getCompare()):a=Et;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const h=Object.assign({},this.indexes_);return h[l]=a,new Oe(h,c)}addToIndexes(e,n){const s=Ps(this.indexes_,(i,r)=>{const o=Bt(this.indexSet_,r);if(C(o,"Missing index implementation for "+r),i===Et)if(o.isDefinedOn(e.node)){const a=[],l=n.getIterator($.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),Ds(a,o.getCompare())}else return Et;else{const a=n.get(e.name);let l=i;return a&&(l=l.remove(new $(e.name,a))),l.insert(e,e.node)}});return new Oe(s,this.indexSet_)}removeFromIndexes(e,n){const s=Ps(this.indexes_,i=>{if(i===Et)return i;{const r=n.get(e.name);return r?i.remove(new $(e.name,r)):i}});return new Oe(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let un;class L{constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&Du(this.priorityNode_),this.children_.isEmpty()&&C(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return un||(un=new L(new me(qr),null,Oe.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||un}updatePriority(e){return this.children_.isEmpty()?this:new L(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?un:n}}getChild(e){const n=V(e);return n===null?this:this.getImmediateChild(n).getChild(G(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(C(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new $(e,n);let i,r;n.isEmpty()?(i=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(s,this.children_)):(i=this.children_.insert(e,n),r=this.indexMap_.addToIndexes(s,this.children_));const o=i.isEmpty()?un:this.priorityNode_;return new L(i,o,r)}}updateChild(e,n){const s=V(e);if(s===null)return n;{C(V(e)!==".priority"||tt(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(s).updateChild(G(e),n);return this.updateImmediateChild(s,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,i=0,r=!0;if(this.forEachChild(Z,(o,a)=>{n[o]=a.val(e),s++,r&&L.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):r=!1}),!e&&r&&i<2*s){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Au(this.getPriority().val())+":"),this.forEachChild(Z,(n,s)=>{const i=s.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":au(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const i=this.resolveIndex_(s);if(i){const r=i.getPredecessorKey(new $(e,n));return r?r.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new $(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new $(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,$.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)<0;)i.getNext(),r=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,$.Wrap);let r=i.peek();for(;r!=null&&n.compare(r,e)>0;)i.getNext(),r=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Jn?-1:0}withIndex(e){if(e===Vt||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new L(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Vt||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(Z),i=n.getIterator(Z);let r=s.getNext(),o=i.getNext();for(;r&&o;){if(r.name!==o.name||!r.node.equals(o.node))return!1;r=s.getNext(),o=i.getNext()}return r===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Vt?null:this.indexMap_.get(e.toString())}}L.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class Og extends L{constructor(){super(new me(qr),L.EMPTY_NODE,Oe.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return L.EMPTY_NODE}isEmpty(){return!1}}const Jn=new Og;Object.defineProperties($,{MIN:{value:new $(Ut,L.EMPTY_NODE)},MAX:{value:new $(vt,Jn)}});Nu.__EMPTY_NODE=L.EMPTY_NODE;re.__childrenNodeConstructor=L;Ng(Jn);Dg(Jn);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fg=!0;function ne(t,e=null){if(t===null)return L.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),C(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new re(n,ne(e))}if(!(t instanceof Array)&&Fg){const n=[];let s=!1;if(le(t,(o,a)=>{if(o.substring(0,1)!=="."){const l=ne(a);l.isEmpty()||(s=s||!l.getPriority().isEmpty(),n.push(new $(o,l)))}}),n.length===0)return L.EMPTY_NODE;const r=Ds(n,Ig,o=>o.name,qr);if(s){const o=Ds(n,Z.getCompare());return new L(r,ne(e),new Oe({".priority":o},{".priority":Z}))}else return new L(r,ne(e),Oe.Default)}else{let n=L.EMPTY_NODE;return le(t,(s,i)=>{if(De(t,s)&&s.substring(0,1)!=="."){const r=ne(i);(r.isLeafNode()||!r.isEmpty())&&(n=n.updateImmediateChild(s,r))}}),n.updatePriority(ne(e))}}Ag(ne);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg extends si{constructor(e){super(),this.indexPath_=e,C(!B(e)&&V(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),i=this.extractChild(n.node),r=s.compareTo(i);return r===0?wt(e.name,n.name):r}makePost(e,n){const s=ne(e),i=L.EMPTY_NODE.updateChild(this.indexPath_,s);return new $(n,i)}maxPost(){const e=L.EMPTY_NODE.updateChild(this.indexPath_,Jn);return new $(vt,e)}toString(){return Mn(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg extends si{compare(e,n){const s=e.node.compareTo(n.node);return s===0?wt(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return $.MIN}maxPost(){return $.MAX}makePost(e,n){const s=ne(e);return new $(n,s)}toString(){return".value"}}const Bg=new Vg;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lu(t){return{type:"value",snapshotNode:t}}function Wt(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ln(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function On(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function $g(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e){this.index_=e}updateChild(e,n,s,i,r,o){C(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(i).equals(s.getChild(i))&&a.isEmpty()===s.isEmpty()||(o!=null&&(s.isEmpty()?e.hasChild(n)?o.trackChildChange(Ln(n,a)):C(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Wt(n,s)):o.trackChildChange(On(n,s,a))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(Z,(i,r)=>{n.hasChild(i)||s.trackChildChange(Ln(i,r))}),n.isLeafNode()||n.forEachChild(Z,(i,r)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(r)||s.trackChildChange(On(i,r,o))}else s.trackChildChange(Wt(i,r))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?L.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this.indexedFilter_=new Xr(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Fn.getStartPost_(e),this.endPost_=Fn.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,s=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&s}updateChild(e,n,s,i,r,o){return this.matches(new $(n,s))||(s=L.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,i,r,o)}updateFullNode(e,n,s){n.isLeafNode()&&(n=L.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(L.EMPTY_NODE);const r=this;return n.forEachChild(Z,(o,a)=>{r.matches(new $(o,a))||(i=i.updateImmediateChild(o,L.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const s=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?s<=0:s<0},this.withinEndPost=n=>{const s=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?s<=0:s<0},this.rangedFilter_=new Fn(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,s,i,r,o){return this.rangedFilter_.matches(new $(n,s))||(s=L.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,i,r,o):this.fullLimitUpdateChild_(e,n,s,r,o)}updateFullNode(e,n,s){let i;if(n.isLeafNode()||n.isEmpty())i=L.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=L.EMPTY_NODE.withIndex(this.index_);let r;this.reverse_?r=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):r=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;r.hasNext()&&o<this.limit_;){const a=r.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(L.EMPTY_NODE);let r;this.reverse_?r=i.getReverseIterator(this.index_):r=i.getIterator(this.index_);let o=0;for(;r.hasNext();){const a=r.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,L.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,i,r){let o;if(this.reverse_){const u=this.index_.getCompare();o=(d,f)=>u(f,d)}else o=this.index_.getCompare();const a=e;C(a.numChildren()===this.limit_,"");const l=new $(n,s),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(l);if(a.hasChild(n)){const u=a.getImmediateChild(n);let d=i.getChildAfterChild(this.index_,c,this.reverse_);for(;d!=null&&(d.name===n||a.hasChild(d.name));)d=i.getChildAfterChild(this.index_,d,this.reverse_);const f=d==null?1:o(d,l);if(h&&!s.isEmpty()&&f>=0)return r!=null&&r.trackChildChange(On(n,s,u)),a.updateImmediateChild(n,s);{r!=null&&r.trackChildChange(Ln(n,u));const p=a.updateImmediateChild(n,L.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(r!=null&&r.trackChildChange(Wt(d.name,d.node)),p.updateImmediateChild(d.name,d.node)):p}}else return s.isEmpty()?e:h&&o(c,l)>=0?(r!=null&&(r.trackChildChange(Ln(c.name,c.node)),r.trackChildChange(Wt(n,s))),a.updateImmediateChild(n,s).updateImmediateChild(c.name,L.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Z}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return C(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return C(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ut}hasEnd(){return this.endSet_}getIndexEndValue(){return C(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return C(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:vt}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return C(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Z}copy(){const e=new Qr;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Wg(t){return t.loadsAllData()?new Xr(t.getIndex()):t.hasLimit()?new Ug(t):new Fn(t)}function ja(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Z?n="$priority":t.index_===Bg?n="$value":t.index_===Vt?n="$key":(C(t.index_ instanceof jg,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=ie(n),t.startSet_){const s=t.startAfterSet_?"startAfter":"startAt";e[s]=ie(t.indexStartValue_),t.startNameSet_&&(e[s]+=","+ie(t.indexStartName_))}if(t.endSet_){const s=t.endBeforeSet_?"endBefore":"endAt";e[s]=ie(t.indexEndValue_),t.endNameSet_&&(e[s]+=","+ie(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Va(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Z&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks extends Tu{constructor(e,n,s,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=i,this.log_=Qn("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(C(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,s,i){const r=e._path.toString();this.log_("Listen called for "+r+" "+e._queryIdentifier);const o=ks.getListenId_(e,s),a={};this.listens_[o]=a;const l=ja(e._queryParams);this.restRequest_(r+".json",l,(c,h)=>{let u=h;if(c===404&&(u=null,c=null),c===null&&this.onDataUpdate_(r,u,!1,s),Bt(this.listens_,o)===a){let d;c?c===401?d="permission_denied":d="rest_error:"+c:d="ok",i(d,null)}})}unlisten(e,n){const s=ks.getListenId_(e,n);delete this.listens_[s]}get(e){const n=ja(e._queryParams),s=e._path.toString(),i=new Pe;return this.restRequest_(s+".json",n,(r,o)=>{let a=o;r===404&&(a=null,r=null),r===null?(this.onDataUpdate_(s,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,r])=>{i&&i.accessToken&&(n.auth=i.accessToken),r&&r.token&&(n.ac=r.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+mp(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=Nn(a.responseText)}catch{pe("Failed to parse JSON response for "+o+": "+a.responseText)}s(null,l)}else a.status!==401&&a.status!==404&&pe("Got unsuccessful REST response for "+o+" Status: "+a.status),s(a.status);s=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(){this.rootNode_=L.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ms(){return{value:null,children:new Map}}function Zt(t,e,n){if(B(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=V(e);t.children.has(s)||t.children.set(s,Ms());const i=t.children.get(s);e=G(e),Zt(i,e,n)}}function ar(t,e){if(B(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(Z,(s,i)=>{Zt(t,new H(s),i)}),ar(t,e)}}else if(t.children.size>0){const n=V(e);return e=G(e),t.children.has(n)&&ar(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function lr(t,e,n){t.value!==null?n(e,t.value):Gg(t,(s,i)=>{const r=new H(e.toString()+"/"+s);lr(i,r,n)})}function Gg(t,e){t.children.forEach((n,s)=>{e(s,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&le(this.last_,(s,i)=>{n[s]=n[s]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ba=10*1e3,Kg=30*1e3,Yg=5*60*1e3;class qg{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new zg(e);const s=Ba+(Kg-Ba)*Math.random();bn(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;le(e,(i,r)=>{r>0&&De(this.statsToReport_,i)&&(n[i]=r,s=!0)}),s&&this.server_.reportStats(n),bn(this.reportStats_.bind(this),Math.floor(Math.random()*2*Yg))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ee;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Ee||(Ee={}));function Jr(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Zr(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function eo(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=Ee.ACK_USER_WRITE,this.source=Jr()}operationForChild(e){if(B(this.path)){if(this.affectedTree.value!=null)return C(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new H(e));return new Ls(W(),n,this.revert)}}else return C(V(this.path)===e,"operationForChild called for unrelated child."),new Ls(G(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e,n){this.source=e,this.path=n,this.type=Ee.LISTEN_COMPLETE}operationForChild(e){return B(this.path)?new jn(this.source,W()):new jn(this.source,G(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=Ee.OVERWRITE}operationForChild(e){return B(this.path)?new _t(this.source,W(),this.snap.getImmediateChild(e)):new _t(this.source,G(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=Ee.MERGE}operationForChild(e){if(B(this.path)){const n=this.children.subtree(new H(e));return n.isEmpty()?null:n.value?new _t(this.source,W(),n.value):new Ht(this.source,W(),n)}else return C(V(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Ht(this.source,G(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(B(e))return this.isFullyInitialized()&&!this.filtered_;const n=V(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xg{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Qg(t,e,n,s){const i=[],r=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&r.push($g(o.childName,o.snapshotNode))}),hn(t,i,"child_removed",e,s,n),hn(t,i,"child_added",e,s,n),hn(t,i,"child_moved",r,s,n),hn(t,i,"child_changed",e,s,n),hn(t,i,"value",e,s,n),i}function hn(t,e,n,s,i,r){const o=s.filter(a=>a.type===n);o.sort((a,l)=>Zg(t,a,l)),o.forEach(a=>{const l=Jg(t,a,r);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,t.query_))})})}function Jg(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function Zg(t,e,n){if(e.childName==null||n.childName==null)throw Qt("Should only compare child_ events.");const s=new $(e.childName,e.snapshotNode),i=new $(n.childName,n.snapshotNode);return t.index_.compare(s,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ii(t,e){return{eventCache:t,serverCache:e}}function Cn(t,e,n,s){return ii(new nt(e,n,s),t.serverCache)}function Ou(t,e,n,s){return ii(t.eventCache,new nt(e,n,s))}function Os(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function xt(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ni;const ey=()=>(Ni||(Ni=new me(jm)),Ni);class Y{constructor(e,n=ey()){this.value=e,this.children=n}static fromObject(e){let n=new Y(null);return le(e,(s,i)=>{n=n.set(new H(s),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:W(),value:this.value};if(B(e))return null;{const s=V(e),i=this.children.get(s);if(i!==null){const r=i.findRootMostMatchingPathAndValue(G(e),n);return r!=null?{path:Q(new H(s),r.path),value:r.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(B(e))return this;{const n=V(e),s=this.children.get(n);return s!==null?s.subtree(G(e)):new Y(null)}}set(e,n){if(B(e))return new Y(n,this.children);{const s=V(e),r=(this.children.get(s)||new Y(null)).set(G(e),n),o=this.children.insert(s,r);return new Y(this.value,o)}}remove(e){if(B(e))return this.children.isEmpty()?new Y(null):new Y(null,this.children);{const n=V(e),s=this.children.get(n);if(s){const i=s.remove(G(e));let r;return i.isEmpty()?r=this.children.remove(n):r=this.children.insert(n,i),this.value===null&&r.isEmpty()?new Y(null):new Y(this.value,r)}else return this}}get(e){if(B(e))return this.value;{const n=V(e),s=this.children.get(n);return s?s.get(G(e)):null}}setTree(e,n){if(B(e))return n;{const s=V(e),r=(this.children.get(s)||new Y(null)).setTree(G(e),n);let o;return r.isEmpty()?o=this.children.remove(s):o=this.children.insert(s,r),new Y(this.value,o)}}fold(e){return this.fold_(W(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((i,r)=>{s[i]=r.fold_(Q(e,i),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,W(),n)}findOnPath_(e,n,s){const i=this.value?s(n,this.value):!1;if(i)return i;if(B(e))return null;{const r=V(e),o=this.children.get(r);return o?o.findOnPath_(G(e),Q(n,r),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,W(),n)}foreachOnPath_(e,n,s){if(B(e))return this;{this.value&&s(n,this.value);const i=V(e),r=this.children.get(i);return r?r.foreachOnPath_(G(e),Q(n,i),s):new Y(null)}}foreach(e){this.foreach_(W(),e)}foreach_(e,n){this.children.inorderTraversal((s,i)=>{i.foreach_(Q(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.writeTree_=e}static empty(){return new Te(new Y(null))}}function Sn(t,e,n){if(B(e))return new Te(new Y(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const i=s.path;let r=s.value;const o=fe(i,e);return r=r.updateChild(o,n),new Te(t.writeTree_.set(i,r))}else{const i=new Y(n),r=t.writeTree_.setTree(e,i);return new Te(r)}}}function cr(t,e,n){let s=t;return le(n,(i,r)=>{s=Sn(s,Q(e,i),r)}),s}function $a(t,e){if(B(e))return Te.empty();{const n=t.writeTree_.setTree(e,new Y(null));return new Te(n)}}function ur(t,e){return bt(t,e)!=null}function bt(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(fe(n.path,e)):null}function Ua(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Z,(s,i)=>{e.push(new $(s,i))}):t.writeTree_.children.inorderTraversal((s,i)=>{i.value!=null&&e.push(new $(s,i.value))}),e}function Ze(t,e){if(B(e))return t;{const n=bt(t,e);return n!=null?new Te(new Y(n)):new Te(t.writeTree_.subtree(e))}}function hr(t){return t.writeTree_.isEmpty()}function Gt(t,e){return Fu(W(),t.writeTree_,e)}function Fu(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((i,r)=>{i===".priority"?(C(r.value!==null,"Priority writes must always be leaf nodes"),s=r.value):n=Fu(Q(t,i),r,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(Q(t,".priority"),s)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ri(t,e){return $u(e,t)}function ty(t,e,n,s,i){C(s>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:i}),i&&(t.visibleWrites=Sn(t.visibleWrites,e,n)),t.lastWriteId=s}function ny(t,e,n,s){C(s>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:s,visible:!0}),t.visibleWrites=cr(t.visibleWrites,e,n),t.lastWriteId=s}function sy(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function iy(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);C(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let i=s.visible,r=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&ry(a,s.path)?i=!1:we(s.path,a.path)&&(r=!0)),o--}if(i){if(r)return oy(t),!0;if(s.snap)t.visibleWrites=$a(t.visibleWrites,s.path);else{const a=s.children;le(a,l=>{t.visibleWrites=$a(t.visibleWrites,Q(s.path,l))})}return!0}else return!1}function ry(t,e){if(t.snap)return we(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&we(Q(t.path,n),e))return!0;return!1}function oy(t){t.visibleWrites=ju(t.allWrites,ay,W()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function ay(t){return t.visible}function ju(t,e,n){let s=Te.empty();for(let i=0;i<t.length;++i){const r=t[i];if(e(r)){const o=r.path;let a;if(r.snap)we(n,o)?(a=fe(n,o),s=Sn(s,a,r.snap)):we(o,n)&&(a=fe(o,n),s=Sn(s,W(),r.snap.getChild(a)));else if(r.children){if(we(n,o))a=fe(n,o),s=cr(s,a,r.children);else if(we(o,n))if(a=fe(o,n),B(a))s=cr(s,W(),r.children);else{const l=Bt(r.children,V(a));if(l){const c=l.getChild(G(a));s=Sn(s,W(),c)}}}else throw Qt("WriteRecord should have .snap or .children")}}return s}function Vu(t,e,n,s,i){if(!s&&!i){const r=bt(t.visibleWrites,e);if(r!=null)return r;{const o=Ze(t.visibleWrites,e);if(hr(o))return n;if(n==null&&!ur(o,W()))return null;{const a=n||L.EMPTY_NODE;return Gt(o,a)}}}else{const r=Ze(t.visibleWrites,e);if(!i&&hr(r))return n;if(!i&&n==null&&!ur(r,W()))return null;{const o=function(c){return(c.visible||i)&&(!s||!~s.indexOf(c.writeId))&&(we(c.path,e)||we(e,c.path))},a=ju(t.allWrites,o,e),l=n||L.EMPTY_NODE;return Gt(a,l)}}}function ly(t,e,n){let s=L.EMPTY_NODE;const i=bt(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Z,(r,o)=>{s=s.updateImmediateChild(r,o)}),s;if(n){const r=Ze(t.visibleWrites,e);return n.forEachChild(Z,(o,a)=>{const l=Gt(Ze(r,new H(o)),a);s=s.updateImmediateChild(o,l)}),Ua(r).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const r=Ze(t.visibleWrites,e);return Ua(r).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function cy(t,e,n,s,i){C(s||i,"Either existingEventSnap or existingServerSnap must exist");const r=Q(e,n);if(ur(t.visibleWrites,r))return null;{const o=Ze(t.visibleWrites,r);return hr(o)?i.getChild(n):Gt(o,i.getChild(n))}}function uy(t,e,n,s){const i=Q(e,n),r=bt(t.visibleWrites,i);if(r!=null)return r;if(s.isCompleteForChild(n)){const o=Ze(t.visibleWrites,i);return Gt(o,s.getNode().getImmediateChild(n))}else return null}function hy(t,e){return bt(t.visibleWrites,e)}function dy(t,e,n,s,i,r,o){let a;const l=Ze(t.visibleWrites,e),c=bt(l,W());if(c!=null)a=c;else if(n!=null)a=Gt(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const h=[],u=o.getCompare(),d=r?a.getReverseIteratorFrom(s,o):a.getIteratorFrom(s,o);let f=d.getNext();for(;f&&h.length<i;)u(f,s)!==0&&h.push(f),f=d.getNext();return h}else return[]}function fy(){return{visibleWrites:Te.empty(),allWrites:[],lastWriteId:-1}}function Fs(t,e,n,s){return Vu(t.writeTree,t.treePath,e,n,s)}function to(t,e){return ly(t.writeTree,t.treePath,e)}function Wa(t,e,n,s){return cy(t.writeTree,t.treePath,e,n,s)}function js(t,e){return hy(t.writeTree,Q(t.treePath,e))}function py(t,e,n,s,i,r){return dy(t.writeTree,t.treePath,e,n,s,i,r)}function no(t,e,n){return uy(t.writeTree,t.treePath,e,n)}function Bu(t,e){return $u(Q(t.treePath,e),t.writeTree)}function $u(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;C(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),C(s!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(s);if(i){const r=i.type;if(n==="child_added"&&r==="child_removed")this.changeMap.set(s,On(s,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&r==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&r==="child_changed")this.changeMap.set(s,Ln(s,i.oldSnap));else if(n==="child_changed"&&r==="child_added")this.changeMap.set(s,Wt(s,e.snapshotNode));else if(n==="child_changed"&&r==="child_changed")this.changeMap.set(s,On(s,e.snapshotNode,i.oldSnap));else throw Qt("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gy{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const Uu=new gy;class so{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new nt(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return no(this.writes_,e,s)}}getChildAfterChild(e,n,s){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:xt(this.viewCache_),r=py(this.writes_,i,n,1,s,e);return r.length===0?null:r[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yy(t){return{filter:t}}function vy(t,e){C(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),C(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function _y(t,e,n,s,i){const r=new my;let o,a;if(n.type===Ee.OVERWRITE){const c=n;c.source.fromUser?o=dr(t,e,c.path,c.snap,s,i,r):(C(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!B(c.path),o=Vs(t,e,c.path,c.snap,s,i,a,r))}else if(n.type===Ee.MERGE){const c=n;c.source.fromUser?o=wy(t,e,c.path,c.children,s,i,r):(C(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=fr(t,e,c.path,c.children,s,i,a,r))}else if(n.type===Ee.ACK_USER_WRITE){const c=n;c.revert?o=Sy(t,e,c.path,s,i,r):o=by(t,e,c.path,c.affectedTree,s,i,r)}else if(n.type===Ee.LISTEN_COMPLETE)o=Cy(t,e,n.path,s,r);else throw Qt("Unknown operation type: "+n.type);const l=r.getChanges();return xy(e,o,l),{viewCache:o,changes:l}}function xy(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const i=s.getNode().isLeafNode()||s.getNode().isEmpty(),r=Os(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!s.getNode().equals(r)||!s.getNode().getPriority().equals(r.getPriority()))&&n.push(Lu(Os(e)))}}function Wu(t,e,n,s,i,r){const o=e.eventCache;if(js(s,n)!=null)return e;{let a,l;if(B(n))if(C(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=xt(e),h=c instanceof L?c:L.EMPTY_NODE,u=to(s,h);a=t.filter.updateFullNode(e.eventCache.getNode(),u,r)}else{const c=Fs(s,xt(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,r)}else{const c=V(n);if(c===".priority"){C(tt(n)===1,"Can't have a priority with additional path components");const h=o.getNode();l=e.serverCache.getNode();const u=Wa(s,n,h,l);u!=null?a=t.filter.updatePriority(h,u):a=o.getNode()}else{const h=G(n);let u;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();const d=Wa(s,n,o.getNode(),l);d!=null?u=o.getNode().getImmediateChild(c).updateChild(h,d):u=o.getNode().getImmediateChild(c)}else u=no(s,c,e.serverCache);u!=null?a=t.filter.updateChild(o.getNode(),c,u,h,i,r):a=o.getNode()}}return Cn(e,a,o.isFullyInitialized()||B(n),t.filter.filtersNodes())}}function Vs(t,e,n,s,i,r,o,a){const l=e.serverCache;let c;const h=o?t.filter:t.filter.getIndexedFilter();if(B(n))c=h.updateFullNode(l.getNode(),s,null);else if(h.filtersNodes()&&!l.isFiltered()){const f=l.getNode().updateChild(n,s);c=h.updateFullNode(l.getNode(),f,null)}else{const f=V(n);if(!l.isCompleteForPath(n)&&tt(n)>1)return e;const y=G(n),v=l.getNode().getImmediateChild(f).updateChild(y,s);f===".priority"?c=h.updatePriority(l.getNode(),v):c=h.updateChild(l.getNode(),f,v,y,Uu,null)}const u=Ou(e,c,l.isFullyInitialized()||B(n),h.filtersNodes()),d=new so(i,u,r);return Wu(t,u,n,i,d,a)}function dr(t,e,n,s,i,r,o){const a=e.eventCache;let l,c;const h=new so(i,e,r);if(B(n))c=t.filter.updateFullNode(e.eventCache.getNode(),s,o),l=Cn(e,c,!0,t.filter.filtersNodes());else{const u=V(n);if(u===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),s),l=Cn(e,c,a.isFullyInitialized(),a.isFiltered());else{const d=G(n),f=a.getNode().getImmediateChild(u);let y;if(B(d))y=s;else{const p=h.getCompleteChild(u);p!=null?zr(d)===".priority"&&p.getChild(Ru(d)).isEmpty()?y=p:y=p.updateChild(d,s):y=L.EMPTY_NODE}if(f.equals(y))l=e;else{const p=t.filter.updateChild(a.getNode(),u,y,d,h,o);l=Cn(e,p,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function Ha(t,e){return t.eventCache.isCompleteForChild(e)}function wy(t,e,n,s,i,r,o){let a=e;return s.foreach((l,c)=>{const h=Q(n,l);Ha(e,V(h))&&(a=dr(t,a,h,c,i,r,o))}),s.foreach((l,c)=>{const h=Q(n,l);Ha(e,V(h))||(a=dr(t,a,h,c,i,r,o))}),a}function Ga(t,e,n){return n.foreach((s,i)=>{e=e.updateChild(s,i)}),e}function fr(t,e,n,s,i,r,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;B(n)?c=s:c=new Y(null).setTree(n,s);const h=e.serverCache.getNode();return c.children.inorderTraversal((u,d)=>{if(h.hasChild(u)){const f=e.serverCache.getNode().getImmediateChild(u),y=Ga(t,f,d);l=Vs(t,l,new H(u),y,i,r,o,a)}}),c.children.inorderTraversal((u,d)=>{const f=!e.serverCache.isCompleteForChild(u)&&d.value===null;if(!h.hasChild(u)&&!f){const y=e.serverCache.getNode().getImmediateChild(u),p=Ga(t,y,d);l=Vs(t,l,new H(u),p,i,r,o,a)}}),l}function by(t,e,n,s,i,r,o){if(js(i,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(s.value!=null){if(B(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Vs(t,e,n,l.getNode().getChild(n),i,r,a,o);if(B(n)){let c=new Y(null);return l.getNode().forEachChild(Vt,(h,u)=>{c=c.set(new H(h),u)}),fr(t,e,n,c,i,r,a,o)}else return e}else{let c=new Y(null);return s.foreach((h,u)=>{const d=Q(n,h);l.isCompleteForPath(d)&&(c=c.set(h,l.getNode().getChild(d)))}),fr(t,e,n,c,i,r,a,o)}}function Cy(t,e,n,s,i){const r=e.serverCache,o=Ou(e,r.getNode(),r.isFullyInitialized()||B(n),r.isFiltered());return Wu(t,o,n,s,Uu,i)}function Sy(t,e,n,s,i,r){let o;if(js(s,n)!=null)return e;{const a=new so(s,e,i),l=e.eventCache.getNode();let c;if(B(n)||V(n)===".priority"){let h;if(e.serverCache.isFullyInitialized())h=Fs(s,xt(e));else{const u=e.serverCache.getNode();C(u instanceof L,"serverChildren would be complete if leaf node"),h=to(s,u)}h=h,c=t.filter.updateFullNode(l,h,r)}else{const h=V(n);let u=no(s,h,e.serverCache);u==null&&e.serverCache.isCompleteForChild(h)&&(u=l.getImmediateChild(h)),u!=null?c=t.filter.updateChild(l,h,u,G(n),a,r):e.eventCache.getNode().hasChild(h)?c=t.filter.updateChild(l,h,L.EMPTY_NODE,G(n),a,r):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Fs(s,xt(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,r)))}return o=e.serverCache.isFullyInitialized()||js(s,W())!=null,Cn(e,c,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,i=new Xr(s.getIndex()),r=Wg(s);this.processor_=yy(r);const o=n.serverCache,a=n.eventCache,l=i.updateFullNode(L.EMPTY_NODE,o.getNode(),null),c=r.updateFullNode(L.EMPTY_NODE,a.getNode(),null),h=new nt(l,o.isFullyInitialized(),i.filtersNodes()),u=new nt(c,a.isFullyInitialized(),r.filtersNodes());this.viewCache_=ii(u,h),this.eventGenerator_=new Xg(this.query_)}get query(){return this.query_}}function Ty(t){return t.viewCache_.serverCache.getNode()}function Py(t){return Os(t.viewCache_)}function Ry(t,e){const n=xt(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!B(e)&&!n.getImmediateChild(V(e)).isEmpty())?n.getChild(e):null}function za(t){return t.eventRegistrations_.length===0}function Iy(t,e){t.eventRegistrations_.push(e)}function Ka(t,e,n){const s=[];if(n){C(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(r=>{const o=r.createCancelEvent(n,i);o&&s.push(o)})}if(e){let i=[];for(let r=0;r<t.eventRegistrations_.length;++r){const o=t.eventRegistrations_[r];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(r+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return s}function Ya(t,e,n,s){e.type===Ee.MERGE&&e.source.queryId!==null&&(C(xt(t.viewCache_),"We should always have a full cache before handling merges"),C(Os(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,r=_y(t.processor_,i,e,n,s);return vy(t.processor_,r.viewCache),C(r.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=r.viewCache,Hu(t,r.changes,r.viewCache.eventCache.getNode(),null)}function Ny(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Z,(r,o)=>{s.push(Wt(r,o))}),n.isFullyInitialized()&&s.push(Lu(n.getNode())),Hu(t,s,n.getNode(),e)}function Hu(t,e,n,s){const i=s?[s]:t.eventRegistrations_;return Qg(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bs;class Gu{constructor(){this.views=new Map}}function Ay(t){C(!Bs,"__referenceConstructor has already been defined"),Bs=t}function Dy(){return C(Bs,"Reference.ts has not been loaded"),Bs}function ky(t){return t.views.size===0}function io(t,e,n,s){const i=e.source.queryId;if(i!==null){const r=t.views.get(i);return C(r!=null,"SyncTree gave us an op for an invalid query."),Ya(r,e,n,s)}else{let r=[];for(const o of t.views.values())r=r.concat(Ya(o,e,n,s));return r}}function zu(t,e,n,s,i){const r=e._queryIdentifier,o=t.views.get(r);if(!o){let a=Fs(n,i?s:null),l=!1;a?l=!0:s instanceof L?(a=to(n,s),l=!1):(a=L.EMPTY_NODE,l=!1);const c=ii(new nt(a,l,!1),new nt(s,i,!1));return new Ey(e,c)}return o}function My(t,e,n,s,i,r){const o=zu(t,e,s,i,r);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),Iy(o,n),Ny(o,n)}function Ly(t,e,n,s){const i=e._queryIdentifier,r=[];let o=[];const a=st(t);if(i==="default")for(const[l,c]of t.views.entries())o=o.concat(Ka(c,n,s)),za(c)&&(t.views.delete(l),c.query._queryParams.loadsAllData()||r.push(c.query));else{const l=t.views.get(i);l&&(o=o.concat(Ka(l,n,s)),za(l)&&(t.views.delete(i),l.query._queryParams.loadsAllData()||r.push(l.query)))}return a&&!st(t)&&r.push(new(Dy())(e._repo,e._path)),{removed:r,events:o}}function Ku(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function et(t,e){let n=null;for(const s of t.views.values())n=n||Ry(s,e);return n}function Yu(t,e){if(e._queryParams.loadsAllData())return oi(t);{const s=e._queryIdentifier;return t.views.get(s)}}function qu(t,e){return Yu(t,e)!=null}function st(t){return oi(t)!=null}function oi(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $s;function Oy(t){C(!$s,"__referenceConstructor has already been defined"),$s=t}function Fy(){return C($s,"Reference.ts has not been loaded"),$s}let jy=1;class qa{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Y(null),this.pendingWriteTree_=fy(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Xu(t,e,n,s,i){return ty(t.pendingWriteTree_,e,n,s,i),i?en(t,new _t(Jr(),e,n)):[]}function Vy(t,e,n,s){ny(t.pendingWriteTree_,e,n,s);const i=Y.fromObject(n);return en(t,new Ht(Jr(),e,i))}function Xe(t,e,n=!1){const s=sy(t.pendingWriteTree_,e);if(iy(t.pendingWriteTree_,e)){let r=new Y(null);return s.snap!=null?r=r.set(W(),!0):le(s.children,o=>{r=r.set(new H(o),!0)}),en(t,new Ls(s.path,r,n))}else return[]}function Zn(t,e,n){return en(t,new _t(Zr(),e,n))}function By(t,e,n){const s=Y.fromObject(n);return en(t,new Ht(Zr(),e,s))}function $y(t,e){return en(t,new jn(Zr(),e))}function Uy(t,e,n){const s=oo(t,n);if(s){const i=ao(s),r=i.path,o=i.queryId,a=fe(r,e),l=new jn(eo(o),a);return lo(t,r,l)}else return[]}function Us(t,e,n,s,i=!1){const r=e._path,o=t.syncPointTree_.get(r);let a=[];if(o&&(e._queryIdentifier==="default"||qu(o,e))){const l=Ly(o,e,n,s);ky(o)&&(t.syncPointTree_=t.syncPointTree_.remove(r));const c=l.removed;if(a=l.events,!i){const h=c.findIndex(d=>d._queryParams.loadsAllData())!==-1,u=t.syncPointTree_.findOnPath(r,(d,f)=>st(f));if(h&&!u){const d=t.syncPointTree_.subtree(r);if(!d.isEmpty()){const f=Gy(d);for(let y=0;y<f.length;++y){const p=f[y],v=p.query,x=eh(t,p);t.listenProvider_.startListening(En(v),Vn(t,v),x.hashFn,x.onComplete)}}}!u&&c.length>0&&!s&&(h?t.listenProvider_.stopListening(En(e),null):c.forEach(d=>{const f=t.queryToTagMap.get(ai(d));t.listenProvider_.stopListening(En(d),f)}))}zy(t,c)}return a}function Qu(t,e,n,s){const i=oo(t,s);if(i!=null){const r=ao(i),o=r.path,a=r.queryId,l=fe(o,e),c=new _t(eo(a),l,n);return lo(t,o,c)}else return[]}function Wy(t,e,n,s){const i=oo(t,s);if(i){const r=ao(i),o=r.path,a=r.queryId,l=fe(o,e),c=Y.fromObject(n),h=new Ht(eo(a),l,c);return lo(t,o,h)}else return[]}function pr(t,e,n,s=!1){const i=e._path;let r=null,o=!1;t.syncPointTree_.foreachOnPath(i,(d,f)=>{const y=fe(d,i);r=r||et(f,y),o=o||st(f)});let a=t.syncPointTree_.get(i);a?(o=o||st(a),r=r||et(a,W())):(a=new Gu,t.syncPointTree_=t.syncPointTree_.set(i,a));let l;r!=null?l=!0:(l=!1,r=L.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,y)=>{const p=et(y,W());p&&(r=r.updateImmediateChild(f,p))}));const c=qu(a,e);if(!c&&!e._queryParams.loadsAllData()){const d=ai(e);C(!t.queryToTagMap.has(d),"View does not exist, but we have a tag");const f=Ky();t.queryToTagMap.set(d,f),t.tagToQueryMap.set(f,d)}const h=ri(t.pendingWriteTree_,i);let u=My(a,e,n,h,r,l);if(!c&&!o&&!s){const d=Yu(a,e);u=u.concat(Yy(t,e,d))}return u}function ro(t,e,n){const i=t.pendingWriteTree_,r=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=fe(o,e),c=et(a,l);if(c)return c});return Vu(i,e,r,n,!0)}function Hy(t,e){const n=e._path;let s=null;t.syncPointTree_.foreachOnPath(n,(c,h)=>{const u=fe(c,n);s=s||et(h,u)});let i=t.syncPointTree_.get(n);i?s=s||et(i,W()):(i=new Gu,t.syncPointTree_=t.syncPointTree_.set(n,i));const r=s!=null,o=r?new nt(s,!0,!1):null,a=ri(t.pendingWriteTree_,e._path),l=zu(i,e,a,r?o.getNode():L.EMPTY_NODE,r);return Py(l)}function en(t,e){return Ju(e,t.syncPointTree_,null,ri(t.pendingWriteTree_,W()))}function Ju(t,e,n,s){if(B(t.path))return Zu(t,e,n,s);{const i=e.get(W());n==null&&i!=null&&(n=et(i,W()));let r=[];const o=V(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const c=n?n.getImmediateChild(o):null,h=Bu(s,o);r=r.concat(Ju(a,l,c,h))}return i&&(r=r.concat(io(i,t,s,n))),r}}function Zu(t,e,n,s){const i=e.get(W());n==null&&i!=null&&(n=et(i,W()));let r=[];return e.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,c=Bu(s,o),h=t.operationForChild(o);h&&(r=r.concat(Zu(h,a,l,c)))}),i&&(r=r.concat(io(i,t,s,n))),r}function eh(t,e){const n=e.query,s=Vn(t,n);return{hashFn:()=>(Ty(e)||L.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return s?Uy(t,n._path,s):$y(t,n._path);{const r=$m(i,n);return Us(t,n,null,r)}}}}function Vn(t,e){const n=ai(e);return t.queryToTagMap.get(n)}function ai(t){return t._path.toString()+"$"+t._queryIdentifier}function oo(t,e){return t.tagToQueryMap.get(e)}function ao(t){const e=t.indexOf("$");return C(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new H(t.substr(0,e))}}function lo(t,e,n){const s=t.syncPointTree_.get(e);C(s,"Missing sync point for query tag that we're tracking");const i=ri(t.pendingWriteTree_,e);return io(s,n,i,null)}function Gy(t){return t.fold((e,n,s)=>{if(n&&st(n))return[oi(n)];{let i=[];return n&&(i=Ku(n)),le(s,(r,o)=>{i=i.concat(o)}),i}})}function En(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(Fy())(t._repo,t._path):t}function zy(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const i=ai(s),r=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(r)}}}function Ky(){return jy++}function Yy(t,e,n){const s=e._path,i=Vn(t,e),r=eh(t,n),o=t.listenProvider_.startListening(En(e),i,r.hashFn,r.onComplete),a=t.syncPointTree_.subtree(s);if(i)C(!st(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,h,u)=>{if(!B(c)&&h&&st(h))return[oi(h).query];{let d=[];return h&&(d=d.concat(Ku(h).map(f=>f.query))),le(u,(f,y)=>{d=d.concat(y)}),d}});for(let c=0;c<l.length;++c){const h=l[c];t.listenProvider_.stopListening(En(h),Vn(t,h))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new co(n)}node(){return this.node_}}class uo{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Q(this.path_,e);return new uo(this.syncTree_,n)}node(){return ro(this.syncTree_,this.path_)}}const qy=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Xa=function(t,e,n){if(!t||typeof t!="object")return t;if(C(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return Xy(t[".sv"],e,n);if(typeof t[".sv"]=="object")return Qy(t[".sv"],e);C(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},Xy=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:C(!1,"Unexpected server value: "+t)}},Qy=function(t,e,n){t.hasOwnProperty("increment")||C(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&C(!1,"Unexpected increment value: "+s);const i=e.node();if(C(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return s;const o=i.getValue();return typeof o!="number"?s:o+s},th=function(t,e,n,s){return ho(e,new uo(n,t),s)},nh=function(t,e,n){return ho(t,new co(e),n)};function ho(t,e,n){const s=t.getPriority().val(),i=Xa(s,e.getImmediateChild(".priority"),n);let r;if(t.isLeafNode()){const o=t,a=Xa(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new re(a,ne(i)):t}else{const o=t;return r=o,i!==o.getPriority().val()&&(r=r.updatePriority(new re(i))),o.forEachChild(Z,(a,l)=>{const c=ho(l,e.getImmediateChild(a),n);c!==l&&(r=r.updateImmediateChild(a,c))}),r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function po(t,e){let n=e instanceof H?e:new H(e),s=t,i=V(n);for(;i!==null;){const r=Bt(s.node.children,i)||{children:{},childCount:0};s=new fo(i,s,r),n=G(n),i=V(n)}return s}function tn(t){return t.node.value}function sh(t,e){t.node.value=e,mr(t)}function ih(t){return t.node.childCount>0}function Jy(t){return tn(t)===void 0&&!ih(t)}function li(t,e){le(t.node.children,(n,s)=>{e(new fo(n,t,s))})}function rh(t,e,n,s){n&&e(t),li(t,i=>{rh(i,e,!0)})}function Zy(t,e,n){let s=t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function es(t){return new H(t.parent===null?t.name:es(t.parent)+"/"+t.name)}function mr(t){t.parent!==null&&ev(t.parent,t.name,t)}function ev(t,e,n){const s=Jy(n),i=De(t.node.children,e);s&&i?(delete t.node.children[e],t.node.childCount--,mr(t)):!s&&!i&&(t.node.children[e]=n.node,t.node.childCount++,mr(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tv=/[\[\].#$\/\u0000-\u001F\u007F]/,nv=/[\[\].#$\u0000-\u001F\u007F]/,Ai=10*1024*1024,mo=function(t){return typeof t=="string"&&t.length!==0&&!tv.test(t)},oh=function(t){return typeof t=="string"&&t.length!==0&&!nv.test(t)},sv=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),oh(t)},ah=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!ni(t)||t&&typeof t=="object"&&De(t,".sv")},Ws=function(t,e,n,s){s&&e===void 0||ci($t(t,"value"),e,n)},ci=function(t,e,n){const s=n instanceof H?new wg(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+ht(s));if(typeof e=="function")throw new Error(t+"contains a function "+ht(s)+" with contents = "+e.toString());if(ni(e))throw new Error(t+"contains "+e.toString()+" "+ht(s));if(typeof e=="string"&&e.length>Ai/3&&ti(e)>Ai)throw new Error(t+"contains a string greater than "+Ai+" utf8 bytes "+ht(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,r=!1;if(le(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(r=!0,!mo(o)))throw new Error(t+" contains an invalid key ("+o+") "+ht(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);bg(s,o),ci(t,a,s),Cg(s)}),i&&r)throw new Error(t+' contains ".value" child '+ht(s)+" in addition to actual children.")}},iv=function(t,e){let n,s;for(n=0;n<e.length;n++){s=e[n];const r=Mn(s);for(let o=0;o<r.length;o++)if(!(r[o]===".priority"&&o===r.length-1)){if(!mo(r[o]))throw new Error(t+"contains an invalid key ("+r[o]+") in path "+s.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(xg);let i=null;for(n=0;n<e.length;n++){if(s=e[n],i!==null&&we(i,s))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+s.toString());i=s}},lh=function(t,e,n,s){const i=$t(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const r=[];le(e,(o,a)=>{const l=new H(o);if(ci(i,a,Q(n,l)),zr(l)===".priority"&&!ah(a))throw new Error(i+"contains an invalid value for '"+l.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");r.push(l)}),iv(i,r)},rv=function(t,e,n){if(ni(e))throw new Error($t(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!ah(e))throw new Error($t(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},ch=function(t,e,n,s){if(!oh(n))throw new Error($t(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},ov=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ch(t,e,n)},mt=function(t,e){if(V(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},av=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!mo(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!sv(n))throw new Error($t(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ui(t,e){let n=null;for(let s=0;s<e.length;s++){const i=e[s],r=i.getPath();n!==null&&!Kr(r,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:r}),n.events.push(i)}n&&t.eventLists_.push(n)}function uh(t,e,n){ui(t,n),hh(t,s=>Kr(s,e))}function be(t,e,n){ui(t,n),hh(t,s=>we(s,e)||we(e,s))}function hh(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const i=t.eventLists_[s];if(i){const r=i.path;e(r)?(cv(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function cv(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();wn&&ae("event: "+n.toString()),Jt(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uv="repo_interrupt",hv=25;class dv{constructor(e,n,s,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new lv,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ms(),this.transactionQueueTree_=new fo,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function fv(t,e,n){if(t.stats_=Hr(t.repoInfo_),t.forceRestClient_||Gm())t.server_=new ks(t.repoInfo_,(s,i,r,o)=>{Qa(t,s,i,r,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>Ja(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ie(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new je(t.repoInfo_,e,(s,i,r,o)=>{Qa(t,s,i,r,o)},s=>{Ja(t,s)},s=>{pv(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=Xm(t.repoInfo_,()=>new qg(t.stats_,t.server_)),t.infoData_=new Hg,t.infoSyncTree_=new qa({startListening:(s,i,r,o)=>{let a=[];const l=t.infoData_.getNode(s._path);return l.isEmpty()||(a=Zn(t.infoSyncTree_,s._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),go(t,"connected",!1),t.serverSyncTree_=new qa({startListening:(s,i,r,o)=>(t.server_.listen(s,r,i,(a,l)=>{const c=o(a,l);be(t.eventQueue_,s._path,c)}),[]),stopListening:(s,i)=>{t.server_.unlisten(s,i)}})}function dh(t){const n=t.infoData_.getNode(new H(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function hi(t){return qy({timestamp:dh(t)})}function Qa(t,e,n,s,i){t.dataUpdateCount++;const r=new H(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(s){const l=Ps(n,c=>ne(c));o=Wy(t.serverSyncTree_,r,l,i)}else{const l=ne(n);o=Qu(t.serverSyncTree_,r,l,i)}else if(s){const l=Ps(n,c=>ne(c));o=By(t.serverSyncTree_,r,l)}else{const l=ne(n);o=Zn(t.serverSyncTree_,r,l)}let a=r;o.length>0&&(a=zt(t,r)),be(t.eventQueue_,a,o)}function Ja(t,e){go(t,"connected",e),e===!1&&vv(t)}function pv(t,e){le(e,(n,s)=>{go(t,n,s)})}function go(t,e,n){const s=new H("/.info/"+e),i=ne(n);t.infoData_.updateSnapshot(s,i);const r=Zn(t.infoSyncTree_,s,i);be(t.eventQueue_,s,r)}function yo(t){return t.nextWriteId_++}function mv(t,e,n){const s=Hy(t.serverSyncTree_,e);return s!=null?Promise.resolve(s):t.server_.get(e).then(i=>{const r=ne(i).withIndex(e._queryParams.getIndex());pr(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Zn(t.serverSyncTree_,e._path,r);else{const a=Vn(t.serverSyncTree_,e);o=Qu(t.serverSyncTree_,e._path,r,a)}return be(t.eventQueue_,e._path,o),Us(t.serverSyncTree_,e,n,null,!0),r},i=>(ts(t,"get for query "+ie(e)+" failed: "+i),Promise.reject(new Error(i))))}function gv(t,e,n,s,i){ts(t,"set",{path:e.toString(),value:n,priority:s});const r=hi(t),o=ne(n,s),a=ro(t.serverSyncTree_,e),l=nh(o,a,r),c=yo(t),h=Xu(t.serverSyncTree_,e,l,c,!0);ui(t.eventQueue_,h),t.server_.put(e.toString(),o.val(!0),(d,f)=>{const y=d==="ok";y||pe("set at "+e+" failed: "+d);const p=Xe(t.serverSyncTree_,c,!y);be(t.eventQueue_,e,p),it(t,i,d,f)});const u=_o(t,e);zt(t,u),be(t.eventQueue_,u,[])}function yv(t,e,n,s){ts(t,"update",{path:e.toString(),value:n});let i=!0;const r=hi(t),o={};if(le(n,(a,l)=>{i=!1,o[a]=th(Q(e,a),ne(l),t.serverSyncTree_,r)}),i)ae("update() called with empty data.  Don't do anything."),it(t,s,"ok",void 0);else{const a=yo(t),l=Vy(t.serverSyncTree_,e,o,a);ui(t.eventQueue_,l),t.server_.merge(e.toString(),n,(c,h)=>{const u=c==="ok";u||pe("update at "+e+" failed: "+c);const d=Xe(t.serverSyncTree_,a,!u),f=d.length>0?zt(t,e):e;be(t.eventQueue_,f,d),it(t,s,c,h)}),le(n,c=>{const h=_o(t,Q(e,c));zt(t,h)}),be(t.eventQueue_,e,[])}}function vv(t){ts(t,"onDisconnectEvents");const e=hi(t),n=Ms();lr(t.onDisconnect_,W(),(i,r)=>{const o=th(i,r,t.serverSyncTree_,e);Zt(n,i,o)});let s=[];lr(n,W(),(i,r)=>{s=s.concat(Zn(t.serverSyncTree_,i,r));const o=_o(t,i);zt(t,o)}),t.onDisconnect_=Ms(),be(t.eventQueue_,W(),s)}function _v(t,e,n){t.server_.onDisconnectCancel(e.toString(),(s,i)=>{s==="ok"&&ar(t.onDisconnect_,e),it(t,n,s,i)})}function Za(t,e,n,s){const i=ne(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(r,o)=>{r==="ok"&&Zt(t.onDisconnect_,e,i),it(t,s,r,o)})}function xv(t,e,n,s,i){const r=ne(n,s);t.server_.onDisconnectPut(e.toString(),r.val(!0),(o,a)=>{o==="ok"&&Zt(t.onDisconnect_,e,r),it(t,i,o,a)})}function wv(t,e,n,s){if(Qi(n)){ae("onDisconnect().update() called with empty data.  Don't do anything."),it(t,s,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,r)=>{i==="ok"&&le(n,(o,a)=>{const l=ne(a);Zt(t.onDisconnect_,Q(e,o),l)}),it(t,s,i,r)})}function bv(t,e,n){let s;V(e._path)===".info"?s=pr(t.infoSyncTree_,e,n):s=pr(t.serverSyncTree_,e,n),uh(t.eventQueue_,e._path,s)}function fh(t,e,n){let s;V(e._path)===".info"?s=Us(t.infoSyncTree_,e,n):s=Us(t.serverSyncTree_,e,n),uh(t.eventQueue_,e._path,s)}function Cv(t){t.persistentConnection_&&t.persistentConnection_.interrupt(uv)}function ts(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),ae(n,...e)}function it(t,e,n,s){e&&Jt(()=>{if(n==="ok")e(null);else{const i=(n||"error").toUpperCase();let r=i;s&&(r+=": "+s);const o=new Error(r);o.code=i,e(o)}})}function ph(t,e,n){return ro(t.serverSyncTree_,e,n)||L.EMPTY_NODE}function vo(t,e=t.transactionQueueTree_){if(e||di(t,e),tn(e)){const n=gh(t,e);C(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&Sv(t,es(e),n)}else ih(e)&&li(e,n=>{vo(t,n)})}function Sv(t,e,n){const s=n.map(c=>c.currentWriteId),i=ph(t,e,s);let r=i;const o=i.hash();for(let c=0;c<n.length;c++){const h=n[c];C(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;const u=fe(e,h.path);r=r.updateChild(u,h.currentOutputSnapshotRaw)}const a=r.val(!0),l=e;t.server_.put(l.toString(),a,c=>{ts(t,"transaction put response",{path:l.toString(),status:c});let h=[];if(c==="ok"){const u=[];for(let d=0;d<n.length;d++)n[d].status=2,h=h.concat(Xe(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&u.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();di(t,po(t.transactionQueueTree_,e)),vo(t,t.transactionQueueTree_),be(t.eventQueue_,e,h);for(let d=0;d<u.length;d++)Jt(u[d])}else{if(c==="datastale")for(let u=0;u<n.length;u++)n[u].status===3?n[u].status=4:n[u].status=0;else{pe("transaction at "+l.toString()+" failed: "+c);for(let u=0;u<n.length;u++)n[u].status=4,n[u].abortReason=c}zt(t,e)}},o)}function zt(t,e){const n=mh(t,e),s=es(n),i=gh(t,n);return Ev(t,i,s),s}function Ev(t,e,n){if(e.length===0)return;const s=[];let i=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=fe(n,l.path);let h=!1,u;if(C(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)h=!0,u=l.abortReason,i=i.concat(Xe(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=hv)h=!0,u="maxretry",i=i.concat(Xe(t.serverSyncTree_,l.currentWriteId,!0));else{const d=ph(t,l.path,o);l.currentInputSnapshot=d;const f=e[a].update(d.val());if(f!==void 0){ci("transaction failed: Data returned ",f,l.path);let y=ne(f);typeof f=="object"&&f!=null&&De(f,".priority")||(y=y.updatePriority(d.getPriority()));const v=l.currentWriteId,x=hi(t),_=nh(y,d,x);l.currentOutputSnapshotRaw=y,l.currentOutputSnapshotResolved=_,l.currentWriteId=yo(t),o.splice(o.indexOf(v),1),i=i.concat(Xu(t.serverSyncTree_,l.path,_,l.currentWriteId,l.applyLocally)),i=i.concat(Xe(t.serverSyncTree_,v,!0))}else h=!0,u="nodata",i=i.concat(Xe(t.serverSyncTree_,l.currentWriteId,!0))}be(t.eventQueue_,n,i),i=[],h&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(u==="nodata"?s.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):s.push(()=>e[a].onComplete(new Error(u),!1,null))))}di(t,t.transactionQueueTree_);for(let a=0;a<s.length;a++)Jt(s[a]);vo(t,t.transactionQueueTree_)}function mh(t,e){let n,s=t.transactionQueueTree_;for(n=V(e);n!==null&&tn(s)===void 0;)s=po(s,n),e=G(e),n=V(e);return s}function gh(t,e){const n=[];return yh(t,e,n),n.sort((s,i)=>s.order-i.order),n}function yh(t,e,n){const s=tn(e);if(s)for(let i=0;i<s.length;i++)n.push(s[i]);li(e,i=>{yh(t,i,n)})}function di(t,e){const n=tn(e);if(n){let s=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[s]=n[i],s++);n.length=s,sh(e,n.length>0?n:void 0)}li(e,s=>{di(t,s)})}function _o(t,e){const n=es(mh(t,e)),s=po(t.transactionQueueTree_,e);return Zy(s,i=>{Di(t,i)}),Di(t,s),rh(s,i=>{Di(t,i)}),n}function Di(t,e){const n=tn(e);if(n){const s=[];let i=[],r=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(C(r===o-1,"All SENT items should be at beginning of queue."),r=o,n[o].status=3,n[o].abortReason="set"):(C(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Xe(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&s.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));r===-1?sh(e,void 0):n.length=r+1,be(t.eventQueue_,es(e),i);for(let o=0;o<s.length;o++)Jt(s[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tv(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let i=n[s];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function Pv(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):pe(`Invalid query segment '${n}' in query '${t}'`)}return e}const el=function(t,e){const n=Rv(t),s=n.namespace;n.domain==="firebase.com"&&We(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&We("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||Om();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new _u(n.host,n.secure,s,i,e,"",s!==n.subdomain),path:new H(n.pathString)}},Rv=function(t){let e="",n="",s="",i="",r="",o=!0,a="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let h=t.indexOf("/");h===-1&&(h=t.length);let u=t.indexOf("?");u===-1&&(u=t.length),e=t.substring(0,Math.min(h,u)),h<u&&(i=Tv(t.substring(h,u)));const d=Pv(t.substring(Math.min(t.length,u)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const f=e.slice(0,c);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{const y=e.indexOf(".");s=e.substring(0,y).toLowerCase(),n=e.substring(y+1),r=s}"ns"in d&&(r=d.ns)}return{host:e,port:l,domain:n,subdomain:s,secure:o,scheme:a,pathString:i,namespace:r}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tl="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",Iv=function(){let t=0;const e=[];return function(n){const s=n===t;t=n;let i;const r=new Array(8);for(i=7;i>=0;i--)r[i]=tl.charAt(n%64),n=Math.floor(n/64);C(n===0,"Cannot push at time == 0");let o=r.join("");if(s){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=tl.charAt(e[i]);return C(o.length===20,"nextPushId: Length should be 20."),o}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(e,n,s,i){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ie(this.snapshot.exportVal())}}class Av{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return C(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new Pe;return _v(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){mt("OnDisconnect.remove",this._path);const e=new Pe;return Za(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){mt("OnDisconnect.set",this._path),Ws("OnDisconnect.set",e,this._path,!1);const n=new Pe;return Za(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){mt("OnDisconnect.setWithPriority",this._path),Ws("OnDisconnect.setWithPriority",e,this._path,!1),rv("OnDisconnect.setWithPriority",n);const s=new Pe;return xv(this._repo,this._path,e,n,s.wrapCallback(()=>{})),s.promise}update(e){mt("OnDisconnect.update",this._path),lh("OnDisconnect.update",e,this._path);const n=new Pe;return wv(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e,n,s,i){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=i}get key(){return B(this._path)?null:zr(this._path)}get ref(){return new ze(this._repo,this._path)}get _queryIdentifier(){const e=Va(this._queryParams),n=Ur(e);return n==="{}"?"default":n}get _queryObject(){return Va(this._queryParams)}isEqual(e){if(e=at(e),!(e instanceof xo))return!1;const n=this._repo===e._repo,s=Kr(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&s&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+_g(this._path)}}class ze extends xo{constructor(e,n){super(e,n,new Qr,!1)}get parent(){const e=Ru(this._path);return e===null?null:new ze(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Bn{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new H(e),s=$n(this.ref,e);return new Bn(this._node.getChild(n),s,Z)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,i)=>e(new Bn(i,$n(this.ref,s),Z)))}hasChild(e){const n=new H(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function z(t,e){return t=at(t),t._checkNotDeleted("ref"),e!==void 0?$n(t._root,e):t._root}function $n(t,e){return t=at(t),V(t._path)===null?ov("child","path",e):ch("child","path",e),new ze(t._repo,Q(t._path,e))}function yn(t){return t=at(t),new Dv(t._repo,t._path)}function xs(t,e){t=at(t),mt("push",t._path),Ws("push",e,t._path,!0);const n=dh(t._repo),s=Iv(n),i=$n(t,s),r=$n(t,s);let o;return o=Promise.resolve(r),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function Le(t){return mt("remove",t._path),Re(t,null)}function Re(t,e){t=at(t),mt("set",t._path),Ws("set",e,t._path,!1);const n=new Pe;return gv(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function kv(t,e){lh("update",e,t._path);const n=new Pe;return yv(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function Mv(t){t=at(t);const e=new vh(()=>{}),n=new fi(e);return mv(t._repo,t,n).then(s=>new Bn(s,new ze(t._repo,t._path),t._queryParams.getIndex()))}class fi{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new Nv("value",this,new Bn(e.snapshotNode,new ze(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Av(this,e,n):null}matches(e){return e instanceof fi?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function Lv(t,e,n,s,i){const r=new vh(n,void 0),o=new fi(r);return bv(t._repo,t,o),()=>fh(t._repo,t,o)}function Fe(t,e,n,s){return Lv(t,"value",e)}function qe(t,e,n){fh(t._repo,t,null)}Ay(ze);Oy(ze);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ov="FIREBASE_DATABASE_EMULATOR_HOST",gr={};let Fv=!1;function jv(t,e,n,s){t.repoInfo_=new _u(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),s&&(t.authTokenProvider_=s)}function Vv(t,e,n,s,i){let r=s||t.options.databaseURL;r===void 0&&(t.options.projectId||We("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ae("Using default host for project ",t.options.projectId),r=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=el(r,i),a=o.repoInfo,l;typeof process<"u"&&wa&&(l=wa[Ov]),l?(r=`http://${l}?ns=${a.namespace}`,o=el(r,i),a=o.repoInfo):o.repoInfo.secure;const c=new Km(t.name,t.options,e);av("Invalid Firebase Database URL",o),B(o.path)||We("Database URL must point to the root of a Firebase Database (not including a child path).");const h=$v(a,t,c,new zm(t.name,n));return new Uv(h,t)}function Bv(t,e){const n=gr[e];(!n||n[t.key]!==t)&&We(`Database ${e}(${t.repoInfo_}) has already been deleted.`),Cv(t),delete n[t.key]}function $v(t,e,n,s){let i=gr[e.name];i||(i={},gr[e.name]=i);let r=i[t.toURLString()];return r&&We("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new dv(t,Fv,n,s),i[t.toURLString()]=r,r}class Uv{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(fv(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ze(this._repo,W())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Bv(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&We("Cannot call "+e+" on a deleted database.")}}function Wv(t=vm(),e){const n=pm(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const s=sp("database");s&&Hv(n,...s)}return n}function Hv(t,e,n,s={}){t=at(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&We("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let r;if(i.repoInfo_.nodeAdmin)s.mockUserToken&&We('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),r=new _s(_s.OWNER);else if(s.mockUserToken){const o=typeof s.mockUserToken=="string"?s.mockUserToken:ip(s.mockUserToken,t.app.options.projectId);r=new _s(o)}jv(i,e,n,r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gv(t){Nm(ym),Is(new An("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),r=e.getProvider("app-check-internal");return Vv(s,i,r,n)},"PUBLIC").setMultipleInstances(!0)),Ft(ba,Ca,t),Ft(ba,Ca,"esm2017")}je.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};je.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};Gv();const zv={apiKey:"AIzaSyD_0KiG32r0nbl1IKitAboEVS4a9rvAqU0",authDomain:"players-ac5cf.firebaseapp.com",databaseURL:"https://players-ac5cf-default-rtdb.europe-west1.firebasedatabase.app",projectId:"players-ac5cf",storageBucket:"players-ac5cf.firebasestorage.app",messagingSenderId:"287145504979",appId:"1:287145504979:web:6d89629a89458d515fa426"},Kv=nu(zv),K=Wv(Kv);function _h(){const[t,e]=m.useState(0),[n,s]=m.useState(!1),i=m.useRef(Math.random().toString(36).substring(7));return m.useEffect(()=>{const r=z(K,".info/connected");Fe(r,a=>{const l=a.val()===!0;if(s(l),l){const c=z(K,`presence/${i.current}`);Re(c,{online:!0,timestamp:Date.now()}),yn(c).remove()}});const o=z(K,"presence");return Fe(o,a=>{const l=a.exists()?Object.keys(a.val()).length:0;e(l)}),()=>{qe(r),qe(o);const a=z(K,`presence/${i.current}`);Le(a)}},[]),{onlinePlayers:t,isConnected:n}}var wo={};Object.defineProperty(wo,"__esModule",{value:!0});wo.parse=e_;wo.serialize=t_;const Yv=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,qv=/^[\u0021-\u003A\u003C-\u007E]*$/,Xv=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,Qv=/^[\u0020-\u003A\u003D-\u007E]*$/,Jv=Object.prototype.toString,Zv=(()=>{const t=function(){};return t.prototype=Object.create(null),t})();function e_(t,e){const n=new Zv,s=t.length;if(s<2)return n;const i=(e==null?void 0:e.decode)||n_;let r=0;do{const o=t.indexOf("=",r);if(o===-1)break;const a=t.indexOf(";",r),l=a===-1?s:a;if(o>l){r=t.lastIndexOf(";",o-1)+1;continue}const c=nl(t,r,o),h=sl(t,o,c),u=t.slice(c,h);if(n[u]===void 0){let d=nl(t,o+1,l),f=sl(t,l,d);const y=i(t.slice(d,f));n[u]=y}r=l+1}while(r<s);return n}function nl(t,e,n){do{const s=t.charCodeAt(e);if(s!==32&&s!==9)return e}while(++e<n);return n}function sl(t,e,n){for(;e>n;){const s=t.charCodeAt(--e);if(s!==32&&s!==9)return e+1}return n}function t_(t,e,n){const s=(n==null?void 0:n.encode)||encodeURIComponent;if(!Yv.test(t))throw new TypeError(`argument name is invalid: ${t}`);const i=s(e);if(!qv.test(i))throw new TypeError(`argument val is invalid: ${e}`);let r=t+"="+i;if(!n)return r;if(n.maxAge!==void 0){if(!Number.isInteger(n.maxAge))throw new TypeError(`option maxAge is invalid: ${n.maxAge}`);r+="; Max-Age="+n.maxAge}if(n.domain){if(!Xv.test(n.domain))throw new TypeError(`option domain is invalid: ${n.domain}`);r+="; Domain="+n.domain}if(n.path){if(!Qv.test(n.path))throw new TypeError(`option path is invalid: ${n.path}`);r+="; Path="+n.path}if(n.expires){if(!s_(n.expires)||!Number.isFinite(n.expires.valueOf()))throw new TypeError(`option expires is invalid: ${n.expires}`);r+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(r+="; HttpOnly"),n.secure&&(r+="; Secure"),n.partitioned&&(r+="; Partitioned"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():void 0){case"low":r+="; Priority=Low";break;case"medium":r+="; Priority=Medium";break;case"high":r+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${n.priority}`)}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":r+="; SameSite=Strict";break;case"lax":r+="; SameSite=Lax";break;case"none":r+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${n.sameSite}`)}return r}function n_(t){if(t.indexOf("%")===-1)return t;try{return decodeURIComponent(t)}catch{return t}}function s_(t){return Jv.call(t)==="[object Date]"}var il="popstate";function i_(t={}){function e(s,i){let{pathname:r,search:o,hash:a}=s.location;return yr("",{pathname:r,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(s,i){return typeof i=="string"?i:Un(i)}return o_(e,n,null,t)}function ee(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ae(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function r_(){return Math.random().toString(36).substring(2,10)}function rl(t,e){return{usr:t.state,key:t.key,idx:e}}function yr(t,e,n=null,s){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?nn(e):e,state:n,key:e&&e.key||s||r_()}}function Un({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function nn(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substring(s),t=t.substring(0,s)),t&&(e.pathname=t)}return e}function o_(t,e,n,s={}){let{window:i=document.defaultView,v5Compat:r=!1}=s,o=i.history,a="POP",l=null,c=h();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function h(){return(o.state||{idx:null}).idx}function u(){a="POP";let v=h(),x=v==null?null:v-c;c=v,l&&l({action:a,location:p.location,delta:x})}function d(v,x){a="PUSH";let _=yr(p.location,v,x);c=h()+1;let w=rl(_,c),P=p.createHref(_);try{o.pushState(w,"",P)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;i.location.assign(P)}r&&l&&l({action:a,location:p.location,delta:1})}function f(v,x){a="REPLACE";let _=yr(p.location,v,x);c=h();let w=rl(_,c),P=p.createHref(_);o.replaceState(w,"",P),r&&l&&l({action:a,location:p.location,delta:0})}function y(v){let x=i.location.origin!=="null"?i.location.origin:i.location.href,_=typeof v=="string"?v:Un(v);return _=_.replace(/ $/,"%20"),ee(x,`No window.location.(origin|href) available to create URL for href: ${_}`),new URL(_,x)}let p={get action(){return a},get location(){return t(i,o)},listen(v){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(il,u),l=v,()=>{i.removeEventListener(il,u),l=null}},createHref(v){return e(i,v)},createURL:y,encodeLocation(v){let x=y(v);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:d,replace:f,go(v){return o.go(v)}};return p}function xh(t,e,n="/"){return a_(t,e,n,!1)}function a_(t,e,n,s){let i=typeof e=="string"?nn(e):e,r=He(i.pathname||"/",n);if(r==null)return null;let o=wh(t);l_(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=__(r);a=y_(o[l],c,s)}return a}function wh(t,e=[],n=[],s=""){let i=(r,o,a)=>{let l={relativePath:a===void 0?r.path||"":a,caseSensitive:r.caseSensitive===!0,childrenIndex:o,route:r};l.relativePath.startsWith("/")&&(ee(l.relativePath.startsWith(s),`Absolute route path "${l.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(s.length));let c=Ve([s,l.relativePath]),h=n.concat(l);r.children&&r.children.length>0&&(ee(r.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),wh(r.children,e,h,c)),!(r.path==null&&!r.index)&&e.push({path:c,score:m_(c,r.index),routesMeta:h})};return t.forEach((r,o)=>{var a;if(r.path===""||!((a=r.path)!=null&&a.includes("?")))i(r,o);else for(let l of bh(r.path))i(r,o,l)}),e}function bh(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,i=n.endsWith("?"),r=n.replace(/\?$/,"");if(s.length===0)return i?[r,""]:[r];let o=bh(s.join("/")),a=[];return a.push(...o.map(l=>l===""?r:[r,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function l_(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:g_(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}var c_=/^:[\w-]+$/,u_=3,h_=2,d_=1,f_=10,p_=-2,ol=t=>t==="*";function m_(t,e){let n=t.split("/"),s=n.length;return n.some(ol)&&(s+=p_),e&&(s+=h_),n.filter(i=>!ol(i)).reduce((i,r)=>i+(c_.test(r)?u_:r===""?d_:f_),s)}function g_(t,e){return t.length===e.length&&t.slice(0,-1).every((s,i)=>s===e[i])?t[t.length-1]-e[e.length-1]:0}function y_(t,e,n=!1){let{routesMeta:s}=t,i={},r="/",o=[];for(let a=0;a<s.length;++a){let l=s[a],c=a===s.length-1,h=r==="/"?e:e.slice(r.length)||"/",u=Hs({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},h),d=l.route;if(!u&&c&&n&&!s[s.length-1].route.index&&(u=Hs({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!u)return null;Object.assign(i,u.params),o.push({params:i,pathname:Ve([r,u.pathname]),pathnameBase:C_(Ve([r,u.pathnameBase])),route:d}),u.pathnameBase!=="/"&&(r=Ve([r,u.pathnameBase]))}return o}function Hs(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=v_(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let r=i[0],o=r.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:s.reduce((c,{paramName:h,isOptional:u},d)=>{if(h==="*"){let y=a[d]||"";o=r.slice(0,r.length-y.length).replace(/(.)\/+$/,"$1")}const f=a[d];return u&&!f?c[h]=void 0:c[h]=(f||"").replace(/%2F/g,"/"),c},{}),pathname:r,pathnameBase:o,pattern:t}}function v_(t,e=!1,n=!0){Ae(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let s=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),s]}function __(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ae(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function He(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function x_(t,e="/"){let{pathname:n,search:s="",hash:i=""}=typeof t=="string"?nn(t):t;return{pathname:n?n.startsWith("/")?n:w_(n,e):e,search:S_(s),hash:E_(i)}}function w_(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function ki(t,e,n,s){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function b_(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Ch(t){let e=b_(t);return e.map((n,s)=>s===e.length-1?n.pathname:n.pathnameBase)}function Sh(t,e,n,s=!1){let i;typeof t=="string"?i=nn(t):(i={...t},ee(!i.pathname||!i.pathname.includes("?"),ki("?","pathname","search",i)),ee(!i.pathname||!i.pathname.includes("#"),ki("#","pathname","hash",i)),ee(!i.search||!i.search.includes("#"),ki("#","search","hash",i)));let r=t===""||i.pathname==="",o=r?"/":i.pathname,a;if(o==null)a=n;else{let u=e.length-1;if(!s&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),u-=1;i.pathname=d.join("/")}a=u>=0?e[u]:"/"}let l=x_(i,a),c=o&&o!=="/"&&o.endsWith("/"),h=(r||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||h)&&(l.pathname+="/"),l}var Ve=t=>t.join("/").replace(/\/\/+/g,"/"),C_=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),S_=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,E_=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function T_(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var Eh=["POST","PUT","PATCH","DELETE"];new Set(Eh);var P_=["GET",...Eh];new Set(P_);var sn=m.createContext(null);sn.displayName="DataRouter";var pi=m.createContext(null);pi.displayName="DataRouterState";var Th=m.createContext({isTransitioning:!1});Th.displayName="ViewTransition";var R_=m.createContext(new Map);R_.displayName="Fetchers";var I_=m.createContext(null);I_.displayName="Await";var ke=m.createContext(null);ke.displayName="Navigation";var ns=m.createContext(null);ns.displayName="Location";var Ke=m.createContext({outlet:null,matches:[],isDataRoute:!1});Ke.displayName="Route";var bo=m.createContext(null);bo.displayName="RouteError";function N_(t,{relative:e}={}){ee(ss(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:s}=m.useContext(ke),{hash:i,pathname:r,search:o}=is(t,{relative:e}),a=r;return n!=="/"&&(a=r==="/"?n:Ve([n,r])),s.createHref({pathname:a,search:o,hash:i})}function ss(){return m.useContext(ns)!=null}function Ct(){return ee(ss(),"useLocation() may be used only in the context of a <Router> component."),m.useContext(ns).location}var Ph="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Rh(t){m.useContext(ke).static||m.useLayoutEffect(t)}function Ih(){let{isDataRoute:t}=m.useContext(Ke);return t?W_():A_()}function A_(){ee(ss(),"useNavigate() may be used only in the context of a <Router> component.");let t=m.useContext(sn),{basename:e,navigator:n}=m.useContext(ke),{matches:s}=m.useContext(Ke),{pathname:i}=Ct(),r=JSON.stringify(Ch(s)),o=m.useRef(!1);return Rh(()=>{o.current=!0}),m.useCallback((l,c={})=>{if(Ae(o.current,Ph),!o.current)return;if(typeof l=="number"){n.go(l);return}let h=Sh(l,JSON.parse(r),i,c.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ve([e,h.pathname])),(c.replace?n.replace:n.push)(h,c.state,c)},[e,n,r,i,t])}m.createContext(null);function is(t,{relative:e}={}){let{matches:n}=m.useContext(Ke),{pathname:s}=Ct(),i=JSON.stringify(Ch(n));return m.useMemo(()=>Sh(t,JSON.parse(i),s,e==="path"),[t,i,s,e])}function D_(t,e){return Nh(t,e)}function Nh(t,e,n,s){var _;ee(ss(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i,static:r}=m.useContext(ke),{matches:o}=m.useContext(Ke),a=o[o.length-1],l=a?a.params:{},c=a?a.pathname:"/",h=a?a.pathnameBase:"/",u=a&&a.route;{let w=u&&u.path||"";Ah(c,!u||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${c}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let d=Ct(),f;if(e){let w=typeof e=="string"?nn(e):e;ee(h==="/"||((_=w.pathname)==null?void 0:_.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${w.pathname}" was given in the \`location\` prop.`),f=w}else f=d;let y=f.pathname||"/",p=y;if(h!=="/"){let w=h.replace(/^\//,"").split("/");p="/"+y.replace(/^\//,"").split("/").slice(w.length).join("/")}let v=!r&&n&&n.matches&&n.matches.length>0?n.matches:xh(t,{pathname:p});Ae(u||v!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),Ae(v==null||v[v.length-1].route.element!==void 0||v[v.length-1].route.Component!==void 0||v[v.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let x=F_(v&&v.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:Ve([h,i.encodeLocation?i.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?h:Ve([h,i.encodeLocation?i.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),o,n,s);return e&&x?m.createElement(ns.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},x):x}function k_(){let t=U_(),e=T_(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:s},r={padding:"2px 4px",backgroundColor:s},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=m.createElement(m.Fragment,null,m.createElement("p",null," Hey developer "),m.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",m.createElement("code",{style:r},"ErrorBoundary")," or"," ",m.createElement("code",{style:r},"errorElement")," prop on your route.")),m.createElement(m.Fragment,null,m.createElement("h2",null,"Unexpected Application Error!"),m.createElement("h3",{style:{fontStyle:"italic"}},e),n?m.createElement("pre",{style:i},n):null,o)}var M_=m.createElement(k_,null),L_=class extends m.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?m.createElement(Ke.Provider,{value:this.props.routeContext},m.createElement(bo.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function O_({routeContext:t,match:e,children:n}){let s=m.useContext(sn);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),m.createElement(Ke.Provider,{value:t},n)}function F_(t,e=[],n=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,r=n==null?void 0:n.errors;if(r!=null){let l=i.findIndex(c=>c.route.id&&(r==null?void 0:r[c.route.id])!==void 0);ee(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(r).join(",")}`),i=i.slice(0,Math.min(i.length,l+1))}let o=!1,a=-1;if(n)for(let l=0;l<i.length;l++){let c=i[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(a=l),c.route.id){let{loaderData:h,errors:u}=n,d=c.route.loader&&!h.hasOwnProperty(c.route.id)&&(!u||u[c.route.id]===void 0);if(c.route.lazy||d){o=!0,a>=0?i=i.slice(0,a+1):i=[i[0]];break}}}return i.reduceRight((l,c,h)=>{let u,d=!1,f=null,y=null;n&&(u=r&&c.route.id?r[c.route.id]:void 0,f=c.route.errorElement||M_,o&&(a<0&&h===0?(Ah("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,y=null):a===h&&(d=!0,y=c.route.hydrateFallbackElement||null)));let p=e.concat(i.slice(0,h+1)),v=()=>{let x;return u?x=f:d?x=y:c.route.Component?x=m.createElement(c.route.Component,null):c.route.element?x=c.route.element:x=l,m.createElement(O_,{match:c,routeContext:{outlet:l,matches:p,isDataRoute:n!=null},children:x})};return n&&(c.route.ErrorBoundary||c.route.errorElement||h===0)?m.createElement(L_,{location:n.location,revalidation:n.revalidation,component:f,error:u,children:v(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):v()},null)}function Co(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function j_(t){let e=m.useContext(sn);return ee(e,Co(t)),e}function V_(t){let e=m.useContext(pi);return ee(e,Co(t)),e}function B_(t){let e=m.useContext(Ke);return ee(e,Co(t)),e}function So(t){let e=B_(t),n=e.matches[e.matches.length-1];return ee(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function $_(){return So("useRouteId")}function U_(){var s;let t=m.useContext(bo),e=V_("useRouteError"),n=So("useRouteError");return t!==void 0?t:(s=e.errors)==null?void 0:s[n]}function W_(){let{router:t}=j_("useNavigate"),e=So("useNavigate"),n=m.useRef(!1);return Rh(()=>{n.current=!0}),m.useCallback(async(i,r={})=>{Ae(n.current,Ph),n.current&&(typeof i=="number"?t.navigate(i):await t.navigate(i,{fromRouteId:e,...r}))},[t,e])}var al={};function Ah(t,e,n){!e&&!al[t]&&(al[t]=!0,Ae(!1,n))}m.memo(H_);function H_({routes:t,future:e,state:n}){return Nh(t,void 0,n,e)}function vr(t){ee(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function G_({basename:t="/",children:e=null,location:n,navigationType:s="POP",navigator:i,static:r=!1}){ee(!ss(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),a=m.useMemo(()=>({basename:o,navigator:i,static:r,future:{}}),[o,i,r]);typeof n=="string"&&(n=nn(n));let{pathname:l="/",search:c="",hash:h="",state:u=null,key:d="default"}=n,f=m.useMemo(()=>{let y=He(l,o);return y==null?null:{location:{pathname:y,search:c,hash:h,state:u,key:d},navigationType:s}},[o,l,c,h,u,d,s]);return Ae(f!=null,`<Router basename="${o}"> is not able to match the URL "${l}${c}${h}" because it does not start with the basename, so the <Router> won't render anything.`),f==null?null:m.createElement(ke.Provider,{value:a},m.createElement(ns.Provider,{children:e,value:f}))}function z_({children:t,location:e}){return D_(_r(t),e)}function _r(t,e=[]){let n=[];return m.Children.forEach(t,(s,i)=>{if(!m.isValidElement(s))return;let r=[...e,i];if(s.type===m.Fragment){n.push.apply(n,_r(s.props.children,r));return}ee(s.type===vr,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ee(!s.props.index||!s.props.children,"An index route cannot have child routes.");let o={id:s.props.id||r.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=_r(s.props.children,r)),n.push(o)}),n}var ws="get",bs="application/x-www-form-urlencoded";function mi(t){return t!=null&&typeof t.tagName=="string"}function K_(t){return mi(t)&&t.tagName.toLowerCase()==="button"}function Y_(t){return mi(t)&&t.tagName.toLowerCase()==="form"}function q_(t){return mi(t)&&t.tagName.toLowerCase()==="input"}function X_(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Q_(t,e){return t.button===0&&(!e||e==="_self")&&!X_(t)}var fs=null;function J_(){if(fs===null)try{new FormData(document.createElement("form"),0),fs=!1}catch{fs=!0}return fs}var Z_=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Mi(t){return t!=null&&!Z_.has(t)?(Ae(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${bs}"`),null):t}function e0(t,e){let n,s,i,r,o;if(Y_(t)){let a=t.getAttribute("action");s=a?He(a,e):null,n=t.getAttribute("method")||ws,i=Mi(t.getAttribute("enctype"))||bs,r=new FormData(t)}else if(K_(t)||q_(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(s=l?He(l,e):null,n=t.getAttribute("formmethod")||a.getAttribute("method")||ws,i=Mi(t.getAttribute("formenctype"))||Mi(a.getAttribute("enctype"))||bs,r=new FormData(a,t),!J_()){let{name:c,type:h,value:u}=t;if(h==="image"){let d=c?`${c}.`:"";r.append(`${d}x`,"0"),r.append(`${d}y`,"0")}else c&&r.append(c,u)}}else{if(mi(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=ws,s=null,i=bs,o=t}return r&&i==="text/plain"&&(o=r,r=void 0),{action:s,method:n.toLowerCase(),encType:i,formData:r,body:o}}function Eo(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function t0(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function n0(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function s0(t,e,n){let s=await Promise.all(t.map(async i=>{let r=e.routes[i.route.id];if(r){let o=await t0(r,n);return o.links?o.links():[]}return[]}));return a0(s.flat(1).filter(n0).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function ll(t,e,n,s,i,r){let o=(l,c)=>n[c]?l.route.id!==n[c].route.id:!0,a=(l,c)=>{var h;return n[c].pathname!==l.pathname||((h=n[c].route.path)==null?void 0:h.endsWith("*"))&&n[c].params["*"]!==l.params["*"]};return r==="assets"?e.filter((l,c)=>o(l,c)||a(l,c)):r==="data"?e.filter((l,c)=>{var u;let h=s.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(o(l,c)||a(l,c))return!0;if(l.route.shouldRevalidate){let d=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((u=n[0])==null?void 0:u.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof d=="boolean")return d}return!0}):[]}function i0(t,e,{includeHydrateFallback:n}={}){return r0(t.map(s=>{let i=e.routes[s.route.id];if(!i)return[];let r=[i.module];return i.clientActionModule&&(r=r.concat(i.clientActionModule)),i.clientLoaderModule&&(r=r.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(r=r.concat(i.hydrateFallbackModule)),i.imports&&(r=r.concat(i.imports)),r}).flat(1))}function r0(t){return[...new Set(t)]}function o0(t){let e={},n=Object.keys(t).sort();for(let s of n)e[s]=t[s];return e}function a0(t,e){let n=new Set;return new Set(e),t.reduce((s,i)=>{let r=JSON.stringify(o0(i));return n.has(r)||(n.add(r),s.push({key:r,link:i})),s},[])}var l0=new Set([100,101,204,205]);function c0(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&He(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function Dh(){let t=m.useContext(sn);return Eo(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function u0(){let t=m.useContext(pi);return Eo(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var To=m.createContext(void 0);To.displayName="FrameworkContext";function kh(){let t=m.useContext(To);return Eo(t,"You must render this element inside a <HydratedRouter> element"),t}function h0(t,e){let n=m.useContext(To),[s,i]=m.useState(!1),[r,o]=m.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:c,onMouseLeave:h,onTouchStart:u}=e,d=m.useRef(null);m.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let p=x=>{x.forEach(_=>{o(_.isIntersecting)})},v=new IntersectionObserver(p,{threshold:.5});return d.current&&v.observe(d.current),()=>{v.disconnect()}}},[t]),m.useEffect(()=>{if(s){let p=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(p)}}},[s]);let f=()=>{i(!0)},y=()=>{i(!1),o(!1)};return n?t!=="intent"?[r,d,{}]:[r,d,{onFocus:dn(a,f),onBlur:dn(l,y),onMouseEnter:dn(c,f),onMouseLeave:dn(h,y),onTouchStart:dn(u,f)}]:[!1,d,{}]}function dn(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function d0({page:t,...e}){let{router:n}=Dh(),s=m.useMemo(()=>xh(n.routes,t,n.basename),[n.routes,t,n.basename]);return s?m.createElement(p0,{page:t,matches:s,...e}):null}function f0(t){let{manifest:e,routeModules:n}=kh(),[s,i]=m.useState([]);return m.useEffect(()=>{let r=!1;return s0(t,e,n).then(o=>{r||i(o)}),()=>{r=!0}},[t,e,n]),s}function p0({page:t,matches:e,...n}){let s=Ct(),{manifest:i,routeModules:r}=kh(),{basename:o}=Dh(),{loaderData:a,matches:l}=u0(),c=m.useMemo(()=>ll(t,e,l,i,s,"data"),[t,e,l,i,s]),h=m.useMemo(()=>ll(t,e,l,i,s,"assets"),[t,e,l,i,s]),u=m.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let y=new Set,p=!1;if(e.forEach(x=>{var w;let _=i.routes[x.route.id];!_||!_.hasLoader||(!c.some(P=>P.route.id===x.route.id)&&x.route.id in a&&((w=r[x.route.id])!=null&&w.shouldRevalidate)||_.hasClientLoader?p=!0:y.add(x.route.id))}),y.size===0)return[];let v=c0(t,o);return p&&y.size>0&&v.searchParams.set("_routes",e.filter(x=>y.has(x.route.id)).map(x=>x.route.id).join(",")),[v.pathname+v.search]},[o,a,s,i,c,e,t,r]),d=m.useMemo(()=>i0(h,i),[h,i]),f=f0(h);return m.createElement(m.Fragment,null,u.map(y=>m.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...n})),d.map(y=>m.createElement("link",{key:y,rel:"modulepreload",href:y,...n})),f.map(({key:y,link:p})=>m.createElement("link",{key:y,...p})))}function m0(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var Mh=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Mh&&(window.__reactRouterVersion="7.5.3")}catch{}function g0({basename:t,children:e,window:n}){let s=m.useRef();s.current==null&&(s.current=i_({window:n,v5Compat:!0}));let i=s.current,[r,o]=m.useState({action:i.action,location:i.location}),a=m.useCallback(l=>{m.startTransition(()=>o(l))},[o]);return m.useLayoutEffect(()=>i.listen(a),[i,a]),m.createElement(G_,{basename:t,children:e,location:r.location,navigationType:r.action,navigator:i})}var Lh=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Gs=m.forwardRef(function({onClick:e,discover:n="render",prefetch:s="none",relative:i,reloadDocument:r,replace:o,state:a,target:l,to:c,preventScrollReset:h,viewTransition:u,...d},f){let{basename:y}=m.useContext(ke),p=typeof c=="string"&&Lh.test(c),v,x=!1;if(typeof c=="string"&&p&&(v=c,Mh))try{let I=new URL(window.location.href),E=c.startsWith("//")?new URL(I.protocol+c):new URL(c),b=He(E.pathname,y);E.origin===I.origin&&b!=null?c=b+E.search+E.hash:x=!0}catch{Ae(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=N_(c,{relative:i}),[w,P,R]=h0(s,d),T=x0(c,{replace:o,state:a,target:l,preventScrollReset:h,relative:i,viewTransition:u});function O(I){e&&e(I),I.defaultPrevented||T(I)}let D=m.createElement("a",{...d,...R,href:v||_,onClick:x||r?e:O,ref:m0(f,P),target:l,"data-discover":!p&&n==="render"?"true":void 0});return w&&!p?m.createElement(m.Fragment,null,D,m.createElement(d0,{page:_})):D});Gs.displayName="Link";var y0=m.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:s="",end:i=!1,style:r,to:o,viewTransition:a,children:l,...c},h){let u=is(o,{relative:c.relative}),d=Ct(),f=m.useContext(pi),{navigator:y,basename:p}=m.useContext(ke),v=f!=null&&E0(u)&&a===!0,x=y.encodeLocation?y.encodeLocation(u).pathname:u.pathname,_=d.pathname,w=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;n||(_=_.toLowerCase(),w=w?w.toLowerCase():null,x=x.toLowerCase()),w&&p&&(w=He(w,p)||w);const P=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let R=_===x||!i&&_.startsWith(x)&&_.charAt(P)==="/",T=w!=null&&(w===x||!i&&w.startsWith(x)&&w.charAt(x.length)==="/"),O={isActive:R,isPending:T,isTransitioning:v},D=R?e:void 0,I;typeof s=="function"?I=s(O):I=[s,R?"active":null,T?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let E=typeof r=="function"?r(O):r;return m.createElement(Gs,{...c,"aria-current":D,className:I,ref:h,style:E,to:o,viewTransition:a},typeof l=="function"?l(O):l)});y0.displayName="NavLink";var v0=m.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:s,replace:i,state:r,method:o=ws,action:a,onSubmit:l,relative:c,preventScrollReset:h,viewTransition:u,...d},f)=>{let y=C0(),p=S0(a,{relative:c}),v=o.toLowerCase()==="get"?"get":"post",x=typeof a=="string"&&Lh.test(a),_=w=>{if(l&&l(w),w.defaultPrevented)return;w.preventDefault();let P=w.nativeEvent.submitter,R=(P==null?void 0:P.getAttribute("formmethod"))||o;y(P||w.currentTarget,{fetcherKey:e,method:R,navigate:n,replace:i,state:r,relative:c,preventScrollReset:h,viewTransition:u})};return m.createElement("form",{ref:f,method:v,action:p,onSubmit:s?l:_,...d,"data-discover":!x&&t==="render"?"true":void 0})});v0.displayName="Form";function _0(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Oh(t){let e=m.useContext(sn);return ee(e,_0(t)),e}function x0(t,{target:e,replace:n,state:s,preventScrollReset:i,relative:r,viewTransition:o}={}){let a=Ih(),l=Ct(),c=is(t,{relative:r});return m.useCallback(h=>{if(Q_(h,e)){h.preventDefault();let u=n!==void 0?n:Un(l)===Un(c);a(t,{replace:u,state:s,preventScrollReset:i,relative:r,viewTransition:o})}},[l,a,c,n,s,e,t,i,r,o])}var w0=0,b0=()=>`__${String(++w0)}__`;function C0(){let{router:t}=Oh("useSubmit"),{basename:e}=m.useContext(ke),n=$_();return m.useCallback(async(s,i={})=>{let{action:r,method:o,encType:a,formData:l,body:c}=e0(s,e);if(i.navigate===!1){let h=i.fetcherKey||b0();await t.fetch(h,n,i.action||r,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||o,formEncType:i.encType||a,flushSync:i.flushSync})}else await t.navigate(i.action||r,{preventScrollReset:i.preventScrollReset,formData:l,body:c,formMethod:i.method||o,formEncType:i.encType||a,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[t,e,n])}function S0(t,{relative:e}={}){let{basename:n}=m.useContext(ke),s=m.useContext(Ke);ee(s,"useFormAction must be used inside a RouteContext");let[i]=s.matches.slice(-1),r={...is(t||".",{relative:e})},o=Ct();if(t==null){r.search=o.search;let a=new URLSearchParams(r.search),l=a.getAll("index");if(l.some(h=>h==="")){a.delete("index"),l.filter(u=>u).forEach(u=>a.append("index",u));let h=a.toString();r.search=h?`?${h}`:""}}return(!t||t===".")&&i.route.index&&(r.search=r.search?r.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(r.pathname=r.pathname==="/"?n:Ve([n,r.pathname])),Un(r)}function E0(t,e={}){let n=m.useContext(Th);ee(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=Oh("useViewTransitionState"),i=is(t,{relative:e.relative});if(!n.isTransitioning)return!1;let r=He(n.currentLocation.pathname,s)||n.currentLocation.pathname,o=He(n.nextLocation.pathname,s)||n.nextLocation.pathname;return Hs(i.pathname,o)!=null||Hs(i.pathname,r)!=null}new TextEncoder;[...l0];const T0=()=>{const{onlinePlayers:t,isConnected:e}=_h();return g.jsx("nav",{className:"bg-white bg-opacity-10 backdrop-blur-lg border-b border-white/10",children:g.jsx("div",{className:"container mx-auto px-4",children:g.jsxs("div",{className:"flex items-center justify-between h-16",children:[g.jsxs(Gs,{to:"/",className:"flex items-center gap-2",children:[g.jsx(Cf,{className:"text-pink-500",size:28}),g.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-pink-500 to-violet-500 text-transparent bg-clip-text",children:"2Players.io"})]}),g.jsxs("div",{className:"flex items-center gap-6",children:[e&&t>0&&g.jsxs("div",{className:"hidden sm:flex items-center gap-2 text-sm text-green-400",children:[g.jsx("span",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),t," online"]}),g.jsx(Gs,{to:"/play",className:"px-4 py-2 bg-gradient-to-r from-pink-500 to-violet-500 text-white rounded-lg hover:opacity-90 transition",children:"Play Now"})]})]})})})},P0={},cl=t=>{let e;const n=new Set,s=(h,u)=>{const d=typeof h=="function"?h(e):h;if(!Object.is(d,e)){const f=e;e=u??(typeof d!="object"||d===null)?d:Object.assign({},e,d),n.forEach(y=>y(e,f))}},i=()=>e,l={setState:s,getState:i,getInitialState:()=>c,subscribe:h=>(n.add(h),()=>n.delete(h)),destroy:()=>{(P0?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=e=t(s,i,l);return l},R0=t=>t?cl(t):cl;var Fh={exports:{}},jh={},Vh={exports:{}},Bh={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kt=m;function I0(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var N0=typeof Object.is=="function"?Object.is:I0,A0=Kt.useState,D0=Kt.useEffect,k0=Kt.useLayoutEffect,M0=Kt.useDebugValue;function L0(t,e){var n=e(),s=A0({inst:{value:n,getSnapshot:e}}),i=s[0].inst,r=s[1];return k0(function(){i.value=n,i.getSnapshot=e,Li(i)&&r({inst:i})},[t,n,e]),D0(function(){return Li(i)&&r({inst:i}),t(function(){Li(i)&&r({inst:i})})},[t]),M0(n),n}function Li(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!N0(t,n)}catch{return!0}}function O0(t,e){return e()}var F0=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?O0:L0;Bh.useSyncExternalStore=Kt.useSyncExternalStore!==void 0?Kt.useSyncExternalStore:F0;Vh.exports=Bh;var j0=Vh.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gi=m,V0=j0;function B0(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var $0=typeof Object.is=="function"?Object.is:B0,U0=V0.useSyncExternalStore,W0=gi.useRef,H0=gi.useEffect,G0=gi.useMemo,z0=gi.useDebugValue;jh.useSyncExternalStoreWithSelector=function(t,e,n,s,i){var r=W0(null);if(r.current===null){var o={hasValue:!1,value:null};r.current=o}else o=r.current;r=G0(function(){function l(f){if(!c){if(c=!0,h=f,f=s(f),i!==void 0&&o.hasValue){var y=o.value;if(i(y,f))return u=y}return u=f}if(y=u,$0(h,f))return y;var p=s(f);return i!==void 0&&i(y,p)?(h=f,y):(h=f,u=p)}var c=!1,h,u,d=n===void 0?null:n;return[function(){return l(e())},d===null?void 0:function(){return l(d())}]},[e,n,s,i]);var a=U0(t,r[0],r[1]);return H0(function(){o.hasValue=!0,o.value=a},[a]),z0(a),a};Fh.exports=jh;var K0=Fh.exports;const Y0=Sf(K0),$h={},{useDebugValue:q0}=jc,{useSyncExternalStoreWithSelector:X0}=Y0;let ul=!1;const Q0=t=>t;function J0(t,e=Q0,n){($h?"production":void 0)!=="production"&&n&&!ul&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),ul=!0);const s=X0(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return q0(s),s}const Z0=t=>{($h?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?R0(t):t,n=(s,i)=>J0(e,s,i);return Object.assign(n,e),n},ex=t=>Z0,tx={};function nx(t,e){let n;try{n=t()}catch{return}return{getItem:i=>{var r;const o=l=>l===null?null:JSON.parse(l,void 0),a=(r=n.getItem(i))!=null?r:null;return a instanceof Promise?a.then(o):o(a)},setItem:(i,r)=>n.setItem(i,JSON.stringify(r,void 0)),removeItem:i=>n.removeItem(i)}}const Wn=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(s){return Wn(s)(n)},catch(s){return this}}}catch(n){return{then(s){return this},catch(s){return Wn(s)(n)}}}},sx=(t,e)=>(n,s,i)=>{let r={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:v=>v,version:0,merge:(v,x)=>({...x,...v}),...e},o=!1;const a=new Set,l=new Set;let c;try{c=r.getStorage()}catch{}if(!c)return t((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),n(...v)},s,i);const h=Wn(r.serialize),u=()=>{const v=r.partialize({...s()});let x;const _=h({state:v,version:r.version}).then(w=>c.setItem(r.name,w)).catch(w=>{x=w});if(x)throw x;return _},d=i.setState;i.setState=(v,x)=>{d(v,x),u()};const f=t((...v)=>{n(...v),u()},s,i);let y;const p=()=>{var v;if(!c)return;o=!1,a.forEach(_=>_(s()));const x=((v=r.onRehydrateStorage)==null?void 0:v.call(r,s()))||void 0;return Wn(c.getItem.bind(c))(r.name).then(_=>{if(_)return r.deserialize(_)}).then(_=>{if(_)if(typeof _.version=="number"&&_.version!==r.version){if(r.migrate)return r.migrate(_.state,_.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return _.state}).then(_=>{var w;return y=r.merge(_,(w=s())!=null?w:f),n(y,!0),u()}).then(()=>{x==null||x(y,void 0),o=!0,l.forEach(_=>_(y))}).catch(_=>{x==null||x(void 0,_)})};return i.persist={setOptions:v=>{r={...r,...v},v.getStorage&&(c=v.getStorage())},clearStorage:()=>{c==null||c.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>p(),hasHydrated:()=>o,onHydrate:v=>(a.add(v),()=>{a.delete(v)}),onFinishHydration:v=>(l.add(v),()=>{l.delete(v)})},p(),y||f},ix=(t,e)=>(n,s,i)=>{let r={storage:nx(()=>localStorage),partialize:p=>p,version:0,merge:(p,v)=>({...v,...p}),...e},o=!1;const a=new Set,l=new Set;let c=r.storage;if(!c)return t((...p)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),n(...p)},s,i);const h=()=>{const p=r.partialize({...s()});return c.setItem(r.name,{state:p,version:r.version})},u=i.setState;i.setState=(p,v)=>{u(p,v),h()};const d=t((...p)=>{n(...p),h()},s,i);i.getInitialState=()=>d;let f;const y=()=>{var p,v;if(!c)return;o=!1,a.forEach(_=>{var w;return _((w=s())!=null?w:d)});const x=((v=r.onRehydrateStorage)==null?void 0:v.call(r,(p=s())!=null?p:d))||void 0;return Wn(c.getItem.bind(c))(r.name).then(_=>{if(_)if(typeof _.version=="number"&&_.version!==r.version){if(r.migrate)return[!0,r.migrate(_.state,_.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,_.state];return[!1,void 0]}).then(_=>{var w;const[P,R]=_;if(f=r.merge(R,(w=s())!=null?w:d),n(f,!0),P)return h()}).then(()=>{x==null||x(f,void 0),f=s(),o=!0,l.forEach(_=>_(f))}).catch(_=>{x==null||x(void 0,_)})};return i.persist={setOptions:p=>{r={...r,...p},p.storage&&(c=p.storage)},clearStorage:()=>{c==null||c.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>y(),hasHydrated:()=>o,onHydrate:p=>(a.add(p),()=>{a.delete(p)}),onFinishHydration:p=>(l.add(p),()=>{l.delete(p)})},r.skipHydration||y(),f||d},rx=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((tx?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),sx(t,e)):ix(t,e),ox=rx,hl=()=>{const t=["Swift","Bold","Clever","Quick","Lucky","Brave","Cool","Epic","Fierce","Great"],e=["Player","Gamer","Champion","Hero","Master","Legend","Star","Ace","Pro","Wizard"],n=Math.floor(Math.random()*999)+1,s=t[Math.floor(Math.random()*t.length)],i=e[Math.floor(Math.random()*e.length)];return`${s}${i}${n}`},Po=ex()(ox(t=>({username:hl(),communicationType:null,hasCompletedSetup:!1,mediaPermissionsGranted:!1,setUsername:e=>t({username:e}),setCommunicationType:e=>t({communicationType:e}),setMediaPermissionsGranted:e=>t({mediaPermissionsGranted:e}),completeSetup:()=>t({hasCompletedSetup:!0}),resetGuest:()=>t({username:hl(),communicationType:null,hasCompletedSetup:!1,mediaPermissionsGranted:!1})}),{name:"2players-guest"})),dl=({onGameEnd:t,isHost:e,sendGameState:n})=>{const[s,i]=m.useState(Array(9).fill(null)),[r,o]=m.useState(!0),[a,l]=m.useState(!1),c=e&&r||!e&&!r;m.useEffect(()=>{const p=v=>{const x=v.detail;x.type==="tictactoe"&&(i(x.board),o(x.isXNext))};return window.addEventListener("game_state",p),()=>{window.removeEventListener("game_state",p)}},[]);const h=p=>{if(!c||s[p]||Oi(s)||a)return;const v=[...s];v[p]=e?"X":"O",i(v),o(!r),n({type:"tictactoe",board:v,isXNext:!r});const x=Oi(v);(x||v.every(_=>_))&&(l(!0),setTimeout(()=>t(x),1500))},u=p=>{const v=s[p];return g.jsxs("button",{className:`w-24 h-24 bg-white bg-opacity-10 rounded-lg flex items-center justify-center transition
          ${c&&!v?"hover:bg-opacity-20":""}
          ${v==="X"?"text-pink-500":"text-violet-500"}
          ${!c||a?"cursor-not-allowed":"cursor-pointer"}`,onClick:()=>h(p),disabled:!c||a,children:[v==="X"&&g.jsx(Ef,{size:40}),v==="O"&&g.jsx(Tf,{size:40})]},p)},d=Oi(s),f=!d&&s.every(p=>p),y=d?`Winner: ${d==="X"?"Player 1":"Player 2"}`:f?"It's a draw!":c?"Your turn":"Opponent's turn";return g.jsxs("div",{className:"flex flex-col items-center",children:[g.jsx("h3",{className:`text-xl font-bold mb-4 ${d?"text-green-500":f?"text-yellow-500":"text-white"}`,children:y}),g.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:Array(9).fill(null).map((p,v)=>u(v))}),g.jsx("div",{className:"mt-4 text-sm text-gray-400",children:e?"You are Player 1 (X)":"You are Player 2 (O)"})]})};function Oi(t){const e=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const[n,s,i]of e)if(t[n]&&t[n]===t[s]&&t[n]===t[i])return t[n];return null}const ps=10,fn=[5,4,3,3,2],fl=({onGameEnd:t,isHost:e,sendGameState:n})=>{const[s,i]=m.useState(x()),[r,o]=m.useState(x()),[a,l]=m.useState(!0),[c,h]=m.useState(0),[u,d]=m.useState(!1),[f,y]=m.useState(e),[p,v]=m.useState(!1);m.useEffect(()=>{const b=S=>{const N=S.detail;N.type==="battleships"&&(N.action==="shot"?R(N.position):N.action==="result"&&T(N.position,N.hit))};return window.addEventListener("game_state",b),()=>window.removeEventListener("game_state",b)},[]);function x(){return Array(ps).fill(null).map(()=>Array(ps).fill("empty"))}function _(b,S,N,A,j){if(j){if(S+A>ps)return!1;for(let F=0;F<A;F++)if(b[S+F][N]!=="empty")return!1}else{if(N+A>ps)return!1;for(let F=0;F<A;F++)if(b[S][N+F]!=="empty")return!1}return!0}function w(b,S){if(c>=fn.length)return;const N=fn[c];if(!_(s,b,S,N,u))return;const A=s.map(j=>[...j]);if(u)for(let j=0;j<N;j++)A[b+j][S]="ship";else for(let j=0;j<N;j++)A[b][S+j]="ship";i(A),h(c+1),c===fn.length-1&&(l(!1),n({type:"battleships",action:"ready"}))}function P(b,S,N){if(!p){if(a&&!N)w(b,S);else if(!a&&N&&f){if(r[b][S]==="hit"||r[b][S]==="miss")return;n({type:"battleships",action:"shot",position:{row:b,col:S}}),y(!1)}}}function R(b){const S=s[b.row][b.col]==="ship",N=s.map(A=>[...A]);N[b.row][b.col]=S?"hit":"miss",i(N),n({type:"battleships",action:"result",position:b,hit:S}),O(N)&&(v(!0),t("opponent"))}function T(b,S){const N=r.map(A=>[...A]);N[b.row][b.col]=S?"hit":"miss",o(N),y(!0),O(N)&&(v(!0),t("you"))}function O(b){return!b.some(S=>S.some(N=>N==="ship"))}function D(b,S){return g.jsx("div",{className:"grid grid-cols-10 gap-1 bg-slate-800 p-4 rounded-lg",children:b.map((N,A)=>N.map((j,F)=>g.jsx("button",{onClick:()=>P(A,F,S),disabled:a?S:!f||p,className:`
                w-10 h-10 rounded-md flex items-center justify-center transition
                ${I(j,S)}
                ${S&&!p?"hover:bg-opacity-50":""}
              `,children:E(j,S)},`${A}-${F}`)))})}function I(b,S){return b==="empty"?"bg-slate-700":b==="ship"&&!S?"bg-blue-500":b==="hit"?"bg-red-500":b==="miss"?"bg-slate-600":"bg-slate-700"}function E(b,S){return b==="ship"&&!S?g.jsx(Pf,{className:"w-6 h-6 text-white"}):b==="hit"?g.jsx(Rf,{className:"w-6 h-6 text-white"}):b==="miss"?g.jsx(If,{className:"w-6 h-6 text-gray-400"}):null}return g.jsxs("div",{className:"flex flex-col items-center gap-8",children:[g.jsxs("div",{className:"text-center",children:[g.jsx("h2",{className:"text-2xl font-bold mb-2",children:p?"Game Over!":a?"Place Your Ships":f?"Your Turn":"Opponent's Turn"}),a&&c<fn.length&&g.jsxs("div",{className:"flex flex-col items-center gap-2",children:[g.jsxs("p",{children:["Placing ship of length ",fn[c]]}),g.jsx("button",{onClick:()=>d(!u),className:"px-4 py-2 bg-blue-500 rounded-lg hover:bg-blue-600 transition",children:u?"Vertical":"Horizontal"})]})]}),g.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-bold mb-4 text-center",children:"Your Board"}),D(s,!1)]}),g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-bold mb-4 text-center",children:"Opponent's Board"}),D(r,!0)]})]})]})},pl=({onGameEnd:t,isHost:e,sendGameState:n})=>{const[s,i]=m.useState(v()),[r,o]=m.useState(!0),[a,l]=m.useState([]),[c,h]=m.useState(!1),[u,d]=m.useState(null),[f,y]=m.useState(null),p=e===r;m.useEffect(()=>{const I=E=>{const b=E.detail;b.type==="checkers"&&(i(b.data.board),o(b.data.isRedTurn),b.data.winner&&(d(b.data.winner),setTimeout(()=>t(b.data.winner),1500)))};return window.addEventListener("game_state",I),()=>{window.removeEventListener("game_state",I)}},[t]),m.useEffect(()=>{const I=w(s,r);h(I.length>0)},[s,r]);function v(){const I=Array(8).fill(null).map(()=>Array(8).fill(null));for(let E=0;E<3;E++)for(let b=0;b<8;b++)(E+b)%2===1&&(I[E][b]={isKing:!1,isRed:!0});for(let E=5;E<8;E++)for(let b=0;b<8;b++)(E+b)%2===1&&(I[E][b]={isKing:!1,isRed:!1});return I}function x(I,E){const b=s[I][E];if(!b)return[];const S=_(s,I,E);if(c)return S;const N=[...S];return(b.isKing?[-1,1]:[b.isRed?1:-1]).forEach(j=>{[-1,1].forEach(F=>{const k=I+j,U=E+F;k>=0&&k<8&&U>=0&&U<8&&!s[k][U]&&N.push({row:k,col:U})})}),N}function _(I,E,b){const S=I[E][b];if(!S)return[];const N=[];return(S.isKing?[-1,1]:[S.isRed?1:-1]).forEach(j=>{[-1,1].forEach(F=>{const k=E+j*2,U=b+F*2,de=E+j,ve=b+F;k>=0&&k<8&&U>=0&&U<8&&!I[k][U]&&I[de][ve]&&I[de][ve].isRed!==S.isRed&&N.push({row:k,col:U})})}),N}function w(I,E){const b=[];for(let S=0;S<8;S++)for(let N=0;N<8;N++){const A=I[S][N];if(A&&A.isRed===E){const j=_(I,S,N);b.push(...j)}}return b}function P(I){let E=!1,b=!1;for(let S=0;S<8;S++)for(let N=0;N<8;N++){const A=I[S][N];if(A&&(A.isRed?E=!0:b=!0,E&&b))return null}return E?"red":"black"}const R=(I,E,b)=>{if(!p||u||!s[I][E])return;const S=s[I][E];if(S&&S.isRed===r){y({row:I,col:E});const N=x(I,E);l(N);const A=document.createElement("div");A.className=`w-12 h-12 rounded-full ${S.isRed?"bg-red-600":"bg-white"}`,document.body.appendChild(A),b.dataTransfer.setDragImage(A,30,30),setTimeout(()=>document.body.removeChild(A),0)}},T=I=>{I.preventDefault()},O=(I,E)=>{if(!f||!p||u)return;if(a.some(S=>S.row===I&&S.col===E)){const S=s.map(A=>[...A]);if(S[I][E]=S[f.row][f.col],S[f.row][f.col]=null,Math.abs(I-f.row)===2){const A=f.row+Math.sign(I-f.row),j=f.col+Math.sign(E-f.col);S[A][j]=null}S[I][E]&&(I===0||I===7)&&(S[I][E].isKing=!0);const N=P(S);N&&(d(N),setTimeout(()=>t(N),1500)),i(S),o(!r),l([]),y(null),n({type:"checkers",data:{board:S,isRedTurn:!r,winner:N}})}},D=()=>{l([]),y(null)};return g.jsxs("div",{className:"flex flex-col items-center",children:[g.jsx("div",{className:`mb-4 text-xl font-bold ${u?"text-green-500":""}`,children:u?`${u==="red"?"Red":"White"} Wins!`:p?"Your Turn":"Opponent's Turn"}),g.jsx("div",{className:"grid grid-cols-8 gap-0 bg-amber-900 p-2 rounded-lg shadow-xl",children:s.map((I,E)=>I.map((b,S)=>{const N=a.some(A=>A.row===E&&A.col===S);return g.jsx("div",{className:`
                  w-16 h-16 flex items-center justify-center
                  ${(E+S)%2===0?"bg-amber-200":"bg-amber-800"}
                  ${N?"ring-2 ring-green-400":""}
                  transition-all duration-200
                `,onDragOver:T,onDrop:()=>O(E,S),children:b&&g.jsx("div",{draggable:p&&b.isRed===r,onDragStart:A=>R(E,S,A),onDragEnd:D,className:`
                      w-12 h-12 rounded-full flex items-center justify-center
                      ${b.isRed?"bg-red-600":"bg-white shadow-lg"}
                      ${b.isKing?"ring-2 ring-yellow-400":""}
                      ${p&&b.isRed===r?"cursor-grab active:cursor-grabbing":"cursor-default"}
                      transform transition-transform duration-200
                      hover:scale-105
                    `,children:b.isKing&&g.jsx(Nf,{className:`w-6 h-6 ${b.isRed?"text-yellow-400":"text-amber-400"}`})})},`${E}-${S}`)}))}),g.jsx("div",{className:"mt-4 text-sm text-gray-400",children:e?"You are Red":"You are White"})]})},Me=20,ax=20,lx=150;function ml({onGameEnd:t,sendGameState:e}){const[n,s]=m.useState([{x:10,y:10}]),[i,r]=m.useState({x:15,y:15}),[o,a]=m.useState("RIGHT"),[l,c]=m.useState(0),[h,u]=m.useState(!1),d=m.useCallback(()=>{const p={x:Math.floor(Math.random()*Me),y:Math.floor(Math.random()*Me)};r(p),e&&e({type:"food",position:p})},[e]),f=p=>p.x<0||p.x>=Me||p.y<0||p.y>=Me?!0:n.slice(1).some(v=>v.x===p.x&&v.y===p.y),y=m.useCallback(()=>{h||s(p=>{const v={...p[0]};switch(o){case"UP":v.y-=1;break;case"DOWN":v.y+=1;break;case"LEFT":v.x-=1;break;case"RIGHT":v.x+=1;break}if(f(v))return u(!0),t==null||t(l.toString()),p;const x=[v,...p];return v.x===i.x&&v.y===i.y?(c(_=>_+1),d()):x.pop(),e&&e({type:"snake",positions:x}),x})},[o,i,h,d,t,l,e]);return m.useEffect(()=>{const p=v=>{switch(v.key){case"ArrowUp":a("UP");break;case"ArrowDown":a("DOWN");break;case"ArrowLeft":a("LEFT");break;case"ArrowRight":a("RIGHT");break}};return document.addEventListener("keydown",p),()=>document.removeEventListener("keydown",p)},[]),m.useEffect(()=>{const p=setInterval(y,lx);return()=>clearInterval(p)},[y]),g.jsxs("div",{className:"flex flex-col items-center gap-4",children:[g.jsxs("div",{className:"text-xl font-bold text-white",children:["Score: ",l]}),g.jsx("div",{className:"grid bg-black/20 backdrop-blur-sm rounded-lg p-4",style:{gridTemplateColumns:`repeat(${Me}, ${ax}px)`,gap:"1px"},children:Array.from({length:Me*Me}).map((p,v)=>{const x=v%Me,_=Math.floor(v/Me),w=n.some(R=>R.x===x&&R.y===_),P=i.x===x&&i.y===_;return g.jsx("div",{className:`w-5 h-5 rounded-sm ${w?"bg-green-500":P?"bg-red-500":"bg-white/5"}`},v)})}),h&&g.jsx("div",{className:"text-red-500 text-xl font-bold",children:"Game Over!"})]})}const Tt=800,Pt=400,pn=10,Rt=100,mn=10,gl=5;function yl({onGameEnd:t,isHost:e,sendGameState:n}){const s=m.useRef(null),[i,r]=m.useState(Tt/2),[o,a]=m.useState(Tt/2),[l,c]=m.useState({x:Tt/2,y:Pt/2}),[h,u]=m.useState({x:gl,y:gl}),[d,f]=m.useState(0);return m.useEffect(()=>{const y=s.current;if(!y)return;const p=y.getContext("2d");if(!p)return;const v=setInterval(()=>{p.clearRect(0,0,Tt,Pt),p.fillStyle="#fff",p.fillRect(i-Rt/2,0,Rt,pn),p.fillRect(o-Rt/2,Pt-pn,Rt,pn),p.beginPath(),p.arc(l.x,l.y,mn,0,Math.PI*2),p.fill(),c(_=>({x:_.x+h.x,y:_.y+h.y})),(l.x<=mn||l.x>=Tt-mn)&&u(_=>({..._,x:-_.x})),(l.y<=pn+mn&&Math.abs(l.x-i)<Rt/2||l.y>=Pt-pn-mn&&Math.abs(l.x-o)<Rt/2)&&(u(_=>({..._,y:-_.y})),f(_=>_+1)),(l.y<=0||l.y>=Pt)&&(clearInterval(v),t==null||t("Score: "+d))},1e3/60),x=_=>{const w=y.getBoundingClientRect(),P=_.clientX-w.left;e?(r(P),n==null||n({type:"PADDLE1_MOVE",position:P})):(a(P),n==null||n({type:"PADDLE2_MOVE",position:P}))};return y.addEventListener("mousemove",x),()=>{clearInterval(v),y.removeEventListener("mousemove",x)}},[l,h,i,o,d]),g.jsxs("div",{className:"flex flex-col items-center",children:[g.jsx("div",{className:"mb-4",children:g.jsxs("span",{className:"text-xl font-bold",children:["Score: ",d]})}),g.jsx("canvas",{ref:s,width:Tt,height:Pt,className:"border border-gray-700 rounded-lg"}),g.jsx("div",{className:"mt-4 text-sm text-gray-400",children:"Move your mouse to control your paddle"})]})}const Uh=m.createContext({});function cx(t){const e=m.useRef(null);return e.current===null&&(e.current=t()),e.current}const Ro=m.createContext(null),Wh=m.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function ux(t=!0){const e=m.useContext(Ro);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:s,register:i}=e,r=m.useId();m.useEffect(()=>{t&&i(r)},[t]);const o=m.useCallback(()=>t&&s&&s(r),[r,s,t]);return!n&&s?[!1,o]:[!0]}const Io=typeof window<"u",hx=Io?m.useLayoutEffect:m.useEffect,ge=t=>t;let Hh=ge;function No(t){let e;return()=>(e===void 0&&(e=t()),e)}const Yt=(t,e,n)=>{const s=e-t;return s===0?1:(n-t)/s},Be=t=>t*1e3,$e=t=>t/1e3,dx={useManualTiming:!1};function fx(t){let e=new Set,n=new Set,s=!1,i=!1;const r=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(c){r.has(c)&&(l.schedule(c),t()),c(o)}const l={schedule:(c,h=!1,u=!1)=>{const f=u&&s?e:n;return h&&r.add(c),f.has(c)||f.add(c),c},cancel:c=>{n.delete(c),r.delete(c)},process:c=>{if(o=c,s){i=!0;return}s=!0,[e,n]=[n,e],e.forEach(a),e.clear(),s=!1,i&&(i=!1,l.process(c))}};return l}const ms=["read","resolveKeyframes","update","preRender","render","postRender"],px=40;function Gh(t,e){let n=!1,s=!0;const i={delta:0,timestamp:0,isProcessing:!1},r=()=>n=!0,o=ms.reduce((x,_)=>(x[_]=fx(r),x),{}),{read:a,resolveKeyframes:l,update:c,preRender:h,render:u,postRender:d}=o,f=()=>{const x=performance.now();n=!1,i.delta=s?1e3/60:Math.max(Math.min(x-i.timestamp,px),1),i.timestamp=x,i.isProcessing=!0,a.process(i),l.process(i),c.process(i),h.process(i),u.process(i),d.process(i),i.isProcessing=!1,n&&e&&(s=!1,t(f))},y=()=>{n=!0,s=!0,i.isProcessing||t(f)};return{schedule:ms.reduce((x,_)=>{const w=o[_];return x[_]=(P,R=!1,T=!1)=>(n||y(),w.schedule(P,R,T)),x},{}),cancel:x=>{for(let _=0;_<ms.length;_++)o[ms[_]].cancel(x)},state:i,steps:o}}const{schedule:X,cancel:rt,state:ce,steps:Fi}=Gh(typeof requestAnimationFrame<"u"?requestAnimationFrame:ge,!0),zh=m.createContext({strict:!1}),vl={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},qt={};for(const t in vl)qt[t]={isEnabled:e=>vl[t].some(n=>!!e[n])};function mx(t){for(const e in t)qt[e]={...qt[e],...t[e]}}const gx=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function zs(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||gx.has(t)}let Kh=t=>!zs(t);function yx(t){t&&(Kh=e=>e.startsWith("on")?!zs(e):t(e))}try{yx(require("@emotion/is-prop-valid").default)}catch{}function vx(t,e,n){const s={};for(const i in t)i==="values"&&typeof t.values=="object"||(Kh(i)||n===!0&&zs(i)||!e&&!zs(i)||t.draggable&&i.startsWith("onDrag"))&&(s[i]=t[i]);return s}function _x(t){if(typeof Proxy>"u")return t;const e=new Map,n=(...s)=>t(...s);return new Proxy(n,{get:(s,i)=>i==="create"?t:(e.has(i)||e.set(i,t(i)),e.get(i))})}const yi=m.createContext({});function Hn(t){return typeof t=="string"||Array.isArray(t)}function vi(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const Ao=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Do=["initial",...Ao];function _i(t){return vi(t.animate)||Do.some(e=>Hn(t[e]))}function Yh(t){return!!(_i(t)||t.variants)}function xx(t,e){if(_i(t)){const{initial:n,animate:s}=t;return{initial:n===!1||Hn(n)?n:void 0,animate:Hn(s)?s:void 0}}return t.inherit!==!1?e:{}}function wx(t){const{initial:e,animate:n}=xx(t,m.useContext(yi));return m.useMemo(()=>({initial:e,animate:n}),[_l(e),_l(n)])}function _l(t){return Array.isArray(t)?t.join(" "):t}const bx=Symbol.for("motionComponentSymbol");function Dt(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Cx(t,e,n){return m.useCallback(s=>{s&&t.onMount&&t.onMount(s),e&&(s?e.mount(s):e.unmount()),n&&(typeof n=="function"?n(s):Dt(n)&&(n.current=s))},[e])}const ko=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Sx="framerAppearId",qh="data-"+ko(Sx),{schedule:Mo}=Gh(queueMicrotask,!1),Xh=m.createContext({});function Ex(t,e,n,s,i){var r,o;const{visualElement:a}=m.useContext(yi),l=m.useContext(zh),c=m.useContext(Ro),h=m.useContext(Wh).reducedMotion,u=m.useRef(null);s=s||l.renderer,!u.current&&s&&(u.current=s(t,{visualState:e,parent:a,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:h}));const d=u.current,f=m.useContext(Xh);d&&!d.projection&&i&&(d.type==="html"||d.type==="svg")&&Tx(u.current,n,i,f);const y=m.useRef(!1);m.useInsertionEffect(()=>{d&&y.current&&d.update(n,c)});const p=n[qh],v=m.useRef(!!p&&!(!((r=window.MotionHandoffIsComplete)===null||r===void 0)&&r.call(window,p))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,p)));return hx(()=>{d&&(y.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),Mo.render(d.render),v.current&&d.animationState&&d.animationState.animateChanges())}),m.useEffect(()=>{d&&(!v.current&&d.animationState&&d.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{var x;(x=window.MotionHandoffMarkAsComplete)===null||x===void 0||x.call(window,p)}),v.current=!1))}),d}function Tx(t,e,n,s){const{layoutId:i,layout:r,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:Qh(t.parent)),t.projection.setOptions({layoutId:i,layout:r,alwaysMeasureLayout:!!o||a&&Dt(a),visualElement:t,animationType:typeof r=="string"?r:"both",initialPromotionConfig:s,layoutScroll:l,layoutRoot:c})}function Qh(t){if(t)return t.options.allowProjection!==!1?t.projection:Qh(t.parent)}function Px({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:s,Component:i}){var r,o;t&&mx(t);function a(c,h){let u;const d={...m.useContext(Wh),...c,layoutId:Rx(c)},{isStatic:f}=d,y=wx(c),p=s(c,f);if(!f&&Io){Ix();const v=Nx(d);u=v.MeasureLayout,y.visualElement=Ex(i,p,d,e,v.ProjectionNode)}return g.jsxs(yi.Provider,{value:y,children:[u&&y.visualElement?g.jsx(u,{visualElement:y.visualElement,...d}):null,n(i,c,Cx(p,y.visualElement,h),p,f,y.visualElement)]})}a.displayName=`motion.${typeof i=="string"?i:`create(${(o=(r=i.displayName)!==null&&r!==void 0?r:i.name)!==null&&o!==void 0?o:""})`}`;const l=m.forwardRef(a);return l[bx]=i,l}function Rx({layoutId:t}){const e=m.useContext(Uh).id;return e&&t!==void 0?e+"-"+t:t}function Ix(t,e){m.useContext(zh).strict}function Nx(t){const{drag:e,layout:n}=qt;if(!e&&!n)return{};const s={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}const Ax=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Lo(t){return typeof t!="string"||t.includes("-")?!1:!!(Ax.indexOf(t)>-1||/[A-Z]/u.test(t))}function xl(t){const e=[{},{}];return t==null||t.values.forEach((n,s)=>{e[0][s]=n.get(),e[1][s]=n.getVelocity()}),e}function Oo(t,e,n,s){if(typeof e=="function"){const[i,r]=xl(s);e=e(n!==void 0?n:t.custom,i,r)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[i,r]=xl(s);e=e(n!==void 0?n:t.custom,i,r)}return e}const xr=t=>Array.isArray(t),Dx=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),kx=t=>xr(t)?t[t.length-1]||0:t,he=t=>!!(t&&t.getVelocity);function Cs(t){const e=he(t)?t.get():t;return Dx(e)?e.toValue():e}function Mx({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:n},s,i,r){const o={latestValues:Lx(s,i,r,t),renderState:e()};return n&&(o.onMount=a=>n({props:s,current:a,...o}),o.onUpdate=a=>n(a)),o}const Jh=t=>(e,n)=>{const s=m.useContext(yi),i=m.useContext(Ro),r=()=>Mx(t,e,s,i);return n?r():cx(r)};function Lx(t,e,n,s){const i={},r=s(t,{});for(const d in r)i[d]=Cs(r[d]);let{initial:o,animate:a}=t;const l=_i(t),c=Yh(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let h=n?n.initial===!1:!1;h=h||o===!1;const u=h?a:o;if(u&&typeof u!="boolean"&&!vi(u)){const d=Array.isArray(u)?u:[u];for(let f=0;f<d.length;f++){const y=Oo(t,d[f]);if(y){const{transitionEnd:p,transition:v,...x}=y;for(const _ in x){let w=x[_];if(Array.isArray(w)){const P=h?w.length-1:0;w=w[P]}w!==null&&(i[_]=w)}for(const _ in p)i[_]=p[_]}}}return i}const rn=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],St=new Set(rn),Zh=t=>e=>typeof e=="string"&&e.startsWith(t),ed=Zh("--"),Ox=Zh("var(--"),Fo=t=>Ox(t)?Fx.test(t.split("/*")[0].trim()):!1,Fx=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,td=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Ge=(t,e,n)=>n>e?e:n<t?t:n,on={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Gn={...on,transform:t=>Ge(0,1,t)},gs={...on,default:1},rs=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Ye=rs("deg"),Ie=rs("%"),M=rs("px"),jx=rs("vh"),Vx=rs("vw"),wl={...Ie,parse:t=>Ie.parse(t)/100,transform:t=>Ie.transform(t*100)},Bx={borderWidth:M,borderTopWidth:M,borderRightWidth:M,borderBottomWidth:M,borderLeftWidth:M,borderRadius:M,radius:M,borderTopLeftRadius:M,borderTopRightRadius:M,borderBottomRightRadius:M,borderBottomLeftRadius:M,width:M,maxWidth:M,height:M,maxHeight:M,top:M,right:M,bottom:M,left:M,padding:M,paddingTop:M,paddingRight:M,paddingBottom:M,paddingLeft:M,margin:M,marginTop:M,marginRight:M,marginBottom:M,marginLeft:M,backgroundPositionX:M,backgroundPositionY:M},$x={rotate:Ye,rotateX:Ye,rotateY:Ye,rotateZ:Ye,scale:gs,scaleX:gs,scaleY:gs,scaleZ:gs,skew:Ye,skewX:Ye,skewY:Ye,distance:M,translateX:M,translateY:M,translateZ:M,x:M,y:M,z:M,perspective:M,transformPerspective:M,opacity:Gn,originX:wl,originY:wl,originZ:M},bl={...on,transform:Math.round},jo={...Bx,...$x,zIndex:bl,size:M,fillOpacity:Gn,strokeOpacity:Gn,numOctaves:bl},Ux={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Wx=rn.length;function Hx(t,e,n){let s="",i=!0;for(let r=0;r<Wx;r++){const o=rn[r],a=t[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||n){const c=td(a,jo[o]);if(!l){i=!1;const h=Ux[o]||o;s+=`${h}(${c}) `}n&&(e[o]=c)}}return s=s.trim(),n?s=n(e,i?"":s):i&&(s="none"),s}function Vo(t,e,n){const{style:s,vars:i,transformOrigin:r}=t;let o=!1,a=!1;for(const l in e){const c=e[l];if(St.has(l)){o=!0;continue}else if(ed(l)){i[l]=c;continue}else{const h=td(c,jo[l]);l.startsWith("origin")?(a=!0,r[l]=h):s[l]=h}}if(e.transform||(o||n?s.transform=Hx(e,t.transform,n):s.transform&&(s.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:h=0}=r;s.transformOrigin=`${l} ${c} ${h}`}}const Gx={offset:"stroke-dashoffset",array:"stroke-dasharray"},zx={offset:"strokeDashoffset",array:"strokeDasharray"};function Kx(t,e,n=1,s=0,i=!0){t.pathLength=1;const r=i?Gx:zx;t[r.offset]=M.transform(-s);const o=M.transform(e),a=M.transform(n);t[r.array]=`${o} ${a}`}function Cl(t,e,n){return typeof t=="string"?t:M.transform(e+n*t)}function Yx(t,e,n){const s=Cl(e,t.x,t.width),i=Cl(n,t.y,t.height);return`${s} ${i}`}function Bo(t,{attrX:e,attrY:n,attrScale:s,originX:i,originY:r,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},h,u){if(Vo(t,c,u),h){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:d,style:f,dimensions:y}=t;d.transform&&(y&&(f.transform=d.transform),delete d.transform),y&&(i!==void 0||r!==void 0||f.transform)&&(f.transformOrigin=Yx(y,i!==void 0?i:.5,r!==void 0?r:.5)),e!==void 0&&(d.x=e),n!==void 0&&(d.y=n),s!==void 0&&(d.scale=s),o!==void 0&&Kx(d,o,a,l,!1)}const $o=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),nd=()=>({...$o(),attrs:{}}),Uo=t=>typeof t=="string"&&t.toLowerCase()==="svg";function sd(t,{style:e,vars:n},s,i){Object.assign(t.style,e,i&&i.getProjectionStyles(s));for(const r in n)t.style.setProperty(r,n[r])}const id=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function rd(t,e,n,s){sd(t,e,void 0,s);for(const i in e.attrs)t.setAttribute(id.has(i)?i:ko(i),e.attrs[i])}const Ks={};function qx(t){Object.assign(Ks,t)}function od(t,{layout:e,layoutId:n}){return St.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Ks[t]||t==="opacity")}function Wo(t,e,n){var s;const{style:i}=t,r={};for(const o in i)(he(i[o])||e.style&&he(e.style[o])||od(o,t)||((s=n==null?void 0:n.getValue(o))===null||s===void 0?void 0:s.liveStyle)!==void 0)&&(r[o]=i[o]);return r}function ad(t,e,n){const s=Wo(t,e,n);for(const i in t)if(he(t[i])||he(e[i])){const r=rn.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;s[r]=t[i]}return s}function Xx(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const Sl=["x","y","width","height","cx","cy","r"],Qx={useVisualState:Jh({scrapeMotionValuesFromProps:ad,createRenderState:nd,onUpdate:({props:t,prevProps:e,current:n,renderState:s,latestValues:i})=>{if(!n)return;let r=!!t.drag;if(!r){for(const a in i)if(St.has(a)){r=!0;break}}if(!r)return;let o=!e;if(e)for(let a=0;a<Sl.length;a++){const l=Sl[a];t[l]!==e[l]&&(o=!0)}o&&X.read(()=>{Xx(n,s),X.render(()=>{Bo(s,i,Uo(n.tagName),t.transformTemplate),rd(n,s)})})}})},Jx={useVisualState:Jh({scrapeMotionValuesFromProps:Wo,createRenderState:$o})};function ld(t,e,n){for(const s in e)!he(e[s])&&!od(s,n)&&(t[s]=e[s])}function Zx({transformTemplate:t},e){return m.useMemo(()=>{const n=$o();return Vo(n,e,t),Object.assign({},n.vars,n.style)},[e])}function ew(t,e){const n=t.style||{},s={};return ld(s,n,t),Object.assign(s,Zx(t,e)),s}function tw(t,e){const n={},s=ew(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=s,n}function nw(t,e,n,s){const i=m.useMemo(()=>{const r=nd();return Bo(r,e,Uo(s),t.transformTemplate),{...r.attrs,style:{...r.style}}},[e]);if(t.style){const r={};ld(r,t.style,t),i.style={...r,...i.style}}return i}function sw(t=!1){return(n,s,i,{latestValues:r},o)=>{const l=(Lo(n)?nw:tw)(s,r,o,n),c=vx(s,typeof n=="string",t),h=n!==m.Fragment?{...c,...l,ref:i}:{},{children:u}=s,d=m.useMemo(()=>he(u)?u.get():u,[u]);return m.createElement(n,{...h,children:d})}}function iw(t,e){return function(s,{forwardMotionProps:i}={forwardMotionProps:!1}){const o={...Lo(s)?Qx:Jx,preloadedFeatures:t,useRender:sw(i),createVisualElement:e,Component:s};return Px(o)}}function cd(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}function xi(t,e,n){const s=t.getProps();return Oo(s,e,n!==void 0?n:s.custom,t)}const rw=No(()=>window.ScrollTimeline!==void 0);class ow{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,n){for(let s=0;s<this.animations.length;s++)this.animations[s][e]=n}attachTimeline(e,n){const s=this.animations.map(i=>{if(rw()&&i.attachTimeline)return i.attachTimeline(e);if(typeof n=="function")return n(i)});return()=>{s.forEach((i,r)=>{i&&i(),this.animations[r].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let n=0;n<this.animations.length;n++)e=Math.max(e,this.animations[n].duration);return e}runAll(e){this.animations.forEach(n=>n[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class aw extends ow{then(e,n){return Promise.all(this.animations).then(e).catch(n)}}function Ho(t,e){return t?t[e]||t.default||t:void 0}const wr=2e4;function ud(t){let e=0;const n=50;let s=t.next(e);for(;!s.done&&e<wr;)e+=n,s=t.next(e);return e>=wr?1/0:e}function Go(t){return typeof t=="function"}function El(t,e){t.timeline=e,t.onfinish=null}const zo=t=>Array.isArray(t)&&typeof t[0]=="number",lw={linearEasing:void 0};function cw(t,e){const n=No(t);return()=>{var s;return(s=lw[e])!==null&&s!==void 0?s:n()}}const Ys=cw(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),hd=(t,e,n=10)=>{let s="";const i=Math.max(Math.round(e/n),2);for(let r=0;r<i;r++)s+=t(Yt(0,i-1,r))+", ";return`linear(${s.substring(0,s.length-2)})`};function dd(t){return!!(typeof t=="function"&&Ys()||!t||typeof t=="string"&&(t in br||Ys())||zo(t)||Array.isArray(t)&&t.every(dd))}const vn=([t,e,n,s])=>`cubic-bezier(${t}, ${e}, ${n}, ${s})`,br={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:vn([0,.65,.55,1]),circOut:vn([.55,0,1,.45]),backIn:vn([.31,.01,.66,-.59]),backOut:vn([.33,1.53,.69,.99])};function fd(t,e){if(t)return typeof t=="function"&&Ys()?hd(t,e):zo(t)?vn(t):Array.isArray(t)?t.map(n=>fd(n,e)||br.easeOut):br[t]}const Ce={x:!1,y:!1};function pd(){return Ce.x||Ce.y}function uw(t,e,n){var s;if(t instanceof Element)return[t];if(typeof t=="string"){let i=document;const r=(s=void 0)!==null&&s!==void 0?s:i.querySelectorAll(t);return r?Array.from(r):[]}return Array.from(t)}function md(t,e){const n=uw(t),s=new AbortController,i={passive:!0,...e,signal:s.signal};return[n,i,()=>s.abort()]}function Tl(t){return e=>{e.pointerType==="touch"||pd()||t(e)}}function hw(t,e,n={}){const[s,i,r]=md(t,n),o=Tl(a=>{const{target:l}=a,c=e(a);if(typeof c!="function"||!l)return;const h=Tl(u=>{c(u),l.removeEventListener("pointerleave",h)});l.addEventListener("pointerleave",h,i)});return s.forEach(a=>{a.addEventListener("pointerenter",o,i)}),r}const gd=(t,e)=>e?t===e?!0:gd(t,e.parentElement):!1,Ko=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,dw=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function fw(t){return dw.has(t.tagName)||t.tabIndex!==-1}const _n=new WeakSet;function Pl(t){return e=>{e.key==="Enter"&&t(e)}}function ji(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const pw=(t,e)=>{const n=t.currentTarget;if(!n)return;const s=Pl(()=>{if(_n.has(n))return;ji(n,"down");const i=Pl(()=>{ji(n,"up")}),r=()=>ji(n,"cancel");n.addEventListener("keyup",i,e),n.addEventListener("blur",r,e)});n.addEventListener("keydown",s,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",s),e)};function Rl(t){return Ko(t)&&!pd()}function mw(t,e,n={}){const[s,i,r]=md(t,n),o=a=>{const l=a.currentTarget;if(!Rl(a)||_n.has(l))return;_n.add(l);const c=e(a),h=(f,y)=>{window.removeEventListener("pointerup",u),window.removeEventListener("pointercancel",d),!(!Rl(f)||!_n.has(l))&&(_n.delete(l),typeof c=="function"&&c(f,{success:y}))},u=f=>{h(f,n.useGlobalTarget||gd(l,f.target))},d=f=>{h(f,!1)};window.addEventListener("pointerup",u,i),window.addEventListener("pointercancel",d,i)};return s.forEach(a=>{!fw(a)&&a.getAttribute("tabindex")===null&&(a.tabIndex=0),(n.useGlobalTarget?window:a).addEventListener("pointerdown",o,i),a.addEventListener("focus",c=>pw(c,i),i)}),r}function gw(t){return t==="x"||t==="y"?Ce[t]?null:(Ce[t]=!0,()=>{Ce[t]=!1}):Ce.x||Ce.y?null:(Ce.x=Ce.y=!0,()=>{Ce.x=Ce.y=!1})}const yd=new Set(["width","height","top","left","right","bottom",...rn]);let Ss;function yw(){Ss=void 0}const Ne={now:()=>(Ss===void 0&&Ne.set(ce.isProcessing||dx.useManualTiming?ce.timestamp:performance.now()),Ss),set:t=>{Ss=t,queueMicrotask(yw)}};function Yo(t,e){t.indexOf(e)===-1&&t.push(e)}function qo(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class Xo{constructor(){this.subscriptions=[]}add(e){return Yo(this.subscriptions,e),()=>qo(this.subscriptions,e)}notify(e,n,s){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,n,s);else for(let r=0;r<i;r++){const o=this.subscriptions[r];o&&o(e,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function vd(t,e){return e?t*(1e3/e):0}const Il=30,vw=t=>!isNaN(parseFloat(t));class _w{constructor(e,n={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,i=!0)=>{const r=Ne.now();this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Ne.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=vw(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new Xo);const s=this.events[e].add(n);return e==="change"?()=>{s(),X.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,s){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ne.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Il)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,Il);return vd(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function zn(t,e){return new _w(t,e)}function xw(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,zn(n))}function ww(t,e){const n=xi(t,e);let{transitionEnd:s={},transition:i={},...r}=n||{};r={...r,...s};for(const o in r){const a=kx(r[o]);xw(t,o,a)}}function bw(t){return!!(he(t)&&t.add)}function Cr(t,e){const n=t.getValue("willChange");if(bw(n))return n.add(e)}function _d(t){return t.props[qh]}const xd=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,Cw=1e-7,Sw=12;function Ew(t,e,n,s,i){let r,o,a=0;do o=e+(n-e)/2,r=xd(o,s,i)-t,r>0?n=o:e=o;while(Math.abs(r)>Cw&&++a<Sw);return o}function os(t,e,n,s){if(t===e&&n===s)return ge;const i=r=>Ew(r,0,1,t,n);return r=>r===0||r===1?r:xd(i(r),e,s)}const wd=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,bd=t=>e=>1-t(1-e),Cd=os(.33,1.53,.69,.99),Qo=bd(Cd),Sd=wd(Qo),Ed=t=>(t*=2)<1?.5*Qo(t):.5*(2-Math.pow(2,-10*(t-1))),Jo=t=>1-Math.sin(Math.acos(t)),Td=bd(Jo),Pd=wd(Jo),Rd=t=>/^0[^.\s]+$/u.test(t);function Tw(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||Rd(t):!0}const Tn=t=>Math.round(t*1e5)/1e5,Zo=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Pw(t){return t==null}const Rw=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,ea=(t,e)=>n=>!!(typeof n=="string"&&Rw.test(n)&&n.startsWith(t)||e&&!Pw(n)&&Object.prototype.hasOwnProperty.call(n,e)),Id=(t,e,n)=>s=>{if(typeof s!="string")return s;const[i,r,o,a]=s.match(Zo);return{[t]:parseFloat(i),[e]:parseFloat(r),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},Iw=t=>Ge(0,255,t),Vi={...on,transform:t=>Math.round(Iw(t))},gt={test:ea("rgb","red"),parse:Id("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:s=1})=>"rgba("+Vi.transform(t)+", "+Vi.transform(e)+", "+Vi.transform(n)+", "+Tn(Gn.transform(s))+")"};function Nw(t){let e="",n="",s="",i="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),s=t.substring(5,7),i=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),s=t.substring(3,4),i=t.substring(4,5),e+=e,n+=n,s+=s,i+=i),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:i?parseInt(i,16)/255:1}}const Sr={test:ea("#"),parse:Nw,transform:gt.transform},kt={test:ea("hsl","hue"),parse:Id("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:s=1})=>"hsla("+Math.round(t)+", "+Ie.transform(Tn(e))+", "+Ie.transform(Tn(n))+", "+Tn(Gn.transform(s))+")"},ue={test:t=>gt.test(t)||Sr.test(t)||kt.test(t),parse:t=>gt.test(t)?gt.parse(t):kt.test(t)?kt.parse(t):Sr.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?gt.transform(t):kt.transform(t)},Aw=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Dw(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(Zo))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(Aw))===null||n===void 0?void 0:n.length)||0)>0}const Nd="number",Ad="color",kw="var",Mw="var(",Nl="${}",Lw=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Kn(t){const e=t.toString(),n=[],s={color:[],number:[],var:[]},i=[];let r=0;const a=e.replace(Lw,l=>(ue.test(l)?(s.color.push(r),i.push(Ad),n.push(ue.parse(l))):l.startsWith(Mw)?(s.var.push(r),i.push(kw),n.push(l)):(s.number.push(r),i.push(Nd),n.push(parseFloat(l))),++r,Nl)).split(Nl);return{values:n,split:a,indexes:s,types:i}}function Dd(t){return Kn(t).values}function kd(t){const{split:e,types:n}=Kn(t),s=e.length;return i=>{let r="";for(let o=0;o<s;o++)if(r+=e[o],i[o]!==void 0){const a=n[o];a===Nd?r+=Tn(i[o]):a===Ad?r+=ue.transform(i[o]):r+=i[o]}return r}}const Ow=t=>typeof t=="number"?0:t;function Fw(t){const e=Dd(t);return kd(t)(e.map(Ow))}const ot={test:Dw,parse:Dd,createTransformer:kd,getAnimatableNone:Fw},jw=new Set(["brightness","contrast","saturate","opacity"]);function Vw(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[s]=n.match(Zo)||[];if(!s)return t;const i=n.replace(s,"");let r=jw.has(e)?1:0;return s!==n&&(r*=100),e+"("+r+i+")"}const Bw=/\b([a-z-]*)\(.*?\)/gu,Er={...ot,getAnimatableNone:t=>{const e=t.match(Bw);return e?e.map(Vw).join(" "):t}},$w={...jo,color:ue,backgroundColor:ue,outlineColor:ue,fill:ue,stroke:ue,borderColor:ue,borderTopColor:ue,borderRightColor:ue,borderBottomColor:ue,borderLeftColor:ue,filter:Er,WebkitFilter:Er},ta=t=>$w[t];function Md(t,e){let n=ta(t);return n!==Er&&(n=ot),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const Uw=new Set(["auto","none","0"]);function Ww(t,e,n){let s=0,i;for(;s<t.length&&!i;){const r=t[s];typeof r=="string"&&!Uw.has(r)&&Kn(r).values.length&&(i=t[s]),s++}if(i&&n)for(const r of e)t[r]=Md(n,i)}const Al=t=>t===on||t===M,Dl=(t,e)=>parseFloat(t.split(", ")[e]),kl=(t,e)=>(n,{transform:s})=>{if(s==="none"||!s)return 0;const i=s.match(/^matrix3d\((.+)\)$/u);if(i)return Dl(i[1],e);{const r=s.match(/^matrix\((.+)\)$/u);return r?Dl(r[1],t):0}},Hw=new Set(["x","y","z"]),Gw=rn.filter(t=>!Hw.has(t));function zw(t){const e=[];return Gw.forEach(n=>{const s=t.getValue(n);s!==void 0&&(e.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),e}const Xt={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:kl(4,13),y:kl(5,14)};Xt.translateX=Xt.x;Xt.translateY=Xt.y;const yt=new Set;let Tr=!1,Pr=!1;function Ld(){if(Pr){const t=Array.from(yt).filter(s=>s.needsMeasurement),e=new Set(t.map(s=>s.element)),n=new Map;e.forEach(s=>{const i=zw(s);i.length&&(n.set(s,i),s.render())}),t.forEach(s=>s.measureInitialState()),e.forEach(s=>{s.render();const i=n.get(s);i&&i.forEach(([r,o])=>{var a;(a=s.getValue(r))===null||a===void 0||a.set(o)})}),t.forEach(s=>s.measureEndState()),t.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}Pr=!1,Tr=!1,yt.forEach(t=>t.complete()),yt.clear()}function Od(){yt.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Pr=!0)})}function Kw(){Od(),Ld()}class na{constructor(e,n,s,i,r,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=s,this.motionValue=i,this.element=r,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(yt.add(this),Tr||(Tr=!0,X.read(Od),X.resolveKeyframes(Ld))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:s,motionValue:i}=this;for(let r=0;r<e.length;r++)if(e[r]===null)if(r===0){const o=i==null?void 0:i.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(s&&n){const l=s.readValue(n,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),i&&o===void 0&&i.set(e[0])}else e[r]=e[r-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),yt.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,yt.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const Fd=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),Yw=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function qw(t){const e=Yw.exec(t);if(!e)return[,];const[,n,s,i]=e;return[`--${n??s}`,i]}function jd(t,e,n=1){const[s,i]=qw(t);if(!s)return;const r=window.getComputedStyle(e).getPropertyValue(s);if(r){const o=r.trim();return Fd(o)?parseFloat(o):o}return Fo(i)?jd(i,e,n+1):i}const Vd=t=>e=>e.test(t),Xw={test:t=>t==="auto",parse:t=>t},Bd=[on,M,Ie,Ye,Vx,jx,Xw],Ml=t=>Bd.find(Vd(t));class $d extends na{constructor(e,n,s,i,r){super(e,n,s,i,r,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:s}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),Fo(c))){const h=jd(c,n.current);h!==void 0&&(e[l]=h),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!yd.has(s)||e.length!==2)return;const[i,r]=e,o=Ml(i),a=Ml(r);if(o!==a)if(Al(o)&&Al(a))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,s=[];for(let i=0;i<e.length;i++)Tw(e[i])&&s.push(i);s.length&&Ww(e,s,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:s}=this;if(!e||!e.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Xt[s](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&e.getValue(s,i).jump(i,!1)}measureEndState(){var e;const{element:n,name:s,unresolvedKeyframes:i}=this;if(!n||!n.current)return;const r=n.getValue(s);r&&r.jump(this.measuredOrigin,!1);const o=i.length-1,a=i[o];i[o]=Xt[s](n.measureViewportBox(),window.getComputedStyle(n.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{n.getValue(l).set(c)}),this.resolveNoneKeyframes()}}const Ll=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(ot.test(t)||t==="0")&&!t.startsWith("url("));function Qw(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function Jw(t,e,n,s){const i=t[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const r=t[t.length-1],o=Ll(i,e),a=Ll(r,e);return!o||!a?!1:Qw(t)||(n==="spring"||Go(n))&&s}const Zw=t=>t!==null;function wi(t,{repeat:e,repeatType:n="loop"},s){const i=t.filter(Zw),r=e&&n!=="loop"&&e%2===1?0:i.length-1;return!r||s===void 0?i[r]:s}const eb=40;class Ud{constructor({autoplay:e=!0,delay:n=0,type:s="keyframes",repeat:i=0,repeatDelay:r=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Ne.now(),this.options={autoplay:e,delay:n,type:s,repeat:i,repeatDelay:r,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>eb?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&Kw(),this._resolved}onKeyframesResolved(e,n){this.resolvedAt=Ne.now(),this.hasAttemptedResolve=!0;const{name:s,type:i,velocity:r,delay:o,onComplete:a,onUpdate:l,isGenerator:c}=this.options;if(!c&&!Jw(e,s,i,r))if(o)this.options.duration=0;else{l&&l(wi(e,this.options,n)),a&&a(),this.resolveFinishedPromise();return}const h=this.initPlayback(e,n);h!==!1&&(this._resolved={keyframes:e,finalKeyframe:n,...h},this.onPostResolved())}onPostResolved(){}then(e,n){return this.currentFinishedPromise.then(e,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const J=(t,e,n)=>t+(e-t)*n;function Bi(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function tb({hue:t,saturation:e,lightness:n,alpha:s}){t/=360,e/=100,n/=100;let i=0,r=0,o=0;if(!e)i=r=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;i=Bi(l,a,t+1/3),r=Bi(l,a,t),o=Bi(l,a,t-1/3)}return{red:Math.round(i*255),green:Math.round(r*255),blue:Math.round(o*255),alpha:s}}function qs(t,e){return n=>n>0?e:t}const $i=(t,e,n)=>{const s=t*t,i=n*(e*e-s)+s;return i<0?0:Math.sqrt(i)},nb=[Sr,gt,kt],sb=t=>nb.find(e=>e.test(t));function Ol(t){const e=sb(t);if(!e)return!1;let n=e.parse(t);return e===kt&&(n=tb(n)),n}const Fl=(t,e)=>{const n=Ol(t),s=Ol(e);if(!n||!s)return qs(t,e);const i={...n};return r=>(i.red=$i(n.red,s.red,r),i.green=$i(n.green,s.green,r),i.blue=$i(n.blue,s.blue,r),i.alpha=J(n.alpha,s.alpha,r),gt.transform(i))},ib=(t,e)=>n=>e(t(n)),as=(...t)=>t.reduce(ib),Rr=new Set(["none","hidden"]);function rb(t,e){return Rr.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function ob(t,e){return n=>J(t,e,n)}function sa(t){return typeof t=="number"?ob:typeof t=="string"?Fo(t)?qs:ue.test(t)?Fl:cb:Array.isArray(t)?Wd:typeof t=="object"?ue.test(t)?Fl:ab:qs}function Wd(t,e){const n=[...t],s=n.length,i=t.map((r,o)=>sa(r)(r,e[o]));return r=>{for(let o=0;o<s;o++)n[o]=i[o](r);return n}}function ab(t,e){const n={...t,...e},s={};for(const i in n)t[i]!==void 0&&e[i]!==void 0&&(s[i]=sa(t[i])(t[i],e[i]));return i=>{for(const r in s)n[r]=s[r](i);return n}}function lb(t,e){var n;const s=[],i={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const o=e.types[r],a=t.indexes[o][i[o]],l=(n=t.values[a])!==null&&n!==void 0?n:0;s[r]=l,i[o]++}return s}const cb=(t,e)=>{const n=ot.createTransformer(e),s=Kn(t),i=Kn(e);return s.indexes.var.length===i.indexes.var.length&&s.indexes.color.length===i.indexes.color.length&&s.indexes.number.length>=i.indexes.number.length?Rr.has(t)&&!i.values.length||Rr.has(e)&&!s.values.length?rb(t,e):as(Wd(lb(s,i),i.values),n):qs(t,e)};function Hd(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?J(t,e,n):sa(t)(t,e)}const ub=5;function Gd(t,e,n){const s=Math.max(e-ub,0);return vd(n-t(s),e-s)}const te={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},jl=.001;function hb({duration:t=te.duration,bounce:e=te.bounce,velocity:n=te.velocity,mass:s=te.mass}){let i,r,o=1-e;o=Ge(te.minDamping,te.maxDamping,o),t=Ge(te.minDuration,te.maxDuration,$e(t)),o<1?(i=c=>{const h=c*o,u=h*t,d=h-n,f=Ir(c,o),y=Math.exp(-u);return jl-d/f*y},r=c=>{const u=c*o*t,d=u*n+n,f=Math.pow(o,2)*Math.pow(c,2)*t,y=Math.exp(-u),p=Ir(Math.pow(c,2),o);return(-i(c)+jl>0?-1:1)*((d-f)*y)/p}):(i=c=>{const h=Math.exp(-c*t),u=(c-n)*t+1;return-.001+h*u},r=c=>{const h=Math.exp(-c*t),u=(n-c)*(t*t);return h*u});const a=5/t,l=fb(i,r,a);if(t=Be(t),isNaN(l))return{stiffness:te.stiffness,damping:te.damping,duration:t};{const c=Math.pow(l,2)*s;return{stiffness:c,damping:o*2*Math.sqrt(s*c),duration:t}}}const db=12;function fb(t,e,n){let s=n;for(let i=1;i<db;i++)s=s-t(s)/e(s);return s}function Ir(t,e){return t*Math.sqrt(1-e*e)}const pb=["duration","bounce"],mb=["stiffness","damping","mass"];function Vl(t,e){return e.some(n=>t[n]!==void 0)}function gb(t){let e={velocity:te.velocity,stiffness:te.stiffness,damping:te.damping,mass:te.mass,isResolvedFromDuration:!1,...t};if(!Vl(t,mb)&&Vl(t,pb))if(t.visualDuration){const n=t.visualDuration,s=2*Math.PI/(n*1.2),i=s*s,r=2*Ge(.05,1,1-(t.bounce||0))*Math.sqrt(i);e={...e,mass:te.mass,stiffness:i,damping:r}}else{const n=hb(t);e={...e,...n,mass:te.mass},e.isResolvedFromDuration=!0}return e}function zd(t=te.visualDuration,e=te.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:s,restDelta:i}=n;const r=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],a={done:!1,value:r},{stiffness:l,damping:c,mass:h,duration:u,velocity:d,isResolvedFromDuration:f}=gb({...n,velocity:-$e(n.velocity||0)}),y=d||0,p=c/(2*Math.sqrt(l*h)),v=o-r,x=$e(Math.sqrt(l/h)),_=Math.abs(v)<5;s||(s=_?te.restSpeed.granular:te.restSpeed.default),i||(i=_?te.restDelta.granular:te.restDelta.default);let w;if(p<1){const R=Ir(x,p);w=T=>{const O=Math.exp(-p*x*T);return o-O*((y+p*x*v)/R*Math.sin(R*T)+v*Math.cos(R*T))}}else if(p===1)w=R=>o-Math.exp(-x*R)*(v+(y+x*v)*R);else{const R=x*Math.sqrt(p*p-1);w=T=>{const O=Math.exp(-p*x*T),D=Math.min(R*T,300);return o-O*((y+p*x*v)*Math.sinh(D)+R*v*Math.cosh(D))/R}}const P={calculatedDuration:f&&u||null,next:R=>{const T=w(R);if(f)a.done=R>=u;else{let O=0;p<1&&(O=R===0?Be(y):Gd(w,R,T));const D=Math.abs(O)<=s,I=Math.abs(o-T)<=i;a.done=D&&I}return a.value=a.done?o:T,a},toString:()=>{const R=Math.min(ud(P),wr),T=hd(O=>P.next(R*O).value,R,30);return R+"ms "+T}};return P}function Bl({keyframes:t,velocity:e=0,power:n=.8,timeConstant:s=325,bounceDamping:i=10,bounceStiffness:r=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:h}){const u=t[0],d={done:!1,value:u},f=D=>a!==void 0&&D<a||l!==void 0&&D>l,y=D=>a===void 0?l:l===void 0||Math.abs(a-D)<Math.abs(l-D)?a:l;let p=n*e;const v=u+p,x=o===void 0?v:o(v);x!==v&&(p=x-u);const _=D=>-p*Math.exp(-D/s),w=D=>x+_(D),P=D=>{const I=_(D),E=w(D);d.done=Math.abs(I)<=c,d.value=d.done?x:E};let R,T;const O=D=>{f(d.value)&&(R=D,T=zd({keyframes:[d.value,y(d.value)],velocity:Gd(w,D,d.value),damping:i,stiffness:r,restDelta:c,restSpeed:h}))};return O(0),{calculatedDuration:null,next:D=>{let I=!1;return!T&&R===void 0&&(I=!0,P(D),O(D)),R!==void 0&&D>=R?T.next(D-R):(!I&&P(D),d)}}}const yb=os(.42,0,1,1),vb=os(0,0,.58,1),Kd=os(.42,0,.58,1),_b=t=>Array.isArray(t)&&typeof t[0]!="number",xb={linear:ge,easeIn:yb,easeInOut:Kd,easeOut:vb,circIn:Jo,circInOut:Pd,circOut:Td,backIn:Qo,backInOut:Sd,backOut:Cd,anticipate:Ed},$l=t=>{if(zo(t)){Hh(t.length===4);const[e,n,s,i]=t;return os(e,n,s,i)}else if(typeof t=="string")return xb[t];return t};function wb(t,e,n){const s=[],i=n||Hd,r=t.length-1;for(let o=0;o<r;o++){let a=i(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||ge:e;a=as(l,a)}s.push(a)}return s}function bb(t,e,{clamp:n=!0,ease:s,mixer:i}={}){const r=t.length;if(Hh(r===e.length),r===1)return()=>e[0];if(r===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[r-1]&&(t=[...t].reverse(),e=[...e].reverse());const a=wb(e,s,i),l=a.length,c=h=>{if(o&&h<t[0])return e[0];let u=0;if(l>1)for(;u<t.length-2&&!(h<t[u+1]);u++);const d=Yt(t[u],t[u+1],h);return a[u](d)};return n?h=>c(Ge(t[0],t[r-1],h)):c}function Cb(t,e){const n=t[t.length-1];for(let s=1;s<=e;s++){const i=Yt(0,e,s);t.push(J(n,1,i))}}function Sb(t){const e=[0];return Cb(e,t.length-1),e}function Eb(t,e){return t.map(n=>n*e)}function Tb(t,e){return t.map(()=>e||Kd).splice(0,t.length-1)}function Xs({duration:t=300,keyframes:e,times:n,ease:s="easeInOut"}){const i=_b(s)?s.map($l):$l(s),r={done:!1,value:e[0]},o=Eb(n&&n.length===e.length?n:Sb(e),t),a=bb(o,e,{ease:Array.isArray(i)?i:Tb(e,i)});return{calculatedDuration:t,next:l=>(r.value=a(l),r.done=l>=t,r)}}const Pb=t=>{const e=({timestamp:n})=>t(n);return{start:()=>X.update(e,!0),stop:()=>rt(e),now:()=>ce.isProcessing?ce.timestamp:Ne.now()}},Rb={decay:Bl,inertia:Bl,tween:Xs,keyframes:Xs,spring:zd},Ib=t=>t/100;class ia extends Ud{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:n,motionValue:s,element:i,keyframes:r}=this.options,o=(i==null?void 0:i.KeyframeResolver)||na,a=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new o(r,a,n,s,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:n="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:r,velocity:o=0}=this.options,a=Go(n)?n:Rb[n]||Xs;let l,c;a!==Xs&&typeof e[0]!="number"&&(l=as(Ib,Hd(e[0],e[1])),e=[0,100]);const h=a({...this.options,keyframes:e});r==="mirror"&&(c=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),h.calculatedDuration===null&&(h.calculatedDuration=ud(h));const{calculatedDuration:u}=h,d=u+i,f=d*(s+1)-i;return{generator:h,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:u,resolvedDuration:d,totalDuration:f}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,n=!1){const{resolved:s}=this;if(!s){const{keyframes:D}=this.options;return{done:!0,value:D[D.length-1]}}const{finalKeyframe:i,generator:r,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:c,totalDuration:h,resolvedDuration:u}=s;if(this.startTime===null)return r.next(0);const{delay:d,repeat:f,repeatType:y,repeatDelay:p,onUpdate:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-h/this.speed,this.startTime)),n?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const x=this.currentTime-d*(this.speed>=0?1:-1),_=this.speed>=0?x<0:x>h;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=h);let w=this.currentTime,P=r;if(f){const D=Math.min(this.currentTime,h)/u;let I=Math.floor(D),E=D%1;!E&&D>=1&&(E=1),E===1&&I--,I=Math.min(I,f+1),!!(I%2)&&(y==="reverse"?(E=1-E,p&&(E-=p/u)):y==="mirror"&&(P=o)),w=Ge(0,1,E)*u}const R=_?{done:!1,value:l[0]}:P.next(w);a&&(R.value=a(R.value));let{done:T}=R;!_&&c!==null&&(T=this.speed>=0?this.currentTime>=h:this.currentTime<=0);const O=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&T);return O&&i!==void 0&&(R.value=wi(l,this.options,i)),v&&v(R.value),O&&this.finish(),R}get duration(){const{resolved:e}=this;return e?$e(e.calculatedDuration):0}get time(){return $e(this.currentTime)}set time(e){e=Be(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=$e(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=Pb,onPlay:n,startTime:s}=this.options;this.driver||(this.driver=e(r=>this.tick(r))),n&&n();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=s??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const Nb=new Set(["opacity","clipPath","filter","transform"]);function Ab(t,e,n,{delay:s=0,duration:i=300,repeat:r=0,repeatType:o="loop",ease:a="easeInOut",times:l}={}){const c={[e]:n};l&&(c.offset=l);const h=fd(a,i);return Array.isArray(h)&&(c.easing=h),t.animate(c,{delay:s,duration:i,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:r+1,direction:o==="reverse"?"alternate":"normal"})}const Db=No(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Qs=10,kb=2e4;function Mb(t){return Go(t.type)||t.type==="spring"||!dd(t.ease)}function Lb(t,e){const n=new ia({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let s={done:!1,value:t[0]};const i=[];let r=0;for(;!s.done&&r<kb;)s=n.sample(r),i.push(s.value),r+=Qs;return{times:void 0,keyframes:i,duration:r-Qs,ease:"linear"}}const Yd={anticipate:Ed,backInOut:Sd,circInOut:Pd};function Ob(t){return t in Yd}class Ul extends Ud{constructor(e){super(e);const{name:n,motionValue:s,element:i,keyframes:r}=this.options;this.resolver=new $d(r,(o,a)=>this.onKeyframesResolved(o,a),n,s,i),this.resolver.scheduleResolve()}initPlayback(e,n){let{duration:s=300,times:i,ease:r,type:o,motionValue:a,name:l,startTime:c}=this.options;if(!a.owner||!a.owner.current)return!1;if(typeof r=="string"&&Ys()&&Ob(r)&&(r=Yd[r]),Mb(this.options)){const{onComplete:u,onUpdate:d,motionValue:f,element:y,...p}=this.options,v=Lb(e,p);e=v.keyframes,e.length===1&&(e[1]=e[0]),s=v.duration,i=v.times,r=v.ease,o="keyframes"}const h=Ab(a.owner.current,l,e,{...this.options,duration:s,times:i,ease:r});return h.startTime=c??this.calcStartTime(),this.pendingTimeline?(El(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:u}=this.options;a.set(wi(e,this.options,n)),u&&u(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:s,times:i,type:o,ease:r,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:n}=e;return $e(n)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:n}=e;return $e(n.currentTime||0)}set time(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.currentTime=Be(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:n}=e;return n.playbackRate}set speed(e){const{resolved:n}=this;if(!n)return;const{animation:s}=n;s.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:n}=e;return n.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:n}=e;return n.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:n}=this;if(!n)return ge;const{animation:s}=n;El(s,e)}return ge}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:n}=e;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:n,keyframes:s,duration:i,type:r,ease:o,times:a}=e;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:h,onComplete:u,element:d,...f}=this.options,y=new ia({...f,keyframes:s,duration:i,type:r,ease:o,times:a,isGenerator:!0}),p=Be(this.time);c.setWithVelocity(y.sample(p-Qs).value,y.sample(p).value,Qs)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:n,name:s,repeatDelay:i,repeatType:r,damping:o,type:a}=e;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=n.owner.getProps();return Db()&&s&&Nb.has(s)&&!l&&!c&&!i&&r!=="mirror"&&o!==0&&a!=="inertia"}}const Fb={type:"spring",stiffness:500,damping:25,restSpeed:10},jb=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Vb={type:"keyframes",duration:.8},Bb={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},$b=(t,{keyframes:e})=>e.length>2?Vb:St.has(t)?t.startsWith("scale")?jb(e[1]):Fb:Bb;function Ub({when:t,delay:e,delayChildren:n,staggerChildren:s,staggerDirection:i,repeat:r,repeatType:o,repeatDelay:a,from:l,elapsed:c,...h}){return!!Object.keys(h).length}const ra=(t,e,n,s={},i,r)=>o=>{const a=Ho(s,t)||{},l=a.delay||s.delay||0;let{elapsed:c=0}=s;c=c-Be(l);let h={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:d=>{e.set(d),a.onUpdate&&a.onUpdate(d)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:r?void 0:i};Ub(a)||(h={...h,...$b(t,h)}),h.duration&&(h.duration=Be(h.duration)),h.repeatDelay&&(h.repeatDelay=Be(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let u=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(h.duration=0,h.delay===0&&(u=!0)),u&&!r&&e.get()!==void 0){const d=wi(h.keyframes,a);if(d!==void 0)return X.update(()=>{h.onUpdate(d),h.onComplete()}),new aw([])}return!r&&Ul.supports(h)?new Ul(h):new ia(h)};function Wb({protectedKeys:t,needsAnimating:e},n){const s=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,s}function qd(t,e,{delay:n=0,transitionOverride:s,type:i}={}){var r;let{transition:o=t.getDefaultTransition(),transitionEnd:a,...l}=e;s&&(o=s);const c=[],h=i&&t.animationState&&t.animationState.getState()[i];for(const u in l){const d=t.getValue(u,(r=t.latestValues[u])!==null&&r!==void 0?r:null),f=l[u];if(f===void 0||h&&Wb(h,u))continue;const y={delay:n,...Ho(o||{},u)};let p=!1;if(window.MotionHandoffAnimation){const x=_d(t);if(x){const _=window.MotionHandoffAnimation(x,u,X);_!==null&&(y.startTime=_,p=!0)}}Cr(t,u),d.start(ra(u,d,f,t.shouldReduceMotion&&yd.has(u)?{type:!1}:y,t,p));const v=d.animation;v&&c.push(v)}return a&&Promise.all(c).then(()=>{X.update(()=>{a&&ww(t,a)})}),c}function Nr(t,e,n={}){var s;const i=xi(t,e,n.type==="exit"?(s=t.presenceContext)===null||s===void 0?void 0:s.custom:void 0);let{transition:r=t.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(r=n.transitionOverride);const o=i?()=>Promise.all(qd(t,i,n)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:h=0,staggerChildren:u,staggerDirection:d}=r;return Hb(t,e,h+c,u,d,n)}:()=>Promise.resolve(),{when:l}=r;if(l){const[c,h]=l==="beforeChildren"?[o,a]:[a,o];return c().then(()=>h())}else return Promise.all([o(),a(n.delay)])}function Hb(t,e,n=0,s=0,i=1,r){const o=[],a=(t.variantChildren.size-1)*s,l=i===1?(c=0)=>c*s:(c=0)=>a-c*s;return Array.from(t.variantChildren).sort(Gb).forEach((c,h)=>{c.notify("AnimationStart",e),o.push(Nr(c,e,{...r,delay:n+l(h)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function Gb(t,e){return t.sortNodePosition(e)}function zb(t,e,n={}){t.notify("AnimationStart",e);let s;if(Array.isArray(e)){const i=e.map(r=>Nr(t,r,n));s=Promise.all(i)}else if(typeof e=="string")s=Nr(t,e,n);else{const i=typeof e=="function"?xi(t,e,n.custom):e;s=Promise.all(qd(t,i,n))}return s.then(()=>{t.notify("AnimationComplete",e)})}const Kb=Do.length;function Xd(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?Xd(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<Kb;n++){const s=Do[n],i=t.props[s];(Hn(i)||i===!1)&&(e[s]=i)}return e}const Yb=[...Ao].reverse(),qb=Ao.length;function Xb(t){return e=>Promise.all(e.map(({animation:n,options:s})=>zb(t,n,s)))}function Qb(t){let e=Xb(t),n=Wl(),s=!0;const i=l=>(c,h)=>{var u;const d=xi(t,h,l==="exit"?(u=t.presenceContext)===null||u===void 0?void 0:u.custom:void 0);if(d){const{transition:f,transitionEnd:y,...p}=d;c={...c,...p,...y}}return c};function r(l){e=l(t)}function o(l){const{props:c}=t,h=Xd(t.parent)||{},u=[],d=new Set;let f={},y=1/0;for(let v=0;v<qb;v++){const x=Yb[v],_=n[x],w=c[x]!==void 0?c[x]:h[x],P=Hn(w),R=x===l?_.isActive:null;R===!1&&(y=v);let T=w===h[x]&&w!==c[x]&&P;if(T&&s&&t.manuallyAnimateOnMount&&(T=!1),_.protectedKeys={...f},!_.isActive&&R===null||!w&&!_.prevProp||vi(w)||typeof w=="boolean")continue;const O=Jb(_.prevProp,w);let D=O||x===l&&_.isActive&&!T&&P||v>y&&P,I=!1;const E=Array.isArray(w)?w:[w];let b=E.reduce(i(x),{});R===!1&&(b={});const{prevResolvedValues:S={}}=_,N={...S,...b},A=k=>{D=!0,d.has(k)&&(I=!0,d.delete(k)),_.needsAnimating[k]=!0;const U=t.getValue(k);U&&(U.liveStyle=!1)};for(const k in N){const U=b[k],de=S[k];if(f.hasOwnProperty(k))continue;let ve=!1;xr(U)&&xr(de)?ve=!cd(U,de):ve=U!==de,ve?U!=null?A(k):d.add(k):U!==void 0&&d.has(k)?A(k):_.protectedKeys[k]=!0}_.prevProp=w,_.prevResolvedValues=b,_.isActive&&(f={...f,...b}),s&&t.blockInitialAnimation&&(D=!1),D&&(!(T&&O)||I)&&u.push(...E.map(k=>({animation:k,options:{type:x}})))}if(d.size){const v={};d.forEach(x=>{const _=t.getBaseTarget(x),w=t.getValue(x);w&&(w.liveStyle=!0),v[x]=_??null}),u.push({animation:v})}let p=!!u.length;return s&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(p=!1),s=!1,p?e(u):Promise.resolve()}function a(l,c){var h;if(n[l].isActive===c)return Promise.resolve();(h=t.variantChildren)===null||h===void 0||h.forEach(d=>{var f;return(f=d.animationState)===null||f===void 0?void 0:f.setActive(l,c)}),n[l].isActive=c;const u=o(l);for(const d in n)n[d].protectedKeys={};return u}return{animateChanges:o,setActive:a,setAnimateFunction:r,getState:()=>n,reset:()=>{n=Wl(),s=!0}}}function Jb(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!cd(e,t):!1}function ct(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Wl(){return{animate:ct(!0),whileInView:ct(),whileHover:ct(),whileTap:ct(),whileDrag:ct(),whileFocus:ct(),exit:ct()}}class lt{constructor(e){this.isMounted=!1,this.node=e}update(){}}class Zb extends lt{constructor(e){super(e),e.animationState||(e.animationState=Qb(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();vi(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let eC=0;class tC extends lt{constructor(){super(...arguments),this.id=eC++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const i=this.node.animationState.setActive("exit",!e);n&&!e&&i.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const nC={animation:{Feature:Zb},exit:{Feature:tC}};function Yn(t,e,n,s={passive:!0}){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n)}function ls(t){return{point:{x:t.pageX,y:t.pageY}}}const sC=t=>e=>Ko(e)&&t(e,ls(e));function Pn(t,e,n,s){return Yn(t,e,sC(n),s)}const Hl=(t,e)=>Math.abs(t-e);function iC(t,e){const n=Hl(t.x,e.x),s=Hl(t.y,e.y);return Math.sqrt(n**2+s**2)}class Qd{constructor(e,n,{transformPagePoint:s,contextWindow:i,dragSnapToOrigin:r=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const u=Wi(this.lastMoveEventInfo,this.history),d=this.startEvent!==null,f=iC(u.offset,{x:0,y:0})>=3;if(!d&&!f)return;const{point:y}=u,{timestamp:p}=ce;this.history.push({...y,timestamp:p});const{onStart:v,onMove:x}=this.handlers;d||(v&&v(this.lastMoveEvent,u),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,u)},this.handlePointerMove=(u,d)=>{this.lastMoveEvent=u,this.lastMoveEventInfo=Ui(d,this.transformPagePoint),X.update(this.updatePoint,!0)},this.handlePointerUp=(u,d)=>{this.end();const{onEnd:f,onSessionEnd:y,resumeAnimation:p}=this.handlers;if(this.dragSnapToOrigin&&p&&p(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=Wi(u.type==="pointercancel"?this.lastMoveEventInfo:Ui(d,this.transformPagePoint),this.history);this.startEvent&&f&&f(u,v),y&&y(u,v)},!Ko(e))return;this.dragSnapToOrigin=r,this.handlers=n,this.transformPagePoint=s,this.contextWindow=i||window;const o=ls(e),a=Ui(o,this.transformPagePoint),{point:l}=a,{timestamp:c}=ce;this.history=[{...l,timestamp:c}];const{onSessionStart:h}=n;h&&h(e,Wi(a,this.history)),this.removeListeners=as(Pn(this.contextWindow,"pointermove",this.handlePointerMove),Pn(this.contextWindow,"pointerup",this.handlePointerUp),Pn(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),rt(this.updatePoint)}}function Ui(t,e){return e?{point:e(t.point)}:t}function Gl(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Wi({point:t},e){return{point:t,delta:Gl(t,Jd(e)),offset:Gl(t,rC(e)),velocity:oC(e,.1)}}function rC(t){return t[0]}function Jd(t){return t[t.length-1]}function oC(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,s=null;const i=Jd(t);for(;n>=0&&(s=t[n],!(i.timestamp-s.timestamp>Be(e)));)n--;if(!s)return{x:0,y:0};const r=$e(i.timestamp-s.timestamp);if(r===0)return{x:0,y:0};const o={x:(i.x-s.x)/r,y:(i.y-s.y)/r};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}const Zd=1e-4,aC=1-Zd,lC=1+Zd,ef=.01,cC=0-ef,uC=0+ef;function ye(t){return t.max-t.min}function hC(t,e,n){return Math.abs(t-e)<=n}function zl(t,e,n,s=.5){t.origin=s,t.originPoint=J(e.min,e.max,t.origin),t.scale=ye(n)/ye(e),t.translate=J(n.min,n.max,t.origin)-t.originPoint,(t.scale>=aC&&t.scale<=lC||isNaN(t.scale))&&(t.scale=1),(t.translate>=cC&&t.translate<=uC||isNaN(t.translate))&&(t.translate=0)}function Rn(t,e,n,s){zl(t.x,e.x,n.x,s?s.originX:void 0),zl(t.y,e.y,n.y,s?s.originY:void 0)}function Kl(t,e,n){t.min=n.min+e.min,t.max=t.min+ye(e)}function dC(t,e,n){Kl(t.x,e.x,n.x),Kl(t.y,e.y,n.y)}function Yl(t,e,n){t.min=e.min-n.min,t.max=t.min+ye(e)}function In(t,e,n){Yl(t.x,e.x,n.x),Yl(t.y,e.y,n.y)}function fC(t,{min:e,max:n},s){return e!==void 0&&t<e?t=s?J(e,t,s.min):Math.max(t,e):n!==void 0&&t>n&&(t=s?J(n,t,s.max):Math.min(t,n)),t}function ql(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function pC(t,{top:e,left:n,bottom:s,right:i}){return{x:ql(t.x,n,i),y:ql(t.y,e,s)}}function Xl(t,e){let n=e.min-t.min,s=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,s]=[s,n]),{min:n,max:s}}function mC(t,e){return{x:Xl(t.x,e.x),y:Xl(t.y,e.y)}}function gC(t,e){let n=.5;const s=ye(t),i=ye(e);return i>s?n=Yt(e.min,e.max-s,t.min):s>i&&(n=Yt(t.min,t.max-i,e.min)),Ge(0,1,n)}function yC(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const Ar=.35;function vC(t=Ar){return t===!1?t=0:t===!0&&(t=Ar),{x:Ql(t,"left","right"),y:Ql(t,"top","bottom")}}function Ql(t,e,n){return{min:Jl(t,e),max:Jl(t,n)}}function Jl(t,e){return typeof t=="number"?t:t[e]||0}const Zl=()=>({translate:0,scale:1,origin:0,originPoint:0}),Mt=()=>({x:Zl(),y:Zl()}),ec=()=>({min:0,max:0}),se=()=>({x:ec(),y:ec()});function xe(t){return[t("x"),t("y")]}function tf({top:t,left:e,right:n,bottom:s}){return{x:{min:e,max:n},y:{min:t,max:s}}}function _C({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function xC(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),s=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}function Hi(t){return t===void 0||t===1}function Dr({scale:t,scaleX:e,scaleY:n}){return!Hi(t)||!Hi(e)||!Hi(n)}function dt(t){return Dr(t)||nf(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function nf(t){return tc(t.x)||tc(t.y)}function tc(t){return t&&t!=="0%"}function Js(t,e,n){const s=t-n,i=e*s;return n+i}function nc(t,e,n,s,i){return i!==void 0&&(t=Js(t,i,s)),Js(t,n,s)+e}function kr(t,e=0,n=1,s,i){t.min=nc(t.min,e,n,s,i),t.max=nc(t.max,e,n,s,i)}function sf(t,{x:e,y:n}){kr(t.x,e.translate,e.scale,e.originPoint),kr(t.y,n.translate,n.scale,n.originPoint)}const sc=.999999999999,ic=1.0000000000001;function wC(t,e,n,s=!1){const i=n.length;if(!i)return;e.x=e.y=1;let r,o;for(let a=0;a<i;a++){r=n[a],o=r.projectionDelta;const{visualElement:l}=r.options;l&&l.props.style&&l.props.style.display==="contents"||(s&&r.options.layoutScroll&&r.scroll&&r!==r.root&&Ot(t,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,sf(t,o)),s&&dt(r.latestValues)&&Ot(t,r.latestValues))}e.x<ic&&e.x>sc&&(e.x=1),e.y<ic&&e.y>sc&&(e.y=1)}function Lt(t,e){t.min=t.min+e,t.max=t.max+e}function rc(t,e,n,s,i=.5){const r=J(t.min,t.max,i);kr(t,e,n,r,s)}function Ot(t,e){rc(t.x,e.x,e.scaleX,e.scale,e.originX),rc(t.y,e.y,e.scaleY,e.scale,e.originY)}function rf(t,e){return tf(xC(t.getBoundingClientRect(),e))}function bC(t,e,n){const s=rf(t,n),{scroll:i}=e;return i&&(Lt(s.x,i.offset.x),Lt(s.y,i.offset.y)),s}const of=({current:t})=>t?t.ownerDocument.defaultView:null,CC=new WeakMap;class SC{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=se(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const i=h=>{const{dragSnapToOrigin:u}=this.getProps();u?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(ls(h).point)},r=(h,u)=>{const{drag:d,dragPropagation:f,onDragStart:y}=this.getProps();if(d&&!f&&(this.openDragLock&&this.openDragLock(),this.openDragLock=gw(d),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),xe(v=>{let x=this.getAxisMotionValue(v).get()||0;if(Ie.test(x)){const{projection:_}=this.visualElement;if(_&&_.layout){const w=_.layout.layoutBox[v];w&&(x=ye(w)*(parseFloat(x)/100))}}this.originPoint[v]=x}),y&&X.postRender(()=>y(h,u)),Cr(this.visualElement,"transform");const{animationState:p}=this.visualElement;p&&p.setActive("whileDrag",!0)},o=(h,u)=>{const{dragPropagation:d,dragDirectionLock:f,onDirectionLock:y,onDrag:p}=this.getProps();if(!d&&!this.openDragLock)return;const{offset:v}=u;if(f&&this.currentDirection===null){this.currentDirection=EC(v),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",u.point,v),this.updateAxis("y",u.point,v),this.visualElement.render(),p&&p(h,u)},a=(h,u)=>this.stop(h,u),l=()=>xe(h=>{var u;return this.getAnimationState(h)==="paused"&&((u=this.getAxisMotionValue(h).animation)===null||u===void 0?void 0:u.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new Qd(e,{onSessionStart:i,onStart:r,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:of(this.visualElement)})}stop(e,n){const s=this.isDragging;if(this.cancel(),!s)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:r}=this.getProps();r&&X.postRender(()=>r(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,s){const{drag:i}=this.getProps();if(!s||!ys(e,i,this.currentDirection))return;const r=this.getAxisMotionValue(e);let o=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(o=fC(o,this.constraints[e],this.elastic[e])),r.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:s}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,r=this.constraints;n&&Dt(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&i?this.constraints=pC(i.layoutBox,n):this.constraints=!1,this.elastic=vC(s),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&xe(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=yC(i.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Dt(e))return!1;const s=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const r=bC(s,i.root,this.visualElement.getTransformPagePoint());let o=mC(i.layout.layoutBox,r);if(n){const a=n(_C(o));this.hasMutatedConstraints=!!a,a&&(o=tf(a))}return o}startAnimation(e){const{drag:n,dragMomentum:s,dragElastic:i,dragTransition:r,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=xe(h=>{if(!ys(h,n,this.currentDirection))return;let u=l&&l[h]||{};o&&(u={min:0,max:0});const d=i?200:1e6,f=i?40:1e7,y={type:"inertia",velocity:s?e[h]:0,bounceStiffness:d,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...r,...u};return this.startAxisValueAnimation(h,y)});return Promise.all(c).then(a)}startAxisValueAnimation(e,n){const s=this.getAxisMotionValue(e);return Cr(this.visualElement,e),s.start(ra(e,s,0,n,this.visualElement,!1))}stopAnimation(){xe(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){xe(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps(),i=s[n];return i||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){xe(n=>{const{drag:s}=this.getProps();if(!ys(n,s,this.currentDirection))return;const{projection:i}=this.visualElement,r=this.getAxisMotionValue(n);if(i&&i.layout){const{min:o,max:a}=i.layout.layoutBox[n];r.set(e[n]-J(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:s}=this.visualElement;if(!Dt(n)||!s||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};xe(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();i[o]=gC({min:l,max:l},this.constraints[o])}});const{transformTemplate:r}=this.visualElement.getProps();this.visualElement.current.style.transform=r?r({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),xe(o=>{if(!ys(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(J(l,c,i[o]))})}addListeners(){if(!this.visualElement.current)return;CC.set(this.visualElement,this);const e=this.visualElement.current,n=Pn(e,"pointerdown",l=>{const{drag:c,dragListener:h=!0}=this.getProps();c&&h&&this.start(l)}),s=()=>{const{dragConstraints:l}=this.getProps();Dt(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,r=i.addEventListener("measure",s);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),X.read(s);const o=Yn(window,"resize",()=>this.scalePositionWithinConstraints()),a=i.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(xe(h=>{const u=this.getAxisMotionValue(h);u&&(this.originPoint[h]+=l[h].translate,u.set(u.get()+l[h].translate))}),this.visualElement.render())});return()=>{o(),n(),r(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:s=!1,dragPropagation:i=!1,dragConstraints:r=!1,dragElastic:o=Ar,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:s,dragPropagation:i,dragConstraints:r,dragElastic:o,dragMomentum:a}}}function ys(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function EC(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class TC extends lt{constructor(e){super(e),this.removeGroupControls=ge,this.removeListeners=ge,this.controls=new SC(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ge}unmount(){this.removeGroupControls(),this.removeListeners()}}const oc=t=>(e,n)=>{t&&X.postRender(()=>t(e,n))};class PC extends lt{constructor(){super(...arguments),this.removePointerDownListener=ge}onPointerDown(e){this.session=new Qd(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:of(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:s,onPanEnd:i}=this.node.getProps();return{onSessionStart:oc(e),onStart:oc(n),onMove:s,onEnd:(r,o)=>{delete this.session,i&&X.postRender(()=>i(r,o))}}}mount(){this.removePointerDownListener=Pn(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Es={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function ac(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const gn={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(M.test(t))t=parseFloat(t);else return t;const n=ac(t,e.target.x),s=ac(t,e.target.y);return`${n}% ${s}%`}},RC={correct:(t,{treeScale:e,projectionDelta:n})=>{const s=t,i=ot.parse(t);if(i.length>5)return s;const r=ot.createTransformer(t),o=typeof i[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;i[0+o]/=a,i[1+o]/=l;const c=J(a,l,.5);return typeof i[2+o]=="number"&&(i[2+o]/=c),typeof i[3+o]=="number"&&(i[3+o]/=c),r(i)}};class IC extends m.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s,layoutId:i}=this.props,{projection:r}=e;qx(NC),r&&(n.group&&n.group.add(r),s&&s.register&&i&&s.register(r),r.root.didUpdate(),r.addEventListener("animationComplete",()=>{this.safeToRemove()}),r.setOptions({...r.options,onExitComplete:()=>this.safeToRemove()})),Es.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:s,drag:i,isPresent:r}=this.props,o=s.projection;return o&&(o.isPresent=r,i||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==r&&(r?o.promote():o.relegate()||X.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Mo.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),s&&s.deregister&&s.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function af(t){const[e,n]=ux(),s=m.useContext(Uh);return g.jsx(IC,{...t,layoutGroup:s,switchLayoutGroup:m.useContext(Xh),isPresent:e,safeToRemove:n})}const NC={borderRadius:{...gn,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:gn,borderTopRightRadius:gn,borderBottomLeftRadius:gn,borderBottomRightRadius:gn,boxShadow:RC};function AC(t,e,n){const s=he(t)?t:zn(t);return s.start(ra("",s,e,n)),s.animation}function DC(t){return t instanceof SVGElement&&t.tagName!=="svg"}const kC=(t,e)=>t.depth-e.depth;class MC{constructor(){this.children=[],this.isDirty=!1}add(e){Yo(this.children,e),this.isDirty=!0}remove(e){qo(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(kC),this.isDirty=!1,this.children.forEach(e)}}function LC(t,e){const n=Ne.now(),s=({timestamp:i})=>{const r=i-n;r>=e&&(rt(s),t(r-e))};return X.read(s,!0),()=>rt(s)}const lf=["TopLeft","TopRight","BottomLeft","BottomRight"],OC=lf.length,lc=t=>typeof t=="string"?parseFloat(t):t,cc=t=>typeof t=="number"||M.test(t);function FC(t,e,n,s,i,r){i?(t.opacity=J(0,n.opacity!==void 0?n.opacity:1,jC(s)),t.opacityExit=J(e.opacity!==void 0?e.opacity:1,0,VC(s))):r&&(t.opacity=J(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,s));for(let o=0;o<OC;o++){const a=`border${lf[o]}Radius`;let l=uc(e,a),c=uc(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||cc(l)===cc(c)?(t[a]=Math.max(J(lc(l),lc(c),s),0),(Ie.test(c)||Ie.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||n.rotate)&&(t.rotate=J(e.rotate||0,n.rotate||0,s))}function uc(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const jC=cf(0,.5,Td),VC=cf(.5,.95,ge);function cf(t,e,n){return s=>s<t?0:s>e?1:n(Yt(t,e,s))}function hc(t,e){t.min=e.min,t.max=e.max}function _e(t,e){hc(t.x,e.x),hc(t.y,e.y)}function dc(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function fc(t,e,n,s,i){return t-=e,t=Js(t,1/n,s),i!==void 0&&(t=Js(t,1/i,s)),t}function BC(t,e=0,n=1,s=.5,i,r=t,o=t){if(Ie.test(e)&&(e=parseFloat(e),e=J(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=J(r.min,r.max,s);t===r&&(a-=e),t.min=fc(t.min,e,n,a,i),t.max=fc(t.max,e,n,a,i)}function pc(t,e,[n,s,i],r,o){BC(t,e[n],e[s],e[i],e.scale,r,o)}const $C=["x","scaleX","originX"],UC=["y","scaleY","originY"];function mc(t,e,n,s){pc(t.x,e,$C,n?n.x:void 0,s?s.x:void 0),pc(t.y,e,UC,n?n.y:void 0,s?s.y:void 0)}function gc(t){return t.translate===0&&t.scale===1}function uf(t){return gc(t.x)&&gc(t.y)}function yc(t,e){return t.min===e.min&&t.max===e.max}function WC(t,e){return yc(t.x,e.x)&&yc(t.y,e.y)}function vc(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function hf(t,e){return vc(t.x,e.x)&&vc(t.y,e.y)}function _c(t){return ye(t.x)/ye(t.y)}function xc(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class HC{constructor(){this.members=[]}add(e){Yo(this.members,e),e.scheduleRender()}remove(e){if(qo(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(i=>e===i);if(n===0)return!1;let s;for(let i=n;i>=0;i--){const r=this.members[i];if(r.isPresent!==!1){s=r;break}}return s?(this.promote(s),!0):!1}promote(e,n){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,n&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:s}=e;n.onExitComplete&&n.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function GC(t,e,n){let s="";const i=t.x.translate/e.x,r=t.y.translate/e.y,o=(n==null?void 0:n.z)||0;if((i||r||o)&&(s=`translate3d(${i}px, ${r}px, ${o}px) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:c,rotate:h,rotateX:u,rotateY:d,skewX:f,skewY:y}=n;c&&(s=`perspective(${c}px) ${s}`),h&&(s+=`rotate(${h}deg) `),u&&(s+=`rotateX(${u}deg) `),d&&(s+=`rotateY(${d}deg) `),f&&(s+=`skewX(${f}deg) `),y&&(s+=`skewY(${y}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(s+=`scale(${a}, ${l})`),s||"none"}const ft={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},xn=typeof window<"u"&&window.MotionDebug!==void 0,Gi=["","X","Y","Z"],zC={visibility:"hidden"},wc=1e3;let KC=0;function zi(t,e,n,s){const{latestValues:i}=e;i[t]&&(n[t]=i[t],e.setStaticValue(t,0),s&&(s[t]=0))}function df(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=_d(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:r}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",X,!(i||r))}const{parent:s}=t;s&&!s.hasCheckedOptimisedAppear&&df(s)}function ff({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:s,resetTransform:i}){return class{constructor(o={},a=e==null?void 0:e()){this.id=KC++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,xn&&(ft.totalNodes=ft.resolvedTargetDeltas=ft.recalculatedProjection=0),this.nodes.forEach(XC),this.nodes.forEach(tS),this.nodes.forEach(nS),this.nodes.forEach(QC),xn&&window.MotionDebug.record(ft)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new MC)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Xo),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=DC(o),this.instance=o;const{layoutId:l,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),t){let u;const d=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=LC(d,250),Es.hasAnimatedSinceResize&&(Es.hasAnimatedSinceResize=!1,this.nodes.forEach(Cc))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||c)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeTargetChanged:f,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||h.getDefaultTransition()||aS,{onLayoutAnimationStart:v,onLayoutAnimationComplete:x}=h.getProps(),_=!this.targetLayout||!hf(this.targetLayout,y)||f,w=!d&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||w||d&&(_||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,w);const P={...Ho(p,"layout"),onPlay:v,onComplete:x};(h.shouldReduceMotion||this.options.layoutRoot)&&(P.delay=0,P.type=!1),this.startAnimation(P)}else d||Cc(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,rt(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(sS),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&df(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const u=this.path[h];u.shouldResetTransform=!0,u.updateScroll("snapshot"),u.options.layoutRoot&&u.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(bc);return}this.isUpdating||this.nodes.forEach(ZC),this.isUpdating=!1,this.nodes.forEach(eS),this.nodes.forEach(YC),this.nodes.forEach(qC),this.clearAllSnapshots();const a=Ne.now();ce.delta=Ge(0,1e3/60,a-ce.timestamp),ce.timestamp=a,ce.isProcessing=!0,Fi.update.process(ce),Fi.preRender.process(ce),Fi.render.process(ce),ce.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Mo.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(JC),this.sharedNodes.forEach(iS)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,X.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){X.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=se(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const l=s(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!uf(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,h=c!==this.prevTransformTemplateValue;o&&(a||dt(this.latestValues)||h)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),lS(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return se();const l=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(cS))){const{scroll:h}=this.root;h&&(Lt(l.x,h.offset.x),Lt(l.y,h.offset.y))}return l}removeElementScroll(o){var a;const l=se();if(_e(l,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return l;for(let c=0;c<this.path.length;c++){const h=this.path[c],{scroll:u,options:d}=h;h!==this.root&&u&&d.layoutScroll&&(u.wasRoot&&_e(l,o),Lt(l.x,u.offset.x),Lt(l.y,u.offset.y))}return l}applyTransform(o,a=!1){const l=se();_e(l,o);for(let c=0;c<this.path.length;c++){const h=this.path[c];!a&&h.options.layoutScroll&&h.scroll&&h!==h.root&&Ot(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),dt(h.latestValues)&&Ot(l,h.latestValues)}return dt(this.latestValues)&&Ot(l,this.latestValues),l}removeTransform(o){const a=se();_e(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!dt(c.latestValues))continue;Dr(c.latestValues)&&c.updateSnapshot();const h=se(),u=c.measurePageBox();_e(h,u),mc(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,h)}return dt(this.latestValues)&&mc(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ce.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=ce.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=se(),this.relativeTargetOrigin=se(),In(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),_e(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=se(),this.targetWithTransforms=se()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),dC(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):_e(this.target,this.layout.layoutBox),sf(this.target,this.targetDelta)):_e(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=se(),this.relativeTargetOrigin=se(),In(this.relativeTargetOrigin,this.target,f.target),_e(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}xn&&ft.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Dr(this.parent.latestValues)||nf(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===ce.timestamp&&(c=!1),c)return;const{layout:h,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||u))return;_e(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,f=this.treeScale.y;wC(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=se());const{target:y}=a;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(dc(this.prevProjectionDelta.x,this.projectionDelta.x),dc(this.prevProjectionDelta.y,this.projectionDelta.y)),Rn(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==f||!xc(this.projectionDelta.x,this.prevProjectionDelta.x)||!xc(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y)),xn&&ft.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Mt(),this.projectionDelta=Mt(),this.projectionDeltaWithTransform=Mt()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},h={...this.latestValues},u=Mt();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const d=se(),f=l?l.source:void 0,y=this.layout?this.layout.source:void 0,p=f!==y,v=this.getStack(),x=!v||v.members.length<=1,_=!!(p&&!x&&this.options.crossfade===!0&&!this.path.some(oS));this.animationProgress=0;let w;this.mixTargetDelta=P=>{const R=P/1e3;Sc(u.x,o.x,R),Sc(u.y,o.y,R),this.setTargetDelta(u),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(In(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),rS(this.relativeTarget,this.relativeTargetOrigin,d,R),w&&WC(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=se()),_e(w,this.relativeTarget)),p&&(this.animationValues=h,FC(h,c,this.latestValues,R,_,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=R},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(rt(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=X.update(()=>{Es.hasAnimatedSinceResize=!0,this.currentAnimation=AC(0,wc,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(wc),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:h}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&pf(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||se();const u=ye(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+u;const d=ye(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+d}_e(a,l),Ot(a,h),Rn(this.projectionDeltaWithTransform,this.layoutCorrected,a,h)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new HC),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&zi("z",o,c,this.animationValues);for(let h=0;h<Gi.length;h++)zi(`rotate${Gi[h]}`,o,c,this.animationValues),zi(`skew${Gi[h]}`,o,c,this.animationValues);o.render();for(const h in c)o.setStaticValue(h,c[h]),this.animationValues&&(this.animationValues[h]=c[h]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return zC;const c={visibility:""},h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=Cs(o==null?void 0:o.pointerEvents)||"",c.transform=h?h(this.latestValues,""):"none",c;const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){const p={};return this.options.layoutId&&(p.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,p.pointerEvents=Cs(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!dt(this.latestValues)&&(p.transform=h?h({},""):"none",this.hasProjected=!1),p}const d=u.animationValues||u.latestValues;this.applyTransformsToTarget(),c.transform=GC(this.projectionDeltaWithTransform,this.treeScale,d),h&&(c.transform=h(d,c.transform));const{x:f,y}=this.projectionDelta;c.transformOrigin=`${f.origin*100}% ${y.origin*100}% 0`,u.animationValues?c.opacity=u===this?(l=(a=d.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:c.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const p in Ks){if(d[p]===void 0)continue;const{correct:v,applyTo:x}=Ks[p],_=c.transform==="none"?d[p]:v(d[p],u);if(x){const w=x.length;for(let P=0;P<w;P++)c[x[P]]=_}else c[p]=_}return this.options.layoutId&&(c.pointerEvents=u===this?Cs(o==null?void 0:o.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(bc),this.root.sharedNodes.clear()}}}function YC(t){t.updateLayout()}function qC(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:i}=t.layout,{animationType:r}=t.options,o=n.source!==t.layout.source;r==="size"?xe(u=>{const d=o?n.measuredBox[u]:n.layoutBox[u],f=ye(d);d.min=s[u].min,d.max=d.min+f}):pf(r,n.layoutBox,s)&&xe(u=>{const d=o?n.measuredBox[u]:n.layoutBox[u],f=ye(s[u]);d.max=d.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[u].max=t.relativeTarget[u].min+f)});const a=Mt();Rn(a,s,n.layoutBox);const l=Mt();o?Rn(l,t.applyTransform(i,!0),n.measuredBox):Rn(l,s,n.layoutBox);const c=!uf(a);let h=!1;if(!t.resumeFrom){const u=t.getClosestProjectingParent();if(u&&!u.resumeFrom){const{snapshot:d,layout:f}=u;if(d&&f){const y=se();In(y,n.layoutBox,d.layoutBox);const p=se();In(p,s,f.layoutBox),hf(y,p)||(h=!0),u.options.layoutRoot&&(t.relativeTarget=p,t.relativeTargetOrigin=y,t.relativeParent=u)}}}t.notifyListeners("didUpdate",{layout:s,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:h})}else if(t.isLead()){const{onExitComplete:s}=t.options;s&&s()}t.options.transition=void 0}function XC(t){xn&&ft.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function QC(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function JC(t){t.clearSnapshot()}function bc(t){t.clearMeasurements()}function ZC(t){t.isLayoutDirty=!1}function eS(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function Cc(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function tS(t){t.resolveTargetDelta()}function nS(t){t.calcProjection()}function sS(t){t.resetSkewAndRotation()}function iS(t){t.removeLeadSnapshot()}function Sc(t,e,n){t.translate=J(e.translate,0,n),t.scale=J(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function Ec(t,e,n,s){t.min=J(e.min,n.min,s),t.max=J(e.max,n.max,s)}function rS(t,e,n,s){Ec(t.x,e.x,n.x,s),Ec(t.y,e.y,n.y,s)}function oS(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const aS={duration:.45,ease:[.4,0,.1,1]},Tc=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),Pc=Tc("applewebkit/")&&!Tc("chrome/")?Math.round:ge;function Rc(t){t.min=Pc(t.min),t.max=Pc(t.max)}function lS(t){Rc(t.x),Rc(t.y)}function pf(t,e,n){return t==="position"||t==="preserve-aspect"&&!hC(_c(e),_c(n),.2)}function cS(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const uS=ff({attachResizeListener:(t,e)=>Yn(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Ki={current:void 0},mf=ff({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Ki.current){const t=new uS({});t.mount(window),t.setOptions({layoutScroll:!0}),Ki.current=t}return Ki.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),hS={pan:{Feature:PC},drag:{Feature:TC,ProjectionNode:mf,MeasureLayout:af}};function Ic(t,e,n){const{props:s}=t;t.animationState&&s.whileHover&&t.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,r=s[i];r&&X.postRender(()=>r(e,ls(e)))}class dS extends lt{mount(){const{current:e}=this.node;e&&(this.unmount=hw(e,n=>(Ic(this.node,n,"Start"),s=>Ic(this.node,s,"End"))))}unmount(){}}class fS extends lt{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=as(Yn(this.node.current,"focus",()=>this.onFocus()),Yn(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function Nc(t,e,n){const{props:s}=t;t.animationState&&s.whileTap&&t.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),r=s[i];r&&X.postRender(()=>r(e,ls(e)))}class pS extends lt{mount(){const{current:e}=this.node;e&&(this.unmount=mw(e,n=>(Nc(this.node,n,"Start"),(s,{success:i})=>Nc(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Mr=new WeakMap,Yi=new WeakMap,mS=t=>{const e=Mr.get(t.target);e&&e(t)},gS=t=>{t.forEach(mS)};function yS({root:t,...e}){const n=t||document;Yi.has(n)||Yi.set(n,{});const s=Yi.get(n),i=JSON.stringify(e);return s[i]||(s[i]=new IntersectionObserver(gS,{root:t,...e})),s[i]}function vS(t,e,n){const s=yS(e);return Mr.set(t,n),s.observe(t),()=>{Mr.delete(t),s.unobserve(t)}}const _S={some:0,all:1};class xS extends lt{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:s,amount:i="some",once:r}=e,o={root:n?n.current:void 0,rootMargin:s,threshold:typeof i=="number"?i:_S[i]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,r&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:h,onViewportLeave:u}=this.node.getProps(),d=c?h:u;d&&d(l)};return vS(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(wS(e,n))&&this.startObserver()}unmount(){}}function wS({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const bS={inView:{Feature:xS},tap:{Feature:pS},focus:{Feature:fS},hover:{Feature:dS}},CS={layout:{ProjectionNode:mf,MeasureLayout:af}},Lr={current:null},gf={current:!1};function SS(){if(gf.current=!0,!!Io)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Lr.current=t.matches;t.addListener(e),e()}else Lr.current=!1}const ES=[...Bd,ue,ot],TS=t=>ES.find(Vd(t)),Ac=new WeakMap;function PS(t,e,n){for(const s in e){const i=e[s],r=n[s];if(he(i))t.addValue(s,i);else if(he(r))t.addValue(s,zn(i,{owner:t}));else if(r!==i)if(t.hasValue(s)){const o=t.getValue(s);o.liveStyle===!0?o.jump(i):o.hasAnimated||o.set(i)}else{const o=t.getStaticValue(s);t.addValue(s,zn(o!==void 0?o:i,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const Dc=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class RS{scrapeMotionValuesFromProps(e,n,s){return{}}constructor({parent:e,props:n,presenceContext:s,reducedMotionConfig:i,blockInitialAnimation:r,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=na,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=Ne.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,X.render(this.render,!1,!0))};const{latestValues:l,renderState:c,onUpdate:h}=o;this.onUpdate=h,this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.blockInitialAnimation=!!r,this.isControllingVariants=_i(n),this.isVariantNode=Yh(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const f in d){const y=d[f];l[f]!==void 0&&he(y)&&y.set(l[f],!1)}}mount(e){this.current=e,Ac.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),gf.current||SS(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Lr.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Ac.delete(this.current),this.projection&&this.projection.unmount(),rt(this.notifyUpdate),rt(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const s=St.has(e),i=n.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&X.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),r=n.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{i(),r(),o&&o(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in qt){const n=qt[e];if(!n)continue;const{isEnabled:s,Feature:i}=n;if(!this.features[e]&&i&&s(this.props)&&(this.features[e]=new i(this)),this.features[e]){const r=this.features[e];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):se()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<Dc.length;s++){const i=Dc[s];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const r="on"+i,o=e[r];o&&(this.propEventSubscriptions[i]=this.on(i,o))}this.prevMotionValues=PS(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const s=this.values.get(e);n!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&n!==void 0&&(s=zn(n===null?void 0:n,{owner:this}),this.addValue(e,s)),s}readValue(e,n){var s;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(s=this.getBaseTargetFromProps(this.props,e))!==null&&s!==void 0?s:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(Fd(i)||Rd(i))?i=parseFloat(i):!TS(i)&&ot.test(n)&&(i=Md(e,n)),this.setBaseTarget(e,he(i)?i.get():i)),he(i)?i.get():i}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:s}=this.props;let i;if(typeof s=="string"||typeof s=="object"){const o=Oo(this.props,s,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);o&&(i=o[e])}if(s&&i!==void 0)return i;const r=this.getBaseTargetFromProps(this.props,e);return r!==void 0&&!he(r)?r:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new Xo),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class yf extends RS{constructor(){super(...arguments),this.KeyframeResolver=$d}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:s}){delete n[e],delete s[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;he(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function IS(t){return window.getComputedStyle(t)}class NS extends yf{constructor(){super(...arguments),this.type="html",this.renderInstance=sd}readValueFromInstance(e,n){if(St.has(n)){const s=ta(n);return s&&s.default||0}else{const s=IS(e),i=(ed(n)?s.getPropertyValue(n):s[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return rf(e,n)}build(e,n,s){Vo(e,n,s.transformTemplate)}scrapeMotionValuesFromProps(e,n,s){return Wo(e,n,s)}}class AS extends yf{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=se}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(St.has(n)){const s=ta(n);return s&&s.default||0}return n=id.has(n)?n:ko(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,s){return ad(e,n,s)}build(e,n,s){Bo(e,n,this.isSVGTag,s.transformTemplate)}renderInstance(e,n,s,i){rd(e,n,s,i)}mount(e){this.isSVGTag=Uo(e.tagName),super.mount(e)}}const DS=(t,e)=>Lo(t)?new AS(e):new NS(e,{allowProjection:t!==m.Fragment}),kS=iw({...nC,...bS,...hS,...CS},DS),Or=_x(kS),kc=["GAMES","QUEST","MAGIC","BRAVE","STORM","PLANT","DANCE","MUSIC","HEART","LIGHT","DREAM","SPACE","OCEAN","MOUNT","TIGER","PEACE"],Mc=({onGameEnd:t,isHost:e,sendGameState:n})=>{const[s,i]=m.useState(""),[r,o]=m.useState({word:"",guesses:[],currentPlayer:"host",winner:null,gamePhase:"waiting",maxGuesses:6,timeLeft:30});m.useEffect(()=>{if(e&&r.gamePhase==="waiting"){const f=kc[Math.floor(Math.random()*kc.length)],y={...r,word:f,currentPlayer:"host",gamePhase:"playing",timeLeft:30};o(y),n({type:"wordduel",data:y})}},[e]),m.useEffect(()=>{const f=y=>{const p=y.detail;p.type==="wordduel"&&(o(p.data),p.data.winner&&p.data.winner!=="draw"?setTimeout(()=>t(p.data.winner),1500):p.data.winner==="draw"&&setTimeout(()=>t(null),1500))};return window.addEventListener("game_state",f),()=>{window.removeEventListener("game_state",f)}},[t]),m.useEffect(()=>{let f;const y=e?"host":"guest";return r.gamePhase==="playing"&&r.currentPlayer===y&&r.timeLeft>0&&(f=setInterval(()=>{o(p=>{const v=p.timeLeft-1;if(v<=0){const x={...p,currentPlayer:p.currentPlayer==="host"?"guest":"host",timeLeft:30};return n({type:"wordduel",data:x}),x}return{...p,timeLeft:v}})},1e3)),()=>clearInterval(f)},[r.gamePhase,r.currentPlayer,e,n]);const a=(f,y)=>{const p=[],v=y.split(""),x=f.split("");for(let _=0;_<x.length;_++)x[_]===v[_]&&(p[_]="correct",v[_]="",x[_]="");for(let _=0;_<x.length;_++)if(x[_]&&v.includes(x[_])){p[_]="present";const w=v.indexOf(x[_]);v[w]=""}else x[_]&&(p[_]="absent");return p},l=()=>{const f=e?"host":"guest";if(s.length!==5||r.currentPlayer!==f)return;const y=a(s.toUpperCase(),r.word),p=y.every(_=>_==="correct"),v={word:s.toUpperCase(),feedback:y,player:f},x={...r,guesses:[...r.guesses,v],winner:p?f:null,gamePhase:p?"finished":r.gamePhase,currentPlayer:p?r.currentPlayer:r.currentPlayer==="host"?"guest":"host",timeLeft:30};x.guesses.length>=r.maxGuesses&&!p&&(x.gamePhase="finished",x.winner="draw"),o(x),n({type:"wordduel",data:x}),i("")},c=f=>{f.key==="Enter"&&l()},h=f=>{switch(f){case"correct":return"bg-green-500";case"present":return"bg-yellow-500";case"absent":return"bg-gray-500";default:return"bg-gray-700"}},u=e?"host":"guest",d=r.currentPlayer===u;return g.jsxs("div",{className:"max-w-2xl mx-auto p-6 bg-slate-800 rounded-xl",children:[g.jsxs("div",{className:"text-center mb-6",children:[g.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Word Duel"}),g.jsx("p",{className:"text-gray-400",children:"Guess the 5-letter word before your opponent!"})]}),g.jsxs("div",{className:"flex justify-between items-center mb-6 p-4 bg-slate-700 rounded-lg",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Vc,{className:"w-5 h-5 text-blue-400"}),g.jsx("span",{className:"text-white",children:d?"Your Turn":"Opponent's Turn"})]}),g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(Af,{className:"w-5 h-5 text-yellow-400"}),g.jsxs("span",{className:"text-white font-mono",children:[r.timeLeft,"s"]})]})]}),g.jsxs("div",{className:"mb-6 space-y-2",children:[r.guesses.map((f,y)=>g.jsxs(Or.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"flex gap-1 justify-center",children:[f.word.split("").map((p,v)=>g.jsx("div",{className:`w-12 h-12 flex items-center justify-center text-white font-bold text-lg rounded ${h(f.feedback[v])}`,children:p},v)),g.jsx("div",{className:"ml-2 flex items-center",children:g.jsx("span",{className:"text-xs text-gray-400",children:f.player===u?"You":"Opponent"})})]},y)),Array.from({length:r.maxGuesses-r.guesses.length}).map((f,y)=>g.jsx("div",{className:"flex gap-1 justify-center",children:Array.from({length:5}).map((p,v)=>g.jsx("div",{className:"w-12 h-12 border-2 border-gray-600 rounded"},v))},`empty-${y}`))]}),r.gamePhase==="playing"&&d&&g.jsx("div",{className:"mb-6",children:g.jsxs("div",{className:"flex gap-2",children:[g.jsx("input",{type:"text",value:s,onChange:f=>i(f.target.value.slice(0,5).toUpperCase()),onKeyPress:c,className:"flex-1 px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg text-white text-center text-lg font-mono tracking-widest",placeholder:"GUESS",maxLength:5}),g.jsxs("button",{onClick:l,disabled:s.length!==5,className:"px-6 py-3 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[g.jsx(Bc,{className:"w-4 h-4"}),"Submit"]})]})}),r.gamePhase==="finished"&&g.jsxs(Or.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center p-6 bg-slate-700 rounded-lg",children:[g.jsx(Df,{className:"w-12 h-12 mx-auto mb-4 text-yellow-400"}),g.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:r.winner===u?"You Won!":r.winner==="draw"?"It's a Draw!":"You Lost!"}),g.jsxs("p",{className:"text-gray-400 mb-4",children:["The word was: ",g.jsx("span",{className:"text-white font-bold",children:r.word})]})]})]})};function Lc(t,e){const n=m.useRef(t);m.useEffect(()=>{n.current=t},[t]),m.useEffect(()=>{if(e===null)return;const s=setInterval(()=>n.current(),e);return()=>clearInterval(s)},[e])}const It=600,Nt=800,Oc=({onGameEnd:t,isHost:e,sendGameState:n})=>{const s=m.useRef(null),[i,r]=m.useState({player:{x:It/2,y:e?Nt-50:50,width:40,height:40,speed:5},opponent:{x:It/2,y:e?50:Nt-50,width:40,height:40},bullets:[],enemies:[],score:0}),[o,a]=m.useState({});return m.useEffect(()=>{const l=h=>{a(u=>({...u,[h.key]:!0}))},c=h=>{a(u=>({...u,[h.key]:!1}))};return window.addEventListener("keydown",l),window.addEventListener("keyup",c),()=>{window.removeEventListener("keydown",l),window.removeEventListener("keyup",c)}},[]),Lc(()=>{if(e&&Math.random()<.05){const l={x:Math.random()*(It-30),y:0,width:30,height:30,speed:2};r(c=>({...c,enemies:[...c.enemies,l]}))}},1e3),Lc(()=>{const l=s.current;if(!l)return;const c={...i};if(o.ArrowLeft&&c.player.x>0&&(c.player.x-=c.player.speed),o.ArrowRight&&c.player.x<It-c.player.width&&(c.player.x+=c.player.speed),o[" "]&&i.bullets.length<5){const u={x:c.player.x+c.player.width/2-2,y:e?c.player.y-10:c.player.y+c.player.height,width:4,height:10,speed:7};c.bullets=[...c.bullets,u]}c.bullets=c.bullets.map(u=>({...u,y:e?u.y-u.speed:u.y+u.speed})).filter(u=>u.y>0&&u.y<Nt),e&&(c.enemies=c.enemies.map(u=>({...u,y:u.y+u.speed})).filter(u=>u.y>Nt?(t(null),!1):!0),c.enemies=c.enemies.filter(u=>!c.bullets.some(f=>{const y=Fc(f,u);return y&&(c.score+=10),y})),c.bullets=c.bullets.filter(u=>!c.enemies.some(d=>Fc(u,d)))),r(c),n({type:"spaceshooter",data:c});const h=l.getContext("2d");h&&(h.fillStyle="#000",h.fillRect(0,0,It,Nt),h.fillStyle="#00ff00",h.fillRect(c.player.x,c.player.y,c.player.width,c.player.height),h.fillStyle="#ff0000",h.fillRect(c.opponent.x,c.opponent.y,c.opponent.width,c.opponent.height),h.fillStyle="#fff",c.bullets.forEach(u=>{h.fillRect(u.x,u.y,u.width,u.height)}),h.fillStyle="#ff00ff",c.enemies.forEach(u=>{h.fillRect(u.x,u.y,u.width,u.height)}))},1e3/60),g.jsxs("div",{className:"flex flex-col items-center",children:[g.jsx("div",{className:"mb-4",children:g.jsxs("span",{className:"text-xl font-bold",children:["Score: ",i.score]})}),g.jsx("canvas",{ref:s,width:It,height:Nt,className:"border border-gray-700 rounded-lg"}),g.jsx("div",{className:"mt-4 text-sm text-gray-400",children:"Use   to move, SPACE to shoot"})]})};function Fc(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}const vs=2e3;function MS(){const[t,e]=m.useState(""),[n,s]=m.useState(!1),[i,r]=m.useState(!1),[o,a]=m.useState(!1),[l,c]=m.useState(null),[h,u]=m.useState(!1),[d,f]=m.useState([]),[y,p]=m.useState(!1),[v,x]=m.useState(0),_=m.useRef(Math.random().toString(36).substring(7)),w=m.useRef(0),P=m.useRef(null),R=m.useRef(null),T=m.useRef(null);m.useEffect(()=>{const A=z(K,".info/connected");Fe(A,k=>{const U=k.val()===!0;console.log(`[2Players] Firebase connected: ${U}`),r(U),a(!U),c(U?null:"Connecting to game server...")});const j=z(K,`presence/${_.current}`);Re(j,!0),yn(j).remove();const F=z(K,"presence");return Fe(F,k=>{const U=k.exists()?Object.keys(k.val()).length:0;x(U)}),()=>{qe(A),qe(F),Le(j)}},[]),m.useEffect(()=>()=>{T.current&&Le(T.current),P.current&&qe(P.current),R.current&&qe(R.current)},[]);const O=m.useCallback(async A=>{if(!h){console.log(`[2Players] Starting matchmaking for ${A}...`),console.log(`[2Players] My player ID: ${_.current}`),u(!0),p(!1),f([]),w.current=Date.now();try{const j=z(K,`matchmaking/${A}`),F=await Mv(j);if(console.log("[2Players] Checking for waiting players..."),F.exists()){const an=F.val(),oa=Object.keys(an);console.log(`[2Players] Found ${oa.length} waiting player(s):`,an);for(const cs of oa)if(console.log(`[2Players] Checking player ${an[cs].playerId} vs me ${_.current}`),an[cs].playerId!==_.current){const us=an[cs].gameId;console.log(`[2Players] MATCH FOUND! Joining game ${us}`),await Le(z(K,`matchmaking/${A}/${cs}`));const vf=z(K,`games/${us}`);await kv(vf,{guest:_.current,status:"playing"}),s(!1),e(us);const aa=Date.now()-w.current;aa<vs&&await new Promise(_f=>setTimeout(_f,vs-aa)),u(!1),D(us);return}}console.log("[2Players] No match found, creating new game and waiting...");const k=xs(z(K,"games")),U=k.key;console.log(`[2Players] Created game ${U}, adding to waiting list`);const de={host:_.current,guest:null,gameType:A,state:{},status:"waiting",createdAt:Date.now()};await Re(k,de);const ve=xs(z(K,`matchmaking/${A}`));T.current=ve,await Re(ve,{playerId:_.current,gameId:U,createdAt:Date.now()}),yn(ve).remove(),yn(k).remove(),s(!0),e(U),D(U)}catch(j){console.error("Error creating game:",j),c("Failed to create game"),u(!1)}}},[h]),D=m.useCallback(A=>{console.log(`[2Players] Subscribing to game ${A}`),P.current=z(K,`games/${A}`),Fe(P.current,F=>{if(!F.exists()){p(!0),u(!1);return}const k=F.val();if(console.log("[2Players] Game update:",k),k.status==="playing"&&k.guest){console.log("[2Players] Opponent joined! Game is now playing."),T.current&&(Le(T.current),T.current=null);const U=Date.now()-w.current;U<vs?setTimeout(()=>{u(!1)},vs-U):u(!1)}k.state&&Object.keys(k.state).length>0&&window.dispatchEvent(new CustomEvent("game_state",{detail:k.state}))}),R.current=z(K,`chats/${A}`),Fe(R.current,F=>{if(!F.exists())return;const k=F.val(),U=Object.values(k).map(de=>({sender:de.sender,message:de.message,isMe:de.sender===_.current,timestamp:de.timestamp}));U.sort((de,ve)=>(de.timestamp||0)-(ve.timestamp||0)),f(U)});const j=z(K,`games/${A}/disconnected`);yn(j).set(_.current)},[]),I=m.useCallback(A=>{if(!t)return;const j=z(K,`games/${t}/state`);Re(j,A)},[t]),E=m.useCallback(A=>{if(!t)return;const j=xs(z(K,`chats/${t}`));Re(j,{sender:_.current,message:A,timestamp:Date.now()})},[t]),b=m.useCallback(A=>{console.log("Friend request for game:",A)},[]),S=m.useCallback(async()=>{t&&(await Le(z(K,`games/${t}`)),await Le(z(K,`chats/${t}`))),T.current&&(await Le(T.current),T.current=null),P.current&&(qe(P.current),P.current=null),R.current&&(qe(R.current),R.current=null),e(""),u(!1),f([]),p(!1)},[t]),N=m.useCallback(()=>{c(null)},[]);return{gameId:t,isHost:n,isConnected:i,isOffline:o,lastError:l,isMatchmaking:h,messages:d,opponentLeft:y,onlinePlayers:v,playerId:_.current,createGame:O,sendGameState:I,sendChat:E,sendFriendRequest:b,leaveGame:S,reconnect:N}}const LS=["Hello! ","Good game! ","Nice move! ","Well played! ","Good luck! ","Thanks for the game! "];function OS({onSendMessage:t,messages:e}){const[n,s]=m.useState(!1),[i,r]=m.useState(""),o=m.useRef(null),a=m.useRef(null),l=()=>{var u;(u=o.current)==null||u.scrollIntoView({behavior:"smooth"})};m.useEffect(()=>{l()},[e]);const c=()=>{var u;i.trim()&&(t(i.trim()),r(""),(u=a.current)==null||u.focus())},h=u=>{u.key==="Enter"&&!u.shiftKey&&(u.preventDefault(),c())};return g.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:n?g.jsxs("div",{className:"bg-white bg-opacity-10 backdrop-blur-lg rounded-xl w-80 shadow-lg",children:[g.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-white border-opacity-10",children:[g.jsx("h3",{className:"font-semibold",children:"Chat"}),g.jsx("button",{onClick:()=>s(!1),className:"text-gray-400 hover:text-white transition",children:""})]}),g.jsxs("div",{className:"h-64 overflow-y-auto p-4 space-y-2",children:[e.map((u,d)=>g.jsx("div",{className:`flex ${u.isMe?"justify-end":"justify-start"}`,children:g.jsx("div",{className:`rounded-lg px-3 py-2 max-w-[80%] ${u.isMe?"bg-pink-500 text-white":"bg-white bg-opacity-5 text-gray-200"}`,children:u.message})},d)),g.jsx("div",{ref:o})]}),g.jsxs("div",{className:"p-4 border-t border-white border-opacity-10",children:[g.jsxs("div",{className:"flex gap-2 mb-4",children:[g.jsx("input",{ref:a,type:"text",value:i,onChange:u=>r(u.target.value),onKeyPress:h,placeholder:"Type a message...",className:"flex-1 bg-white bg-opacity-5 rounded-lg px-3 py-2 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-pink-500"}),g.jsx("button",{onClick:c,disabled:!i.trim(),className:"p-2 bg-pink-500 rounded-lg hover:bg-pink-600 transition disabled:opacity-50 disabled:cursor-not-allowed",children:g.jsx(Bc,{className:"w-5 h-5"})})]}),g.jsx("div",{className:"grid grid-cols-2 gap-2",children:LS.map(u=>g.jsx("button",{onClick:()=>{var d;t(u),(d=a.current)==null||d.focus()},className:"text-sm px-3 py-1.5 bg-white bg-opacity-5 rounded hover:bg-opacity-10 transition text-left truncate",children:u},u))})]})]}):g.jsx("button",{onClick:()=>s(!0),className:"bg-white bg-opacity-10 backdrop-blur-lg p-3 rounded-full hover:bg-opacity-20 transition",children:g.jsx(Zs,{className:"w-6 h-6"})})})}function FS({show:t,gameType:e,winner:n,opponentDisconnected:s=!1,onMainMenu:i,onRequeue:r,onFriendRequest:o}){const[a,l]=m.useState(!1),[c,h]=m.useState(!1);if(m.useEffect(()=>{t&&!s&&l(!0)},[t,s]),!t)return null;const u=e?{checkers:"Checkers",tictactoe:"Tic Tac Toe",spaceshooter:"Space Shooter",battleships:"Battleships",snake:"Snake Battle",cooppong:"Coop Pong",wordduel:"Word Duel"}[e]:"this game";return g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:g.jsxs("div",{className:"bg-white bg-opacity-10 backdrop-blur-lg rounded-xl p-6 max-w-md w-full",children:[s?g.jsxs(g.Fragment,{children:[g.jsx("h2",{className:"text-2xl font-bold mb-4 text-red-400",children:"Your opponent has left!"}),g.jsx("p",{className:"text-gray-300 mb-6",children:"Would you like to return to the main menu or find a new opponent?"})]}):g.jsxs(g.Fragment,{children:[g.jsx("h2",{className:"text-2xl font-bold mb-4",children:n?`${n} Wins!`:"It's a Draw!"}),a&&!c&&g.jsxs("div",{className:"mb-6",children:[g.jsx("p",{className:"text-gray-300 mb-4",children:"Would you like to add your opponent as a friend?"}),g.jsxs("button",{onClick:()=>{h(!0),o()},className:"w-full px-4 py-3 bg-gradient-to-r from-pink-500 to-violet-500 rounded-lg hover:opacity-90 transition flex items-center justify-center gap-2",children:[g.jsx(kf,{size:20}),"Send Friend Request"]})]}),c&&g.jsx("p",{className:"text-green-400 mb-6",children:"Friend request sent! They'll need to accept it too."})]}),g.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.jsxs("button",{onClick:i,className:"px-4 py-3 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition flex items-center justify-center gap-2",children:[g.jsx(Mf,{size:20}),"Main Menu"]}),g.jsxs("button",{onClick:r,className:"px-4 py-3 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition flex items-center justify-center gap-2",children:[g.jsx(Fr,{size:20}),"Play ",u," Again"]})]})]})})}const jS={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}]};function VS({gameId:t,playerId:e,isHost:n,communicationType:s}){const[i,r]=m.useState(null),[o,a]=m.useState(null),[l,c]=m.useState(!1),[h,u]=m.useState(!1),[d,f]=m.useState(null),y=m.useRef(null),p=m.useRef(null),v=m.useRef(null),x=m.useCallback(async()=>{if(s==="text")return null;try{const T={audio:s==="video"||s==="audio",video:s==="video"},O=await navigator.mediaDevices.getUserMedia(T);return r(O),p.current&&s==="video"&&(p.current.srcObject=O),O}catch(T){return console.error("Error accessing media devices:",T),f("Failed to access camera/microphone. Please check permissions."),null}},[s]),_=m.useCallback(async()=>{if(!(!t||s==="text")){c(!0),f(null);try{const T=new RTCPeerConnection(jS);y.current=T,T.ontrack=E=>{const[b]=E.streams;a(b),v.current&&(v.current.srcObject=b)};const O=await x();if(O&&O.getTracks().forEach(E=>{T.addTrack(E,O)}),T.onicecandidate=E=>{if(E.candidate){const b=xs(z(K,`webrtc/${t}/candidates/${e}`));Re(b,E.candidate.toJSON())}},T.onconnectionstatechange=()=>{console.log("[WebRTC] Connection state:",T.connectionState),T.connectionState==="connected"?(u(!0),c(!1)):(T.connectionState==="disconnected"||T.connectionState==="failed")&&(u(!1),f("Connection lost"))},n){const E=await T.createOffer();await T.setLocalDescription(E),await Re(z(K,`webrtc/${t}/offer`),{type:E.type,sdp:E.sdp});const b=z(K,`webrtc/${t}/answer`);Fe(b,async S=>{if(S.exists()&&T.currentRemoteDescription===null){const N=S.val();await T.setRemoteDescription(new RTCSessionDescription(N))}})}else{const E=z(K,`webrtc/${t}/offer`);Fe(E,async b=>{if(b.exists()&&T.currentRemoteDescription===null){const S=b.val();await T.setRemoteDescription(new RTCSessionDescription(S));const N=await T.createAnswer();await T.setLocalDescription(N),await Re(z(K,`webrtc/${t}/answer`),{type:N.type,sdp:N.sdp})}})}const I=z(K,`webrtc/${t}/candidates/${n?"guest":"host"}`);Fe(I,E=>{if(E.exists()){const b=E.val();Object.values(b).forEach(S=>{T.addIceCandidate(new RTCIceCandidate(S)).catch(console.error)})}})}catch(T){console.error("Error initializing WebRTC:",T),f("Failed to establish video/audio connection"),c(!1)}}},[t,e,n,s,x]),w=m.useCallback(()=>{i&&(i.getTracks().forEach(T=>T.stop()),r(null)),y.current&&(y.current.close(),y.current=null),t&&Le(z(K,`webrtc/${t}`)),a(null),u(!1),c(!1)},[t,i]),P=m.useCallback(()=>{var T;if(i){const O=i.getAudioTracks();return O.forEach(D=>{D.enabled=!D.enabled}),!((T=O[0])!=null&&T.enabled)}return!1},[i]),R=m.useCallback(()=>{var T;if(i){const O=i.getVideoTracks();return O.forEach(D=>{D.enabled=!D.enabled}),!((T=O[0])!=null&&T.enabled)}return!1},[i]);return m.useEffect(()=>()=>{w()},[w]),{localStream:i,remoteStream:o,localVideoRef:p,remoteVideoRef:v,isConnecting:l,isConnected:h,error:d,initializeConnection:_,requestMediaAccess:x,cleanup:w,toggleMute:P,toggleVideo:R}}async function BS(t){try{const e={audio:!0,video:t==="video"};return(await navigator.mediaDevices.getUserMedia(e)).getTracks().forEach(s=>s.stop()),!0}catch(e){return console.error("Media permission check failed:",e),!1}}function $S({gameId:t,playerId:e,isHost:n}){const{communicationType:s}=Po(),[i,r]=m.useState(!1),[o,a]=m.useState(!1),{localVideoRef:l,remoteVideoRef:c,isConnecting:h,isConnected:u,error:d,initializeConnection:f,toggleMute:y,toggleVideo:p,cleanup:v}=VS({gameId:t,playerId:e,isHost:n,communicationType:s||"text"});m.useEffect(()=>(t&&s&&s!=="text"&&f(),()=>{v()}),[t,s,f,v]);const x=()=>{const w=y();r(w)},_=()=>{const w=p();a(w)};return!s||s==="text"?null:g.jsx("div",{className:"fixed bottom-4 right-4 z-40",children:g.jsxs("div",{className:"bg-slate-800/90 backdrop-blur-lg rounded-xl p-3 shadow-xl border border-white/10",children:[s==="video"&&g.jsxs("div",{className:"flex gap-2 mb-3",children:[g.jsxs("div",{className:"relative w-32 h-24 bg-slate-900 rounded-lg overflow-hidden",children:[g.jsx("video",{ref:c,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),!u&&g.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-500 text-xs",children:h?"Connecting...":"Waiting..."})]}),g.jsxs("div",{className:"relative w-20 h-15 bg-slate-900 rounded-lg overflow-hidden",children:[g.jsx("video",{ref:l,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover mirror"}),o&&g.jsx("div",{className:"absolute inset-0 bg-slate-900 flex items-center justify-center",children:g.jsx(ca,{className:"w-6 h-6 text-gray-500"})})]})]}),s==="audio"&&g.jsxs("div",{className:"flex items-center gap-2 mb-3 px-2",children:[g.jsx("div",{className:`w-2 h-2 rounded-full ${u?"bg-green-500":"bg-yellow-500"} animate-pulse`}),g.jsx("span",{className:"text-sm text-gray-300",children:u?"Voice connected":h?"Connecting...":"Waiting for opponent"})]}),g.jsxs("div",{className:"flex items-center justify-center gap-2",children:[g.jsx("button",{onClick:x,className:`p-2 rounded-lg transition ${i?"bg-red-500/20 text-red-500":"bg-white/10 text-white hover:bg-white/20"}`,title:i?"Unmute":"Mute",children:i?g.jsx(Lf,{className:"w-5 h-5"}):g.jsx(jr,{className:"w-5 h-5"})}),s==="video"&&g.jsx("button",{onClick:_,className:`p-2 rounded-lg transition ${o?"bg-red-500/20 text-red-500":"bg-white/10 text-white hover:bg-white/20"}`,title:o?"Turn on camera":"Turn off camera",children:o?g.jsx(ca,{className:"w-5 h-5"}):g.jsx(Vr,{className:"w-5 h-5"})}),g.jsx("button",{onClick:v,className:"p-2 rounded-lg bg-red-500/20 text-red-500 hover:bg-red-500/30 transition",title:"End call",children:g.jsx(Of,{className:"w-5 h-5 rotate-[135deg]"})})]}),d&&g.jsx("p",{className:"mt-2 text-xs text-red-400 text-center",children:d})]})})}function US({onGameEnd:t=()=>{}}){const[e,n]=m.useState(null),[s,i]=m.useState(!1),[r,o]=m.useState(null),[a,l]=m.useState(!1),{isHost:c,gameId:h,isConnected:u,isOffline:d,lastError:f,isMatchmaking:y,createGame:p,sendGameState:v,sendChat:x,sendFriendRequest:_,messages:w,reconnect:P,playerId:R}=MS(),T=F=>{o(F),i(!0)},O=()=>{n(null),i(!1),l(!1),o(null),t()},D=()=>{i(!1),l(!1),o(null),e&&p(e)},I=()=>{h&&_(h)},E=()=>{P()},b=F=>{n(F),(u||d)&&!y&&!h&&F&&p(F)},S=()=>g.jsxs("div",{className:"flex flex-col items-center justify-center p-8",role:"alert",children:[g.jsx("div",{className:"w-16 h-16 mb-6 text-red-500",children:g.jsx($c,{className:"w-16 h-16","aria-hidden":"true"})}),g.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Connection Error"}),f&&g.jsx("p",{className:"text-gray-400 mb-4 text-center",children:f}),!d&&g.jsxs("button",{onClick:E,className:"px-6 py-3 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition flex items-center gap-2",children:[g.jsx(Fr,{className:"w-5 h-5","aria-hidden":"true"}),"Retry Connection"]})]}),N=()=>{if(!d&&!u&&f)return S();if(!e)return j();if(!d&&(!h||y))return A();const F={onGameEnd:T,isHost:c,sendGameState:v,gameId:h,isOffline:d};return g.jsxs(g.Fragment,{children:[e==="battleships"&&g.jsx(fl,{...F}),e==="tictactoe"&&g.jsx(dl,{...F}),e==="checkers"&&g.jsx(pl,{...F}),e==="snake"&&g.jsx(ml,{...F}),e==="cooppong"&&g.jsx(yl,{...F}),e==="wordduel"&&g.jsx(Mc,{...F}),e==="spaceshooter"&&g.jsx(Oc,{...F}),!d&&g.jsx(OS,{onSendMessage:x,messages:w}),!d&&h&&g.jsx($S,{gameId:h,playerId:R,isHost:c}),g.jsx(FS,{show:s,gameType:e,winner:r,opponentDisconnected:a,onMainMenu:O,onRequeue:D,onFriendRequest:I})]})},A=()=>g.jsxs("div",{className:"flex flex-col items-center justify-center p-8",role:"status",children:[g.jsx("div",{className:"w-16 h-16 mb-6",children:g.jsx(Ff,{className:"w-16 h-16 text-pink-500 animate-spin","aria-hidden":"true"})}),g.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Finding Opponent..."}),g.jsx("p",{className:"text-gray-400",children:"This won't take long"}),g.jsx("button",{onClick:()=>n(null),className:"mt-6 px-4 py-2 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition",children:"Cancel"})]}),j=()=>{const F=[{id:"wordduel",name:"Word Duel",component:Mc,description:"Guess the hidden word first",icon:"",players:"2 Players"},{id:"tictactoe",name:"Tic Tac Toe",component:dl,description:"Classic 3x3 grid game",icon:"",players:"2 Players"},{id:"battleships",name:"Battleships",component:fl,description:"Sink your opponent's fleet",icon:"",players:"2 Players"},{id:"checkers",name:"Checkers",component:pl,description:"Strategic board game",icon:"",players:"2 Players"},{id:"snake",name:"Snake Battle",component:ml,description:"Competitive snake game",icon:"",players:"2 Players"},{id:"spaceshooter",name:"Space Shooter",component:Oc,description:"Defend against aliens",icon:"",players:"1-2 Players"},{id:"cooppong",name:"Coop Pong",component:yl,description:"Work together in Pong",icon:"",players:"2 Players"}];return g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",role:"menu",children:F.map(k=>g.jsx("button",{onClick:()=>b(k.id),className:"p-6 bg-white bg-opacity-5 rounded-xl hover:bg-opacity-10 transition group",role:"menuitem","aria-label":`Play ${k.name}`,children:g.jsxs("div",{className:"flex flex-col items-center",children:[g.jsx("div",{className:"w-16 h-16 rounded-lg flex items-center justify-center mb-4 group-hover:scale-110 transition",style:{backgroundColor:"rgba(255,255,255,0.1)"},children:k.icon}),g.jsx("h3",{className:"text-xl font-bold text-white",children:k.name}),g.jsx("p",{className:"text-gray-400 text-sm mt-2",children:k.description})]})},k.id))})};return g.jsx("div",{className:"bg-white bg-opacity-10 backdrop-blur-lg rounded-xl p-8 relative",children:N()})}function WS({onComplete:t}){const{username:e,setUsername:n,setCommunicationType:s,setMediaPermissionsGranted:i,completeSetup:r}=Po(),[o,a]=m.useState(null),[l,c]=m.useState(!1),[h,u]=m.useState(null),[d,f]=m.useState(null),y=[{type:"video",icon:Vr,title:"Video Chat",description:"See and hear your opponent with webcam and microphone",color:"pink"},{type:"audio",icon:jr,title:"Voice Chat",description:"Talk to your opponent using your microphone",color:"violet"},{type:"text",icon:Zs,title:"Text Only",description:"Chat with your opponent using text messages",color:"blue"}],p=_=>_.length<3?"Username must be at least 3 characters":_.length>20?"Username must be less than 20 characters":/^[a-zA-Z0-9_]+$/.test(_)?null:"Only letters, numbers, and underscores allowed",v=_=>{const w=_.target.value;n(w),f(p(w))},x=async()=>{const _=p(e);if(_){f(_);return}if(o){if(u(null),o==="text"){s(o),r(),t();return}c(!0);try{await BS(o==="video"?"video":"audio")?(i(!0),s(o),r(),t()):u(o==="video"?"Camera or microphone access was denied. Please allow access in your browser settings or choose text chat.":"Microphone access was denied. Please allow access in your browser settings or choose text chat.")}catch{u("Unable to access media devices. Please check your browser settings or choose text chat.")}finally{c(!1)}}};return g.jsx("div",{className:"min-h-[80vh] flex items-center justify-center p-4",children:g.jsxs(Or.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-2xl w-full",children:[g.jsxs("div",{className:"text-center mb-8",children:[g.jsx("h1",{className:"text-3xl sm:text-4xl font-bold mb-4 bg-gradient-to-r from-pink-500 via-violet-500 to-blue-500 text-transparent bg-clip-text",children:"Welcome to 2Players"}),g.jsx("p",{className:"text-gray-400",children:"Set up your profile and choose how you want to communicate with opponents"})]}),g.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl p-6 mb-6",children:[g.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[g.jsx(Vc,{className:"w-6 h-6 text-pink-500"}),g.jsx("h2",{className:"text-xl font-semibold text-white",children:"Your Username"})]}),g.jsx("input",{type:"text",value:e,onChange:v,className:"w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-pink-500",placeholder:"Enter your username"}),d&&g.jsx("p",{className:"mt-2 text-sm text-red-400",children:d})]}),g.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl p-6 mb-6",children:[g.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"How do you want to communicate?"}),g.jsx("div",{className:"space-y-3",children:y.map(_=>{const w=_.icon,P=o===_.type;return g.jsxs("button",{onClick:()=>{a(_.type),u(null)},className:`w-full p-4 rounded-xl border-2 transition-all flex items-center gap-4 text-left ${P?`border-${_.color}-500 bg-${_.color}-500/10`:"border-white/10 hover:border-white/20 hover:bg-white/5"}`,children:[g.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${P?`bg-${_.color}-500`:"bg-white/10"}`,children:g.jsx(w,{className:`w-6 h-6 ${P?"text-white":"text-gray-400"}`})}),g.jsxs("div",{className:"flex-1",children:[g.jsx("h3",{className:"font-semibold text-white",children:_.title}),g.jsx("p",{className:"text-sm text-gray-400",children:_.description})]}),P&&g.jsx(jf,{className:`w-6 h-6 text-${_.color}-500`})]},_.type)})})]}),h&&g.jsxs("div",{className:"mb-6 p-4 bg-red-500/10 border border-red-500/50 rounded-lg flex items-start gap-3",children:[g.jsx($c,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),g.jsx("p",{className:"text-red-400 text-sm",children:h})]}),g.jsx("button",{onClick:x,disabled:!o||l||!!d,className:"w-full px-6 py-4 bg-gradient-to-r from-pink-500 to-violet-500 text-white rounded-xl font-semibold hover:opacity-90 transition disabled:opacity-50 disabled:cursor-not-allowed",children:l?g.jsxs("span",{className:"flex items-center justify-center gap-2",children:[g.jsx("span",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Checking permissions..."]}):"Start Playing"}),o&&o!=="text"&&g.jsxs("p",{className:"text-center text-sm text-gray-500 mt-4",children:["Your browser will ask for ",o==="video"?"camera and microphone":"microphone"," access"]})]})})}const HS=()=>{const{hasCompletedSetup:t,username:e,communicationType:n,resetGuest:s}=Po(),i=()=>{},r=()=>{switch(n){case"video":return g.jsx(Vr,{className:"w-4 h-4"});case"audio":return g.jsx(jr,{className:"w-4 h-4"});default:return g.jsx(Zs,{className:"w-4 h-4"})}},o=()=>{switch(n){case"video":return"Video Chat";case"audio":return"Voice Chat";default:return"Text Chat"}};return t?g.jsx("div",{className:"min-h-screen py-8",children:g.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[g.jsxs("div",{className:"mb-8 p-4 bg-white/5 backdrop-blur-lg rounded-lg flex items-center justify-between",children:[g.jsxs("div",{className:"flex items-center gap-4",children:[g.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-r from-pink-500 to-violet-500 flex items-center justify-center text-white font-bold",children:e.charAt(0).toUpperCase()}),g.jsxs("div",{children:[g.jsx("p",{className:"font-semibold text-white",children:e}),g.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-400",children:[r(),g.jsx("span",{children:o()})]})]})]}),g.jsxs("button",{onClick:s,className:"flex items-center gap-2 px-4 py-2 bg-white/10 text-gray-300 rounded-lg hover:bg-white/20 transition",children:[g.jsx(Fr,{className:"w-4 h-4"}),"Change Settings"]})]}),g.jsxs("div",{className:"text-center mb-12",children:[g.jsx("h1",{className:"text-4xl font-bold mb-4 bg-gradient-to-r from-pink-500 via-violet-500 to-blue-500 text-transparent bg-clip-text",children:"Choose Your Game"}),g.jsx("p",{className:"text-gray-400",children:"Challenge players and have fun!"})]}),g.jsx(US,{})]})}):g.jsx(WS,{onComplete:i})};function GS(){const t=Ih(),{onlinePlayers:e,isConnected:n}=_h(),s=[{icon:g.jsx(Vf,{className:"w-8 h-8 text-pink-500"}),title:"Real-time Multiplayer",description:"Challenge players worldwide in classic games like Battleships, Tic Tac Toe, and Checkers"},{icon:g.jsx(Bf,{className:"w-8 h-8 text-violet-500"}),title:"No Account Needed",description:"Jump straight into games - no sign up required. Just pick a name and play!"},{icon:g.jsx(Zs,{className:"w-8 h-8 text-blue-500"}),title:"Video, Voice & Text Chat",description:"Connect with opponents using your webcam, microphone, or text messages"},{icon:g.jsx($f,{className:"w-8 h-8 text-green-500"}),title:"Global Community",description:"Join players from around the world in friendly competition"}];return g.jsxs("div",{className:"py-12 sm:py-20",children:[g.jsxs("div",{className:"text-center mb-16",children:[g.jsx("h1",{className:"text-4xl sm:text-6xl font-bold mb-6 bg-gradient-to-r from-pink-500 via-violet-500 to-blue-500 text-transparent bg-clip-text",children:"Play Games. Meet People."}),g.jsx("p",{className:"text-xl text-gray-300 mb-8 max-w-2xl mx-auto",children:"Challenge players worldwide in real-time multiplayer games. No account needed - just pick a name and start playing!"}),n&&e>0&&g.jsxs("p",{className:"text-green-400 text-lg animate-pulse",children:[e," Players Online Now"]})]}),g.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-8 mb-16",children:s.map((i,r)=>g.jsxs("div",{className:"bg-white/5 backdrop-blur-lg rounded-xl p-6 hover:bg-white/10 transition",children:[g.jsx("div",{className:"mb-4",children:i.icon}),g.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:i.title}),g.jsx("p",{className:"text-gray-400",children:i.description})]},r))}),g.jsx("div",{className:"text-center",children:g.jsx("button",{onClick:()=>t("/play"),className:"px-8 py-4 bg-gradient-to-r from-pink-500 to-violet-500 text-white rounded-lg text-lg font-semibold hover:opacity-90 transition",children:"Start Playing Now"})})]})}const zS=()=>g.jsx(g0,{children:g.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-violet-900 via-slate-900 to-black",children:[g.jsx(T0,{}),g.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:g.jsxs(z_,{children:[g.jsx(vr,{path:"/",element:g.jsx(GS,{})}),g.jsx(vr,{path:"/play",element:g.jsx(HS,{})})]})})]})});class KS extends m.Component{constructor(){super(...arguments);la(this,"state",{hasError:!1})}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(n,s){console.error("Uncaught error:",n,s)}render(){return this.state.hasError?g.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-violet-900 via-slate-900 to-black",children:g.jsxs("div",{className:"text-center p-8 bg-white/5 backdrop-blur-lg rounded-xl",children:[g.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:"Oops, something went wrong!"}),g.jsx("button",{className:"px-4 py-2 bg-violet-500 text-white rounded hover:bg-violet-600",onClick:()=>this.setState({hasError:!1}),children:"Try again"})]})}):this.props.children}}qi.createRoot(document.getElementById("root")).render(g.jsx(jc.StrictMode,{children:g.jsx(KS,{children:g.jsx(zS,{})})}));
//# sourceMappingURL=index-BP3dReRU.js.map
